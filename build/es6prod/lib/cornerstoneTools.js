(function webpackUniversalModuleDefinition(root,factory){if("object"===typeof exports&&"object"===typeof module)module.exports=factory();else if("function"===typeof define&&define.amd)define("cornerstone-tools",[],factory);else if("object"===typeof exports)exports["cornerstone-tools"]=factory();else root.cornerstoneTools=factory()})(window,function(){var _StringfromCharCode=String.fromCharCode,_Mathacos=Math.acos,_Mathpow=Math.pow,_NumberMAX_VALUE=Number.MAX_VALUE,_Mathfloor=Math.floor,_Mathsqrt=Math.sqrt,_Mathmax=Math.max,_Mathmin=Math.min,_Mathsin=Math.sin,_Mathcos=Math.cos,_MathPI=Math.PI,_Mathround=Math.round,_Mathabs=Math.abs;return function(modules){function hotDisposeChunk(chunkId){delete installedChunks[chunkId]}var parentHotUpdateCallback=window.webpackHotUpdate;window.webpackHotUpdate=function webpackHotUpdateCallback(chunkId,moreModules){hotAddUpdateChunk(chunkId,moreModules);if(parentHotUpdateCallback)parentHotUpdateCallback(chunkId,moreModules)};function hotDownloadUpdateChunk(chunkId){var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.charset="utf-8";script.src=__webpack_require__.p+""+chunkId+"."+hotCurrentHash+".hot-update.js";;head.appendChild(script)}function hotDownloadManifest(requestTimeout){requestTimeout=requestTimeout||1e4;return new Promise(function(resolve,reject){if("undefined"===typeof XMLHttpRequest)return reject(new Error("No browser support"));try{var request=new XMLHttpRequest,requestPath=__webpack_require__.p+""+hotCurrentHash+".hot-update.json";request.open("GET",requestPath,!0);request.timeout=requestTimeout;request.send(null)}catch(err){return reject(err)}request.onreadystatechange=function(){if(4!==request.readyState)return;if(0===request.status){reject(new Error("Manifest request to "+requestPath+" timed out."))}else if(404===request.status){resolve()}else if(200!==request.status&&304!==request.status){reject(new Error("Manifest request to "+requestPath+" failed."))}else{try{var update=JSON.parse(request.responseText)}catch(e){reject(e);return}resolve(update)}}})}var hotApplyOnUpdate=!0,hotCurrentHash="ec8cddb1b6a946adfb56",hotRequestTimeout=1e4,hotCurrentModuleData={},hotCurrentChildModule,hotCurrentParents=[],hotCurrentParentsTemp=[];function hotCreateRequire(moduleId){var me=installedModules[moduleId];if(!me)return __webpack_require__;var fn=function(request){if(me.hot.active){if(installedModules[request]){if(-1===installedModules[request].parents.indexOf(moduleId))installedModules[request].parents.push(moduleId)}else{hotCurrentParents=[moduleId];hotCurrentChildModule=request}if(-1===me.children.indexOf(request))me.children.push(request)}else{console.warn("[HMR] unexpected require("+request+") from disposed module "+moduleId);hotCurrentParents=[]}return __webpack_require__(request)},ObjectFactory=function ObjectFactory(name){return{configurable:!0,enumerable:!0,get:function(){return __webpack_require__[name]},set:function(value){__webpack_require__[name]=value}}};for(var name in __webpack_require__){if(Object.prototype.hasOwnProperty.call(__webpack_require__,name)&&"e"!==name){Object.defineProperty(fn,name,ObjectFactory(name))}}fn.e=function(chunkId){if("ready"===hotStatus)hotSetStatus("prepare");hotChunksLoading++;return __webpack_require__.e(chunkId).then(finishChunkLoading,function(err){finishChunkLoading();throw err});function finishChunkLoading(){hotChunksLoading--;if("prepare"===hotStatus){if(!hotWaitingFilesMap[chunkId]){hotEnsureUpdateChunk(chunkId)}if(0===hotChunksLoading&&0===hotWaitingFiles){hotUpdateDownloaded()}}}};return fn}function hotCreateModule(moduleId){var hot={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:hotCurrentChildModule!==moduleId,active:!0,accept:function(dep,callback){if("undefined"===typeof dep)hot._selfAccepted=!0;else if("function"===typeof dep)hot._selfAccepted=dep;else if("object"===typeof dep)for(var i=0;i<dep.length;i++)hot._acceptedDependencies[dep[i]]=callback||function(){};else hot._acceptedDependencies[dep]=callback||function(){}},decline:function(dep){if("undefined"===typeof dep)hot._selfDeclined=!0;else if("object"===typeof dep)for(var i=0;i<dep.length;i++)hot._declinedDependencies[dep[i]]=!0;else hot._declinedDependencies[dep]=!0},dispose:function(callback){hot._disposeHandlers.push(callback)},addDisposeHandler:function(callback){hot._disposeHandlers.push(callback)},removeDisposeHandler:function(callback){var idx=hot._disposeHandlers.indexOf(callback);if(0<=idx)hot._disposeHandlers.splice(idx,1)},check:hotCheck,apply:hotApply,status:function(l){if(!l)return hotStatus;hotStatusHandlers.push(l)},addStatusHandler:function(l){hotStatusHandlers.push(l)},removeStatusHandler:function(l){var idx=hotStatusHandlers.indexOf(l);if(0<=idx)hotStatusHandlers.splice(idx,1)},data:hotCurrentModuleData[moduleId]};hotCurrentChildModule=void 0;return hot}var hotStatusHandlers=[],hotStatus="idle";function hotSetStatus(newStatus){hotStatus=newStatus;for(var i=0;i<hotStatusHandlers.length;i++)hotStatusHandlers[i].call(null,newStatus)}var hotWaitingFiles=0,hotChunksLoading=0,hotWaitingFilesMap={},hotRequestedFilesMap={},hotAvailableFilesMap={},hotDeferred,hotUpdate,hotUpdateNewHash;function toModuleId(id){var isNumber=+id+""===id;return isNumber?+id:id}function hotCheck(apply){if("idle"!==hotStatus)throw new Error("check() is only allowed in idle status");hotApplyOnUpdate=apply;hotSetStatus("check");return hotDownloadManifest(hotRequestTimeout).then(function(update){if(!update){hotSetStatus("idle");return null}hotRequestedFilesMap={};hotWaitingFilesMap={};hotAvailableFilesMap=update.c;hotUpdateNewHash=update.h;hotSetStatus("prepare");var promise=new Promise(function(resolve,reject){hotDeferred={resolve:resolve,reject:reject}});hotUpdate={};var chunkId="cornerstoneTools";{hotEnsureUpdateChunk(chunkId)}if("prepare"===hotStatus&&0===hotChunksLoading&&0===hotWaitingFiles){hotUpdateDownloaded()}return promise})}function hotAddUpdateChunk(chunkId,moreModules){if(!hotAvailableFilesMap[chunkId]||!hotRequestedFilesMap[chunkId])return;hotRequestedFilesMap[chunkId]=!1;for(var moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){hotUpdate[moduleId]=moreModules[moduleId]}}if(0===--hotWaitingFiles&&0===hotChunksLoading){hotUpdateDownloaded()}}function hotEnsureUpdateChunk(chunkId){if(!hotAvailableFilesMap[chunkId]){hotWaitingFilesMap[chunkId]=!0}else{hotRequestedFilesMap[chunkId]=!0;hotWaitingFiles++;hotDownloadUpdateChunk(chunkId)}}function hotUpdateDownloaded(){hotSetStatus("ready");var deferred=hotDeferred;hotDeferred=null;if(!deferred)return;if(hotApplyOnUpdate){Promise.resolve().then(function(){return hotApply(hotApplyOnUpdate)}).then(function(result){deferred.resolve(result)},function(err){deferred.reject(err)})}else{var outdatedModules=[];for(var id in hotUpdate){if(Object.prototype.hasOwnProperty.call(hotUpdate,id)){outdatedModules.push(toModuleId(id))}}deferred.resolve(outdatedModules)}}function hotApply(options){if("ready"!==hotStatus)throw new Error("apply() is only allowed in ready status");options=options||{};var cb,i,j,module,moduleId;function getAffectedStuff(updateModuleId){var outdatedModules=[updateModuleId],outdatedDependencies={},queue=outdatedModules.slice().map(function(id){return{chain:[id],id:id}});while(0<queue.length){var queueItem=queue.pop(),moduleId=queueItem.id,chain=queueItem.chain;module=installedModules[moduleId];if(!module||module.hot._selfAccepted)continue;if(module.hot._selfDeclined){return{type:"self-declined",chain:chain,moduleId:moduleId}}if(module.hot._main){return{type:"unaccepted",chain:chain,moduleId:moduleId}}for(var i=0;i<module.parents.length;i++){var parentId=module.parents[i],parent=installedModules[parentId];if(!parent)continue;if(parent.hot._declinedDependencies[moduleId]){return{type:"declined",chain:chain.concat([parentId]),moduleId:moduleId,parentId:parentId}}if(-1!==outdatedModules.indexOf(parentId))continue;if(parent.hot._acceptedDependencies[moduleId]){if(!outdatedDependencies[parentId])outdatedDependencies[parentId]=[];addAllToSet(outdatedDependencies[parentId],[moduleId]);continue}delete outdatedDependencies[parentId];outdatedModules.push(parentId);queue.push({chain:chain.concat([parentId]),id:parentId})}}return{type:"accepted",moduleId:updateModuleId,outdatedModules:outdatedModules,outdatedDependencies:outdatedDependencies}}function addAllToSet(a,b){for(var i=0,item;i<b.length;i++){item=b[i];if(-1===a.indexOf(item))a.push(item)}}var outdatedDependencies={},outdatedModules=[],appliedUpdate={},warnUnexpectedRequire=function warnUnexpectedRequire(){console.warn("[HMR] unexpected require("+result.moduleId+") to disposed module")};for(var id in hotUpdate){if(Object.prototype.hasOwnProperty.call(hotUpdate,id)){moduleId=toModuleId(id);var result;if(hotUpdate[id]){result=getAffectedStuff(moduleId)}else{result={type:"disposed",moduleId:id}}var abortError=!1,doApply=!1,doDispose=!1,chainInfo="";if(result.chain){chainInfo="\nUpdate propagation: "+result.chain.join(" -> ")}switch(result.type){case"self-declined":if(options.onDeclined)options.onDeclined(result);if(!options.ignoreDeclined)abortError=new Error("Aborted because of self decline: "+result.moduleId+chainInfo);break;case"declined":if(options.onDeclined)options.onDeclined(result);if(!options.ignoreDeclined)abortError=new Error("Aborted because of declined dependency: "+result.moduleId+" in "+result.parentId+chainInfo);break;case"unaccepted":if(options.onUnaccepted)options.onUnaccepted(result);if(!options.ignoreUnaccepted)abortError=new Error("Aborted because "+moduleId+" is not accepted"+chainInfo);break;case"accepted":if(options.onAccepted)options.onAccepted(result);doApply=!0;break;case"disposed":if(options.onDisposed)options.onDisposed(result);doDispose=!0;break;default:throw new Error("Unexception type "+result.type);}if(abortError){hotSetStatus("abort");return Promise.reject(abortError)}if(doApply){appliedUpdate[moduleId]=hotUpdate[moduleId];addAllToSet(outdatedModules,result.outdatedModules);for(moduleId in result.outdatedDependencies){if(Object.prototype.hasOwnProperty.call(result.outdatedDependencies,moduleId)){if(!outdatedDependencies[moduleId])outdatedDependencies[moduleId]=[];addAllToSet(outdatedDependencies[moduleId],result.outdatedDependencies[moduleId])}}}if(doDispose){addAllToSet(outdatedModules,[result.moduleId]);appliedUpdate[moduleId]=warnUnexpectedRequire}}}var outdatedSelfAcceptedModules=[];for(i=0;i<outdatedModules.length;i++){moduleId=outdatedModules[i];if(installedModules[moduleId]&&installedModules[moduleId].hot._selfAccepted)outdatedSelfAcceptedModules.push({module:moduleId,errorHandler:installedModules[moduleId].hot._selfAccepted})}hotSetStatus("dispose");Object.keys(hotAvailableFilesMap).forEach(function(chunkId){if(!1===hotAvailableFilesMap[chunkId]){hotDisposeChunk(chunkId)}});var idx,queue=outdatedModules.slice();while(0<queue.length){moduleId=queue.pop();module=installedModules[moduleId];if(!module)continue;var data={},disposeHandlers=module.hot._disposeHandlers;for(j=0;j<disposeHandlers.length;j++){cb=disposeHandlers[j];cb(data)}hotCurrentModuleData[moduleId]=data;module.hot.active=!1;delete installedModules[moduleId];delete outdatedDependencies[moduleId];for(j=0;j<module.children.length;j++){var child=installedModules[module.children[j]];if(!child)continue;idx=child.parents.indexOf(moduleId);if(0<=idx){child.parents.splice(idx,1)}}}var dependency,moduleOutdatedDependencies;for(moduleId in outdatedDependencies){if(Object.prototype.hasOwnProperty.call(outdatedDependencies,moduleId)){module=installedModules[moduleId];if(module){moduleOutdatedDependencies=outdatedDependencies[moduleId];for(j=0;j<moduleOutdatedDependencies.length;j++){dependency=moduleOutdatedDependencies[j];idx=module.children.indexOf(dependency);if(0<=idx)module.children.splice(idx,1)}}}}hotSetStatus("apply");hotCurrentHash=hotUpdateNewHash;for(moduleId in appliedUpdate){if(Object.prototype.hasOwnProperty.call(appliedUpdate,moduleId)){modules[moduleId]=appliedUpdate[moduleId]}}var error=null;for(moduleId in outdatedDependencies){if(Object.prototype.hasOwnProperty.call(outdatedDependencies,moduleId)){module=installedModules[moduleId];if(module){moduleOutdatedDependencies=outdatedDependencies[moduleId];var callbacks=[];for(i=0;i<moduleOutdatedDependencies.length;i++){dependency=moduleOutdatedDependencies[i];cb=module.hot._acceptedDependencies[dependency];if(cb){if(-1!==callbacks.indexOf(cb))continue;callbacks.push(cb)}}for(i=0;i<callbacks.length;i++){cb=callbacks[i];try{cb(moduleOutdatedDependencies)}catch(err){if(options.onErrored){options.onErrored({type:"accept-errored",moduleId:moduleId,dependencyId:moduleOutdatedDependencies[i],error:err})}if(!options.ignoreErrored){if(!error)error=err}}}}}}for(i=0;i<outdatedSelfAcceptedModules.length;i++){var item=outdatedSelfAcceptedModules[i];moduleId=item.module;hotCurrentParents=[moduleId];try{__webpack_require__(moduleId)}catch(err){if("function"===typeof item.errorHandler){try{item.errorHandler(err)}catch(err2){if(options.onErrored){options.onErrored({type:"self-accept-error-handler-errored",moduleId:moduleId,error:err2,originalError:err})}if(!options.ignoreErrored){if(!error)error=err2}if(!error)error=err}}else{if(options.onErrored){options.onErrored({type:"self-accept-errored",moduleId:moduleId,error:err})}if(!options.ignoreErrored){if(!error)error=err}}}}if(error){hotSetStatus("fail");return Promise.reject(error)}hotSetStatus("idle");return new Promise(function(resolve){resolve(outdatedModules)})}var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{},hot:hotCreateModule(moduleId),parents:(hotCurrentParentsTemp=hotCurrentParents,hotCurrentParents=[],hotCurrentParentsTemp),children:[]};modules[moduleId].call(module.exports,module,module.exports,hotCreateRequire(moduleId));module.l=!0;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})}};__webpack_require__.r=function(exports){Object.defineProperty(exports,"__esModule",{value:!0})};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.h=function(){return hotCurrentHash};return hotCreateRequire("./index.js")(__webpack_require__.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(module,exports){function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}module.exports=_arrayWithoutHoles},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(module,exports){function _assertThisInitialized(self){if(void 0===self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}module.exports=_assertThisInitialized},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(module,exports){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}module.exports=_asyncToGenerator},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(module,exports){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}module.exports=_classCallCheck},"../node_modules/@babel/runtime/helpers/createClass.js":function(module,exports){function _defineProperties(target,props){for(var i=0,descriptor;i<props.length;i++){descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value"in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}module.exports=_createClass},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(module,exports){function _getPrototypeOf(o){module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}module.exports=_getPrototypeOf},"../node_modules/@babel/runtime/helpers/inherits.js":function(module,exports,__webpack_require__){var setPrototypeOf=__webpack_require__("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});if(superClass)setPrototypeOf(subClass,superClass)}module.exports=_inherits},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(module,exports){function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}module.exports=_iterableToArray},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(module,exports){function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}module.exports=_nonIterableSpread},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(module,exports,__webpack_require__){var _typeof=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),assertThisInitialized=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"===typeof call)){return call}return assertThisInitialized(self)}module.exports=_possibleConstructorReturn},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(module,exports){function _setPrototypeOf(o,p){module.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}module.exports=_setPrototypeOf},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(module,exports,__webpack_require__){var arrayWithoutHoles=__webpack_require__("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),iterableToArray=__webpack_require__("../node_modules/@babel/runtime/helpers/iterableToArray.js"),nonIterableSpread=__webpack_require__("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");function _toConsumableArray(arr){return arrayWithoutHoles(arr)||iterableToArray(arr)||nonIterableSpread()}module.exports=_toConsumableArray},"../node_modules/@babel/runtime/helpers/typeof.js":function(module,exports){function _typeof2(obj){if("function"===typeof Symbol&&"symbol"===typeof Symbol.iterator){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if("function"===typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){module.exports=_typeof=function _typeof(obj){return _typeof2(obj)}}else{module.exports=_typeof=function _typeof(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}module.exports=_typeof},"../node_modules/@babel/runtime/regenerator/index.js":function(module,exports,__webpack_require__){module.exports=__webpack_require__("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/debug/src/browser.js":function(module,exports,__webpack_require__){(function(process){exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage=localstorage();exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs)){return!0}if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return!1}return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(args){args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff);if(!this.useColors){return}const c="color: "+this.color;args.splice(1,0,c,"color: inherit");let index=0,lastC=0;args[0].replace(/%[a-zA-Z%]/g,match=>{if("%%"===match){return}index++;if("%c"===match){lastC=index}});args.splice(lastC,0,c)}function log(...args){return"object"===typeof console&&console.log&&console.log(...args)}function save(namespaces){try{if(namespaces){exports.storage.setItem("debug",namespaces)}else{exports.storage.removeItem("debug")}}catch(error){}}function load(){let r;try{r=exports.storage.getItem("debug")}catch(error){}if(!r&&"undefined"!==typeof process&&"env"in process){r=process.env.DEBUG}return r}function localstorage(){try{return localStorage}catch(error){}}module.exports=__webpack_require__("../node_modules/debug/src/common.js")(exports);const{formatters}=module.exports;formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this,__webpack_require__("../node_modules/process/browser.js"))},"../node_modules/debug/src/common.js":function(module,exports,__webpack_require__){function setup(env){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=__webpack_require__("../node_modules/ms/index.js");Object.keys(env).forEach(key=>{createDebug[key]=env[key]});createDebug.instances=[];createDebug.names=[];createDebug.skips=[];createDebug.formatters={};function selectColor(namespace){let hash=0;for(let i=0;i<namespace.length;i++){hash=(hash<<5)-hash+namespace.charCodeAt(i);hash|=0}return createDebug.colors[_Mathabs(hash)%createDebug.colors.length]}createDebug.selectColor=selectColor;function createDebug(namespace){let prevTime;function debug(...args){if(!debug.enabled){return}const self=debug,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;args[0]=createDebug.coerce(args[0]);if("string"!==typeof args[0]){args.unshift("%O")}let index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,(match,format)=>{if("%%"===match){return match}index++;const formatter=createDebug.formatters[format];if("function"===typeof formatter){const val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match});createDebug.formatArgs.call(self,args);const logFn=self.log||createDebug.log;logFn.apply(self,args)}debug.namespace=namespace;debug.enabled=createDebug.enabled(namespace);debug.useColors=createDebug.useColors();debug.color=selectColor(namespace);debug.destroy=destroy;debug.extend=extend;if("function"===typeof createDebug.init){createDebug.init(debug)}createDebug.instances.push(debug);return debug}function destroy(){const index=createDebug.instances.indexOf(this);if(-1!==index){createDebug.instances.splice(index,1);return!0}return!1}function extend(namespace,delimiter){const newDebug=createDebug(this.namespace+("undefined"===typeof delimiter?":":delimiter)+namespace);newDebug.log=this.log;return newDebug}function enable(namespaces){createDebug.save(namespaces);createDebug.names=[];createDebug.skips=[];let i;const split=("string"===typeof namespaces?namespaces:"").split(/[\s,]+/),len=split.length;for(i=0;i<len;i++){if(!split[i]){continue}namespaces=split[i].replace(/\*/g,".*?");if("-"===namespaces[0]){createDebug.skips.push(new RegExp("^"+namespaces.substr(1)+"$"))}else{createDebug.names.push(new RegExp("^"+namespaces+"$"))}}for(i=0;i<createDebug.instances.length;i++){const instance=createDebug.instances[i];instance.enabled=createDebug.enabled(instance.namespace)}}function disable(){const namespaces=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map(namespace=>"-"+namespace)].join(",");createDebug.enable("");return namespaces}function enabled(name){if("*"===name[name.length-1]){return!0}let i,len;for(i=0,len=createDebug.skips.length;i<len;i++){if(createDebug.skips[i].test(name)){return!1}}for(i=0,len=createDebug.names.length;i<len;i++){if(createDebug.names[i].test(name)){return!0}}return!1}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,"*")}function coerce(val){if(val instanceof Error){return val.stack||val.message}return val}createDebug.enable(createDebug.load());return createDebug}module.exports=setup},"../node_modules/ms/index.js":function(module,exports){var s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d;module.exports=function(val,options){options=options||{};var type=typeof val;if("string"===type&&0<val.length){return parse(val)}else if("number"===type&&!1===isNaN(val)){return options.long?fmtLong(val):fmtShort(val)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))};function parse(str){str=str+"";if(100<str.length){return}var match=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match){return}var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return;}}function fmtShort(ms){var msAbs=_Mathabs(ms);if(msAbs>=d){return _Mathround(ms/d)+"d"}if(msAbs>=h){return _Mathround(ms/h)+"h"}if(msAbs>=m){return _Mathround(ms/m)+"m"}if(msAbs>=s){return _Mathround(ms/s)+"s"}return ms+"ms"}function fmtLong(ms){var msAbs=_Mathabs(ms);if(msAbs>=d){return plural(ms,msAbs,d,"day")}if(msAbs>=h){return plural(ms,msAbs,h,"hour")}if(msAbs>=m){return plural(ms,msAbs,m,"minute")}if(msAbs>=s){return plural(ms,msAbs,s,"second")}return ms+" ms"}function plural(ms,msAbs,n,name){var isPlural=msAbs>=1.5*n;return _Mathround(ms/n)+" "+name+(isPlural?"s":"")}},"../node_modules/process/browser.js":function(module,exports){var process=module.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if("function"===typeof setTimeout){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if("function"===typeof clearTimeout){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=!1;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=!0;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=!1;runClearTimeout(timeout)}process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(1===queue.length&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=!0;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(module,exports,__webpack_require__){var g=function(){return this||"object"===typeof self&&self}()||Function("return this")(),hadRuntime=g.regeneratorRuntime&&0<=Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime"),oldRuntime=hadRuntime&&g.regeneratorRuntime;g.regeneratorRuntime=void 0;module.exports=__webpack_require__("../node_modules/regenerator-runtime/runtime.js");if(hadRuntime){g.regeneratorRuntime=oldRuntime}else{try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=void 0}}},"../node_modules/regenerator-runtime/runtime.js":function(module,exports){!function(global){"use strict";var Op=Object.prototype,hasOwn=Op.hasOwnProperty,undefined,$Symbol="function"===typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag",inModule="object"===typeof module,runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime}return}runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart",GenStateSuspendedYield="suspendedYield",GenStateExecuting="executing",GenStateCompleted="completed",ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg)}})}runtime.isGeneratorFunction=function(genFun){var ctor="function"===typeof genFun&&genFun.constructor;return ctor?ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name):!1};runtime.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction"}}genFun.prototype=Object.create(Gp);return genFun};runtime.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"===record.type){reject(record.arg)}else{var result=record.arg,value=result.value;if(value&&"object"===typeof value&&hasOwn.call(value,"__await")){return Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)})}return Promise.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};runtime.AsyncIterator=AsyncIterator;runtime.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return runtime.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if("throw"===method){throw arg}return doneResult()}context.method=method;context.arg=arg;while(!0){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method){context.sent=context._sent=context.arg}else if("throw"===context.method){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if("return"===context.method){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if("normal"===record.type){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if("throw"===record.type){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(void 0===method){context.delegate=null;if("throw"===context.method){if(delegate.iterator.return){context.method="return";context.arg=void 0;maybeInvokeDelegate(delegate,context);if("throw"===context.method){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if("return"!==context.method){context.method="next";context.arg=void 0}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(!0)}runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=!1;return next}}next.done=!0;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if("function"===typeof iterable.next){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=!1;return next}}next.value=void 0;next.done=!0;return next};return next.next=next}}return{next:doneResult}}runtime.values=values;function doneResult(){return{value:void 0,done:!0}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=void 0;this.done=!1;this.delegate=null;this.method="next";this.arg=void 0;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if("t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=void 0}}}},stop:function(){this.done=!0;var rootEntry=this.tryEntries[0],rootRecord=rootEntry.completion;if("throw"===rootRecord.type){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=void 0}return!!caught}for(var i=this.tryEntries.length-1;0<=i;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,!0)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,!0)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1,entry;0<=i;--i){entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if("throw"===record.type){throw record.arg}if("break"===record.type||"continue"===record.type){this.next=record.arg}else if("return"===record.type){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if("normal"===record.type&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1,entry;0<=i;--i){entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1,entry;0<=i;--i){entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if("next"===this.method){this.arg=void 0}return ContinueSentinel}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(context,fn){context.save();fn(context);context.restore()}},"./drawing/drawArrow.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _drawLine_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./drawing/drawLine.js"),_drawJoinedLines_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/drawJoinedLines.js");__webpack_exports__["default"]=function(context,start,end,color,lineWidth){var headLength=10,angle=Math.atan2(end.y-start.y,end.x-start.x),options={color:color,lineWidth:lineWidth};Object(_drawLine_js__WEBPACK_IMPORTED_MODULE_0__["default"])(context,void 0,start,end,options,"canvas");options={color:color,lineWidth:lineWidth,fillStyle:color};var points=[{x:end.x-headLength*_Mathcos(angle-_MathPI/7),y:end.y-headLength*_Mathsin(angle-_MathPI/7)},{x:end.x-headLength*_Mathcos(angle+_MathPI/7),y:end.y-headLength*_Mathsin(angle+_MathPI/7)},end];Object(_drawJoinedLines_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,void 0,end,points,options,"canvas")}},"./drawing/drawCircle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,center,radius,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===coordSystem){center=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,center)}Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){context.arc(center.x,center.y,radius,0,2*_MathPI)})}},"./drawing/drawEllipse.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,corner1,corner2,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===coordSystem){corner1=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,corner1);corner2=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,corner2)}var x=_Mathmin(corner1.x,corner2.x),y=_Mathmin(corner1.y,corner2.y),w=_Mathabs(corner1.x-corner2.x),h=_Mathabs(corner1.y-corner2.y),kappa=.5522848,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){context.moveTo(x,ym);context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);context.closePath()})}},"./drawing/drawHandles.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolColors.js"),_path_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./drawing/path.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/index.js");__webpack_exports__["default"]=function(context,evtDetail,handles){var options=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},element=evtDetail.element,defaultColor=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__["default"].getToolColor();context.strokeStyle=options.color||defaultColor;for(var handleKeys=Object.keys(handles),_loop=function _loop(i){var handleKey=handleKeys[i],handle=handles[handleKey];if(!0===handle.drawnIndependently){return"continue"}if(!0===options.drawHandlesIfActive&&!handle.active){return"continue"}var lineWidth=handle.active?_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_1__["default"].getActiveWidth():_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_1__["default"].getToolWidth(),fillStyle=options.fill;Object(_path_js__WEBPACK_IMPORTED_MODULE_3__["default"])(context,{lineWidth:lineWidth,fillStyle:fillStyle},function(context){var handleCanvasCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,handle),handleRadius=handle.radius||options.handleRadius||_store_index_js__WEBPACK_IMPORTED_MODULE_4__.state.handleRadius;context.arc(handleCanvasCoords.x,handleCanvasCoords.y,handleRadius,0,2*_MathPI)})},i=0,_ret;i<handleKeys.length;i++){_ret=_loop(i);if("continue"===_ret)continue}}},"./drawing/drawJoinedLines.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,start,points,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){if("pixel"===coordSystem){start=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,start);points=points.map(function(p){return _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,p)})}context.moveTo(start.x,start.y);points.forEach(function(_ref){var x=_ref.x,y=_ref.y;context.lineTo(x,y)})})}},"./drawing/drawLine.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return drawLine});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");function drawLine(context,element,start,end,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){if("pixel"===coordSystem){start=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,start);end=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,end)}context.moveTo(start.x,start.y);context.lineTo(end.x,end.y)})}},"./drawing/drawLines.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,lines,options){var coordSystem=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"pixel";Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){lines.forEach(function(line){var start=line.start,end=line.end;if("pixel"===coordSystem){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone;start=cornerstone.pixelToCanvas(element,start);end=cornerstone.pixelToCanvas(element,end)}context.moveTo(start.x,start.y);context.lineTo(end.x,end.y)})})}},"./drawing/drawLink.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_drawLine_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/drawLine.js");__webpack_exports__["default"]=function(linkAnchorPoints,refPoint,boundingBox,context,color,lineWidth){var start=0<linkAnchorPoints.length?_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.findClosestPoint(linkAnchorPoints,refPoint):refPoint,boundingBoxPoints=[{x:boundingBox.left+boundingBox.width/2,y:boundingBox.top},{x:boundingBox.left,y:boundingBox.top+boundingBox.height/2},{x:boundingBox.left+boundingBox.width/2,y:boundingBox.top+boundingBox.height},{x:boundingBox.left+boundingBox.width,y:boundingBox.top+boundingBox.height/2}],end=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.findClosestPoint(boundingBoxPoints,start),options={color:color,lineWidth:lineWidth,lineDash:[2,3]};Object(_drawLine_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,void 0,start,end,options,"canvas")}},"./drawing/drawLinkedTextBox.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_drawTextBox_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/drawTextBox.js"),_drawLink_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./drawing/drawLink.js");__webpack_exports__["default"]=function(context,element,textBox,text,handles,textBoxAnchorPoints,color,lineWidth,xOffset,yCenter){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,textCoords=cornerstone.pixelToCanvas(element,textBox);if(xOffset){textCoords.x+=xOffset}var options={centering:{x:!1,y:yCenter}};textBox.boundingBox=Object(_drawTextBox_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,text,textCoords.x,textCoords.y,color,options);if(textBox.hasMoved){var linkAnchorPoints=textBoxAnchorPoints(handles).map(function(h){return cornerstone.pixelToCanvas(element,h)});Object(_drawLink_js__WEBPACK_IMPORTED_MODULE_2__["default"])(linkAnchorPoints,textCoords,textBox.boundingBox,context,color,lineWidth)}}},"./drawing/drawRect.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,corner1,corner2,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===coordSystem){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone;corner1=cornerstone.pixelToCanvas(element,corner1);corner2=cornerstone.pixelToCanvas(element,corner2)}var left=_Mathmin(corner1.x,corner2.x),top=_Mathmin(corner1.y,corner2.y),width=_Mathabs(corner1.x-corner2.x),height=_Mathabs(corner1.y-corner2.y);Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){context.rect(left,top,width,height)})}},"./drawing/drawTextBox.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"textBoxWidth",function(){return textBoxWidth});var _stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/textStyle.js"),_draw_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/draw.js"),_fillTextLines_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./drawing/fillTextLines.js"),_fillBox_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./drawing/fillBox.js");function textBoxWidth(context,text,padding){var font=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getFont(),origFont=context.font;if(font&&font!==origFont){context.font=font}var width=context.measureText(text).width;if(font&&font!==origFont){context.font=origFont}return width+2*padding}__webpack_exports__["default"]=function(context,textLines,x,y,color,options){if("[object Array]"!==Object.prototype.toString.call(textLines)){textLines=[textLines]}var padding=5,fontSize=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getFontSize(),backgroundColor=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getBackgroundColor(),maxWidth=0;textLines.forEach(function(text){var width=textBoxWidth(context,text,padding);maxWidth=_Mathmax(maxWidth,width)});var boundingBox={width:maxWidth,height:padding+textLines.length*(fontSize+padding)};Object(_draw_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,function(context){context.strokeStyle=color;if(options&&options.centering&&!0===options.centering.x){x-=boundingBox.width/2}if(options&&options.centering&&!0===options.centering.y){y-=boundingBox.height/2}boundingBox.left=x;boundingBox.top=y;var fillStyle=options&&!0===options.debug?"#FF0000":backgroundColor;Object(_fillBox_js__WEBPACK_IMPORTED_MODULE_3__["default"])(context,boundingBox,fillStyle);Object(_fillTextLines_js__WEBPACK_IMPORTED_MODULE_2__["default"])(context,boundingBox,textLines,color,padding)});return boundingBox}},"./drawing/fillBox.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(context,boundingBox,fillStyle){context.fillStyle=fillStyle;context.fillRect(boundingBox.left,boundingBox.top,boundingBox.width,boundingBox.height)}},"./drawing/fillOutsideRect.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_path_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/path.js");__webpack_exports__["default"]=function(context,element,corner1,corner2,options){var coordSystem=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===coordSystem){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone;corner1=cornerstone.pixelToCanvas(element,corner1);corner2=cornerstone.pixelToCanvas(element,corner2)}var left=_Mathmin(corner1.x,corner2.x),top=_Mathmin(corner1.y,corner2.y),width=_Mathabs(corner1.x-corner2.x),height=_Mathabs(corner1.y-corner2.y);Object(_path_js__WEBPACK_IMPORTED_MODULE_1__["default"])(context,options,function(context){context.rect(0,0,context.canvas.clientWidth,context.canvas.clientHeight);context.rect(left+width,top,-width,height)})}},"./drawing/fillTextLines.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/textStyle.js");__webpack_exports__["default"]=function(context,boundingBox,textLines,fillStyle,padding){var fontSize=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getFontSize();context.font=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getFont();context.textBaseline="top";context.fillStyle=fillStyle;textLines.forEach(function(text,index){context.fillText(text,boundingBox.left+padding,boundingBox.top+padding+index*(fontSize+padding))})}},"./drawing/getNewContext.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(canvas){var context=canvas.getContext("2d");context.setTransform(1,0,0,1,0,0);return context}},"./drawing/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _draw_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./drawing/draw.js");__webpack_require__.d(__webpack_exports__,"draw",function(){return _draw_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _drawArrow_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/drawArrow.js");__webpack_require__.d(__webpack_exports__,"drawArrow",function(){return _drawArrow_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _drawCircle_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./drawing/drawCircle.js");__webpack_require__.d(__webpack_exports__,"drawCircle",function(){return _drawCircle_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _drawEllipse_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./drawing/drawEllipse.js");__webpack_require__.d(__webpack_exports__,"drawEllipse",function(){return _drawEllipse_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _drawHandles_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./drawing/drawHandles.js");__webpack_require__.d(__webpack_exports__,"drawHandles",function(){return _drawHandles_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var _drawJoinedLines_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./drawing/drawJoinedLines.js");__webpack_require__.d(__webpack_exports__,"drawJoinedLines",function(){return _drawJoinedLines_js__WEBPACK_IMPORTED_MODULE_5__["default"]});var _drawLine_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./drawing/drawLine.js");__webpack_require__.d(__webpack_exports__,"drawLine",function(){return _drawLine_js__WEBPACK_IMPORTED_MODULE_6__["default"]});var _drawLines_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./drawing/drawLines.js");__webpack_require__.d(__webpack_exports__,"drawLines",function(){return _drawLines_js__WEBPACK_IMPORTED_MODULE_7__["default"]});var _drawLink_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./drawing/drawLink.js");__webpack_require__.d(__webpack_exports__,"drawLink",function(){return _drawLink_js__WEBPACK_IMPORTED_MODULE_8__["default"]});var _drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./drawing/drawLinkedTextBox.js");__webpack_require__.d(__webpack_exports__,"drawLinkedTextBox",function(){return _drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_9__["default"]});var _drawRect_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/drawRect.js");__webpack_require__.d(__webpack_exports__,"drawRect",function(){return _drawRect_js__WEBPACK_IMPORTED_MODULE_10__["default"]});var _drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/drawTextBox.js");__webpack_require__.d(__webpack_exports__,"drawTextBox",function(){return _drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"]});var _fillBox_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/fillBox.js");__webpack_require__.d(__webpack_exports__,"fillBox",function(){return _fillBox_js__WEBPACK_IMPORTED_MODULE_12__["default"]});var _fillOutsideRect_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./drawing/fillOutsideRect.js");__webpack_require__.d(__webpack_exports__,"fillOutsideRect",function(){return _fillOutsideRect_js__WEBPACK_IMPORTED_MODULE_13__["default"]});var _fillTextLines_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./drawing/fillTextLines.js");__webpack_require__.d(__webpack_exports__,"fillTextLines",function(){return _fillTextLines_js__WEBPACK_IMPORTED_MODULE_14__["default"]});var _getNewContext_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./drawing/getNewContext.js");__webpack_require__.d(__webpack_exports__,"getNewContext",function(){return _getNewContext_js__WEBPACK_IMPORTED_MODULE_15__["default"]});var _path_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./drawing/path.js");__webpack_require__.d(__webpack_exports__,"path",function(){return _path_js__WEBPACK_IMPORTED_MODULE_16__["default"]});var _setShadow_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./drawing/setShadow.js");__webpack_require__.d(__webpack_exports__,"setShadow",function(){return _setShadow_js__WEBPACK_IMPORTED_MODULE_17__["default"]});var _transformCanvasContext_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./drawing/transformCanvasContext.js");__webpack_require__.d(__webpack_exports__,"transformCanvasContext",function(){return _transformCanvasContext_js__WEBPACK_IMPORTED_MODULE_18__["default"]});var _resetCanvasContextTransform_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./drawing/resetCanvasContextTransform.js");__webpack_require__.d(__webpack_exports__,"resetCanvasContextTransform",function(){return _resetCanvasContextTransform_js__WEBPACK_IMPORTED_MODULE_19__["default"]})},"./drawing/path.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/toolStyle.js");__webpack_exports__["default"]=function(context){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},fn=2<arguments.length?arguments[2]:void 0,color=options.color,lineWidth=options.lineWidth,fillStyle=options.fillStyle,lineDash=options.lineDash;context.beginPath();context.strokeStyle=color||context.strokeStyle;context.lineWidth=lineWidth||void 0===lineWidth&&_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_0__["default"].getToolWidth()||context.lineWidth;if(lineDash){context.setLineDash(lineDash)}fn(context);if(fillStyle){context.fillStyle=fillStyle;context.fill()}context.stroke();if(lineDash){context.setLineDash([])}}},"./drawing/resetCanvasContextTransform.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(context){context.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _util_getDefault_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/getDefault.js");__webpack_exports__["default"]=function(context){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(options.shadow){context.shadowColor=Object(_util_getDefault_js__WEBPACK_IMPORTED_MODULE_0__["default"])(options.shadowColor,"#000000");context.shadowBlur=Object(_util_getDefault_js__WEBPACK_IMPORTED_MODULE_0__["default"])(options.shadowBlur,0);context.shadowOffsetX=Object(_util_getDefault_js__WEBPACK_IMPORTED_MODULE_0__["default"])(options.shadowOffsetX,1);context.shadowOffsetY=Object(_util_getDefault_js__WEBPACK_IMPORTED_MODULE_0__["default"])(options.shadowOffsetY,1)}}},"./drawing/transformCanvasContext.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(context,canvas,viewport){if(!(viewport.vflip||viewport.vflip||viewport.rotation)){return}var translation={x:canvas.width/2+viewport.translation.x*viewport.scale,y:canvas.height/2+viewport.translation.y*viewport.scale};context.translate(translation.x,translation.y);if(viewport.rotation){context.rotate(viewport.rotation*_MathPI/180)}if(viewport.vflip){context.scale(1,-1)}if(viewport.hflip){context.scale(-1,1)}context.translate(-translation.x,-translation.y)}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/base/BaseBrushTool.js"),_eventListeners_onImageRenderedBrushEventHandler_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventListeners/onImageRenderedBrushEventHandler.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),onImageRendered=function onImageRendered(evt){var eventData=evt.detail,element=eventData.element,toolsToRender=_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.tools.filter(function(tool){return tool.element===element&&("active"===tool.mode||"passive"===tool.mode||"enabled"===tool.mode)}),brushTools=toolsToRender.filter(function(tool){return tool instanceof _tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"]});if(0<brushTools.length){Object(_eventListeners_onImageRenderedBrushEventHandler_js__WEBPACK_IMPORTED_MODULE_2__["default"])(evt)}toolsToRender.forEach(function(tool){if(tool.renderToolData){tool.renderToolData(evt)}})},enable=function enable(element){element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.IMAGE_RENDERED,onImageRendered)},disable=function disable(element){element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.IMAGE_RENDERED,onImageRendered)};__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventDispatchers/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _imageRenderedEventDispatcher_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventDispatchers/imageRenderedEventDispatcher.js");__webpack_require__.d(__webpack_exports__,"imageRenderedEventDispatcher",function(){return _imageRenderedEventDispatcher_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _mouseToolEventDispatcher_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/mouseToolEventDispatcher.js");__webpack_require__.d(__webpack_exports__,"mouseToolEventDispatcher",function(){return _mouseToolEventDispatcher_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _newImageEventDispatcher_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventDispatchers/newImageEventDispatcher.js");__webpack_require__.d(__webpack_exports__,"newImageEventDispatcher",function(){return _newImageEventDispatcher_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _touchToolEventDispatcher_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./eventDispatchers/touchToolEventDispatcher.js");__webpack_require__.d(__webpack_exports__,"touchToolEventDispatcher",function(){return _touchToolEventDispatcher_js__WEBPACK_IMPORTED_MODULE_3__["default"]})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_3__.getLogger)("eventDispatchers:mouseEventHandlers");__webpack_exports__["default"]=function(evt,tool){logger.log("addNewMeasurement");evt.preventDefault();evt.stopPropagation();var eventData=evt.detail,element=eventData.element,measurementData=tool.createNewMeasurement(eventData);if(!measurementData){return}Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.addToolState)(element,tool.name,measurementData);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var handleMover=1===Object.keys(measurementData.handles).length?_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__.moveHandle:_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__.moveNewHandle;handleMover(eventData,tool.name,measurementData,measurementData.handles.end,tool.options,"mouse")}},"./eventDispatchers/mouseEventHandlers/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"mouseClick",function(){return mouseClick});__webpack_require__.d(__webpack_exports__,"mouseDoubleClick",function(){return mouseDoubleClick});__webpack_require__.d(__webpack_exports__,"mouseUp",function(){return mouseUp});__webpack_require__.d(__webpack_exports__,"mouseWheel",function(){return mouseWheel});var _shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventDispatchers/shared/customCallbackHandler.js"),_mouseDown_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/mouseEventHandlers/mouseDown.js");__webpack_require__.d(__webpack_exports__,"mouseDown",function(){return _mouseDown_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _mouseDownActivate_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");__webpack_require__.d(__webpack_exports__,"mouseDownActivate",function(){return _mouseDownActivate_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _mouseDrag_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./eventDispatchers/mouseEventHandlers/mouseDrag.js");__webpack_require__.d(__webpack_exports__,"mouseDrag",function(){return _mouseDrag_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _mouseMove_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./eventDispatchers/mouseEventHandlers/mouseMove.js");__webpack_require__.d(__webpack_exports__,"mouseMove",function(){return _mouseMove_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var mouseClick=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Mouse","mouseClickCallback"),mouseDoubleClick=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Mouse","doubleClickCallback"),mouseUp=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Mouse","mouseUpCallback"),mouseWheel=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_store_getToolsWithMoveableHandles_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/getToolsWithMoveableHandles.js"),_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/findAndMoveHelpers.js"),_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/getInteractiveToolsForElement.js"),_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./store/getToolsWithDataForElement.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return}var eventData=evt.detail,element=evt.detail.element,coords=evt.detail.currentPoints.canvas,activeAndPassiveTools=Object(_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_0__.getters.mouseTools()),activeTools=activeAndPassiveTools.filter(function(tool){return"active"===tool.mode&&Array.isArray(tool.options.mouseButtonMask)&&tool.options.mouseButtonMask.includes(eventData.buttons)&&tool.options.isMouseActive});if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){activeTools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_6__["default"])(activeTools)}if(0<activeTools.length){var firstActiveToolWithCallback=activeTools.find(function(tool){return"function"===typeof tool.preMouseDownCallback});if(firstActiveToolWithCallback){var consumedEvent=firstActiveToolWithCallback.preMouseDownCallback(evt);if(consumedEvent){return}}}if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){return}var annotationTools=Object(_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_5__["default"])(element,activeAndPassiveTools),annotationToolsWithMoveableHandles=Object(_store_getToolsWithMoveableHandles_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,annotationTools,coords,"mouse");if(0<annotationToolsWithMoveableHandles.length){var firstToolWithMoveableHandles=annotationToolsWithMoveableHandles[0],toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(element,firstToolWithMoveableHandles.name),_findHandleDataNearIm=Object(_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_3__.findHandleDataNearImagePoint)(element,toolState,firstToolWithMoveableHandles.name,coords),handle=_findHandleDataNearIm.handle,data=_findHandleDataNearIm.data;firstToolWithMoveableHandles.handleSelectedCallback(evt,data,handle,"mouse");return}var annotationToolsWithPointNearClick=activeAndPassiveTools.filter(function(tool){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(element,tool.name),isNearPoint=toolState&&toolState.data&&tool.pointNearTool&&toolState.data.some(function(data){return tool.pointNearTool(element,data,coords,"mouse")});return isNearPoint});if(0<annotationToolsWithPointNearClick.length){var firstToolNearPoint=annotationToolsWithPointNearClick[0],_toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(element,firstToolNearPoint.name),firstAnnotationNearPoint=_toolState.data.find(function(data){return firstToolNearPoint.pointNearTool(element,data,coords)});firstToolNearPoint.toolSelectedCallback(evt,firstAnnotationNearPoint,"mouse");return}if(0<activeTools.length){var _firstActiveToolWithCallback=activeTools.find(function(tool){return"function"===typeof tool.postMouseDownCallback});if(_firstActiveToolWithCallback){var _consumedEvent=_firstActiveToolWithCallback.postMouseDownCallback(evt);if(_consumedEvent){return}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/getActiveToolsForElement.js"),_tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked){return}var eventData=evt.detail,element=eventData.element,tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_1__.getters.mouseTools());tools=tools.filter(function(tool){return Array.isArray(tool.options.mouseButtonMask)&&tool.options.mouseButtonMask.includes(eventData.buttons)&&tool.options.isMouseActive});if(_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isMultiPartToolActive){tools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_4__["default"])(tools)}if(0===tools.length){return}var activeTool=tools[0];if("function"===typeof activeTool.preMouseDownActivateCallback){var consumedEvent=activeTool.preMouseDownActivateCallback(evt);if(consumedEvent){return}}if(_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isMultiPartToolActive){return}if(activeTool.addNewMeasurement){activeTool.addNewMeasurement(evt,"mouse")}else if(activeTool instanceof _tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_3__["default"]){Object(_addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_0__["default"])(evt,activeTool)}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getActiveToolsForElement.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return}var tools,eventData=evt.detail,element=eventData.element;tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_0__.getters.mouseTools());tools=tools.filter(function(tool){return Array.isArray(tool.options.mouseButtonMask)&&tool.options.mouseButtonMask.includes(eventData.buttons)&&tool.options.isMouseActive});tools=tools.filter(function(tool){return"function"===typeof tool.mouseDragCallback});if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){tools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__["default"])(tools)}if(0===tools.length){return}var activeTool=tools[0];activeTool.mouseDragCallback(evt)}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/index.js"),_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/getInteractiveToolsForElement.js"),_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/getToolsWithDataForElement.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked||_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isMultiPartToolActive){return}var tools,_evt$detail=evt.detail,element=_evt$detail.element,currentPoints=_evt$detail.currentPoints;_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.mousePositionImage=currentPoints.image;tools=Object(_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_1__.getters.mouseTools());var activeTools=tools.filter(function(tool){return"active"===tool.mode&&tool.options.isMouseActive}),imageNeedsUpdate=!1;if(0<activeTools.length){imageNeedsUpdate=activeTools.some(function(tool){return tool.updateOnMouseMove})}tools=Object(_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,tools);for(var t=0,tool;t<tools.length;t++){tool=tools[t];if("function"===typeof tool.mouseMoveCallback){imageNeedsUpdate=tool.mouseMoveCallback(evt)||imageNeedsUpdate}}if(!0===imageNeedsUpdate){_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/mouseEventHandlers/index.js"),enable=function enable(element){element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseClick);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDown);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN_ACTIVATE,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDownActivate);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOUBLE_CLICK,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDoubleClick);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDrag);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_MOVE,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseMove);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseUp);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_WHEEL,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseWheel)},disable=function disable(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseClick);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDown);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN_ACTIVATE,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDownActivate);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOUBLE_CLICK,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDoubleClick);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseDrag);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_MOVE,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseMove);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseUp);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_WHEEL,_mouseEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseWheel)};__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventDispatchers/newImageEventDispatcher.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/base/BaseBrushTool.js"),_eventListeners_onNewImageBrushEventHandler_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventListeners/onNewImageBrushEventHandler.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),onNewImage=function onNewImage(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return!1}var element=evt.detail.element,tools=_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.tools.filter(function(tool){return tool.element===element&&("active"===tool.mode||"passive"===tool.mode||"enabled"===tool.mode)});if(0===tools.length){return!1}tools.forEach(function(tool){if(tool.newImageCallback){tool.newImageCallback(evt)}});var brushTools=tools.filter(function(tool){return tool instanceof _tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"]});if(0<brushTools.length){Object(_eventListeners_onNewImageBrushEventHandler_js__WEBPACK_IMPORTED_MODULE_2__["default"])(evt)}},enable=function enable(element){element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.NEW_IMAGE,onNewImage)},disable=function disable(element){element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.NEW_IMAGE,onNewImage)};__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventDispatchers/shared/customCallbackHandler.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getActiveToolsForElement.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(handlerType,customFunction,evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return!1}var element=evt.detail.element,tools=_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.tools.filter(function(tool){return tool.supportedInteractionTypes.includes(handlerType)});tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,tools,handlerType);tools=tools.filter(function(tool){return"function"===typeof tool[customFunction]});if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){tools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__["default"])(tools)}if(0===tools.length){return!1}tools[0][customFunction](evt)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/index.js"),_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./manipulators/index.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./stateManagement/toolState.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_6__.getLogger)("eventDispatchers:touchEventHandlers");__webpack_exports__["default"]=function(evt,tool){logger.log("addNewMeasurement");evt.preventDefault();evt.stopPropagation();var touchEventData=evt.detail,element=touchEventData.element,measurementData=tool.createNewMeasurement(touchEventData);if(!measurementData){return}Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.addToolState)(element,tool.name,measurementData);if(1===Object.keys(measurementData.handles).length&&touchEventData.type===_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP){measurementData.active=!1;measurementData.handles.end.active=!1;measurementData.handles.end.highlight=!1;measurementData.invalidated=!0;var deleteIfHandleOutsideImage=_store_index_js__WEBPACK_IMPORTED_MODULE_2__.state.deleteIfHandleOutsideImage||tool.options.deleteIfHandleOutsideImage;if(deleteIfHandleOutsideImage&&Object(_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_3__["default"])(touchEventData,measurementData.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.removeToolState)(element,tool.name,measurementData)}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);return}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_4__.moveNewHandle)(touchEventData,tool.name,measurementData,measurementData.handles.end,tool.options,"touch")}},"./eventDispatchers/touchEventHandlers/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"doubleTap",function(){return doubleTap});__webpack_require__.d(__webpack_exports__,"touchDrag",function(){return touchDrag});__webpack_require__.d(__webpack_exports__,"touchEnd",function(){return touchEnd});__webpack_require__.d(__webpack_exports__,"touchPinch",function(){return touchPinch});__webpack_require__.d(__webpack_exports__,"touchPress",function(){return touchPress});__webpack_require__.d(__webpack_exports__,"touchRotate",function(){return touchRotate});var _shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventDispatchers/shared/customCallbackHandler.js"),_multiTouchDrag_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");__webpack_require__.d(__webpack_exports__,"multiTouchDrag",function(){return _multiTouchDrag_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _tap_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventDispatchers/touchEventHandlers/tap.js");__webpack_require__.d(__webpack_exports__,"tap",function(){return _tap_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _touchStart_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./eventDispatchers/touchEventHandlers/touchStart.js");__webpack_require__.d(__webpack_exports__,"touchStart",function(){return _touchStart_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _touchStartActive_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./eventDispatchers/touchEventHandlers/touchStartActive.js");__webpack_require__.d(__webpack_exports__,"touchStartActive",function(){return _touchStartActive_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var doubleTap=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"DoubleTap","doubleTapCallback"),touchDrag=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Touch","touchDragCallback"),touchEnd=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Touch","touchEndCallback"),touchPinch=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"TouchPinch","touchPinchCallback"),touchPress=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"Touch","touchPressCallback"),touchRotate=_shared_customCallbackHandler_js__WEBPACK_IMPORTED_MODULE_0__["default"].bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getActiveToolsForElement.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return!1}var _evt$detail=evt.detail,element=_evt$detail.element,numPointers=_evt$detail.numPointers,tools=_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.tools.filter(function(tool){return tool.supportedInteractionTypes.includes("MultiTouch")});tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,tools,"MultiTouch");tools=tools.filter(function(tool){return"function"===typeof tool.multiTouchDragCallback&&numPointers===tool.configuration.touchPointers});if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){tools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_2__["default"])(tools)}if(0===tools.length){return!1}var activeTool=tools[0];activeTool.multiTouchDragCallback(evt)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(toolData){if(!toolData){return}for(var i=0,data;i<toolData.data.length;i++){data=toolData.data[i];data.active=!1;if(!data.handles){continue}deactivateAllHandles(data.handles)}};function deactivateAllHandles(handles){Object.keys(handles).forEach(function(name){var handle=handles[name];handle.active=!1})}},"./eventDispatchers/touchEventHandlers/tap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_touchStartActive_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/touchEventHandlers/touchStartActive.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/getActiveToolsForElement.js"),_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/getToolsWithDataForElement.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./manipulators/getHandleNearImagePoint.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./manipulators/index.js"),_shared_deactivateAllToolInstances_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_2__.state.isToolLocked||_store_index_js__WEBPACK_IMPORTED_MODULE_2__.state.isMultiPartToolActive){return}var tools,distanceFromHandle=28,element=evt.detail.element,coords=evt.detail.currentPoints.canvas;tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_2__.getters.touchTools());tools=Object(_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,tools);var toolsWithMoveableHandles=tools.filter(function(tool){for(var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.getToolState)(element,tool.name),i=0;i<toolState.data.length;i++){if(void 0!==Object(_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__["default"])(element,toolState.data[i].handles,coords,distanceFromHandle)){return!0}}return!1});if(0<toolsWithMoveableHandles.length){var firstToolWithMoveableHandles=toolsWithMoveableHandles[0],toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.getToolState)(element,firstToolWithMoveableHandles.name),moveableHandle=toolState.data.find(function(d){return void 0!==Object(_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__["default"])(element,d.handles,coords,distanceFromHandle)});toolState.data.active=!0;moveableHandle.active=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var toolOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){Object(_shared_deactivateAllToolInstances_js__WEBPACK_IMPORTED_MODULE_8__["default"])(toolState)}},firstToolWithMoveableHandles.options);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__.moveHandle)(evt.detail,firstToolWithMoveableHandles.name,toolState.data,moveableHandle,toolOptions,"touch");evt.stopImmediatePropagation();evt.preventDefault();return}var toolsNearPoint=tools.filter(function(tool){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.getToolState)(element,tool.name),isNearPoint=toolState&&toolState.data&&tool.pointNearTool&&toolState.data.some(function(data){return tool.pointNearTool(element,data,coords)});return isNearPoint});if(0<toolsNearPoint.length){var firstToolNearPoint=toolsNearPoint[0],_toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.getToolState)(element,firstToolNearPoint.name),firstAnnotationNearPoint=_toolState.data.find(function(data){return firstToolNearPoint.pointNearTool(element,data,coords)});firstAnnotationNearPoint.active=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var _toolOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){Object(_shared_deactivateAllToolInstances_js__WEBPACK_IMPORTED_MODULE_8__["default"])(_toolState)}},firstToolNearPoint.options);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__.moveAllHandles)(evt.detail,firstToolNearPoint.name,firstAnnotationNearPoint,null,_toolOptions,"touch");evt.stopImmediatePropagation();evt.preventDefault();return}var allActiveTools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_2__.getters.touchTools());if(0<allActiveTools.length&&allActiveTools[0].touchStartActiveCallback){allActiveTools[0].touchStartActiveCallback(evt)}else{Object(_touchStartActive_js__WEBPACK_IMPORTED_MODULE_1__["default"])(evt)}return!1}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/findAndMoveHelpers.js"),_store_getToolsWithMoveableHandles_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/getToolsWithMoveableHandles.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/getInteractiveToolsForElement.js"),_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./store/getToolsWithDataForElement.js"),_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./store/filterToolsUsableWithMultiPartTools.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked){return}var eventData=evt.detail,element=eventData.element,coords=eventData.startPoints.canvas,activeAndPassiveTools=Object(_store_getInteractiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_0__.getters.touchTools()),activeTools=activeAndPassiveTools.filter(function(tool){return"active"===tool.mode&&tool.options.isTouchActive});if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){activeTools=Object(_store_filterToolsUsableWithMultiPartTools_js__WEBPACK_IMPORTED_MODULE_6__["default"])(activeTools)}if(0<activeTools.length){var firstActiveToolWithCallback=activeTools.find(function(tool){return"function"===typeof tool.preTouchStartCallback});if(firstActiveToolWithCallback){var consumedEvent=firstActiveToolWithCallback.preTouchStartCallback(evt);if(consumedEvent){return}}}if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){return}var annotationTools=Object(_store_getToolsWithDataForElement_js__WEBPACK_IMPORTED_MODULE_5__["default"])(element,activeAndPassiveTools),annotationToolsWithMoveableHandles=Object(_store_getToolsWithMoveableHandles_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,annotationTools,coords,"touch");if(0<annotationToolsWithMoveableHandles.length){var firstToolWithMoveableHandles=annotationToolsWithMoveableHandles[0],toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,firstToolWithMoveableHandles.name),_findHandleDataNearIm=Object(_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_1__.findHandleDataNearImagePoint)(element,toolState,firstToolWithMoveableHandles.name,coords,"touch"),handle=_findHandleDataNearIm.handle,data=_findHandleDataNearIm.data;firstToolWithMoveableHandles.handleSelectedCallback(evt,data,handle,"touch");return}var annotationToolsWithPointNearTouch=annotationTools.filter(function(tool){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,tool.name),isNearPoint=toolState&&toolState.data&&tool.pointNearTool&&toolState.data.some(function(data){return tool.pointNearTool(element,data,coords,"touch")});return isNearPoint});if(0<annotationToolsWithPointNearTouch.length){var firstToolNearPoint=annotationToolsWithPointNearTouch[0],_toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,firstToolNearPoint.name),firstAnnotationNearPoint=_toolState.data.find(function(data){return firstToolNearPoint.pointNearTool(element,data,coords)});firstToolNearPoint.toolSelectedCallback(evt,firstAnnotationNearPoint,"touch");return}if(0<activeTools.length){var _firstActiveToolWithCallback=activeTools.find(function(tool){return"function"===typeof tool.postTouchStartCallback});if(_firstActiveToolWithCallback){var _consumedEvent=_firstActiveToolWithCallback.postTouchStartCallback(evt);if(_consumedEvent){return}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getActiveToolsForElement.js"),_addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),_tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/base/BaseAnnotationTool.js");__webpack_exports__["default"]=function(evt){if(_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked||_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isMultiPartToolActive){return}var element=evt.detail.element,tools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_0__.getters.touchTools());tools=tools.filter(function(tool){return tool.options.isTouchActive});if(0===tools.length){return}var activeTool=tools[0];if(activeTool&&activeTool.addNewMeasurement){activeTool.addNewMeasurement(evt,"touch")}else if(activeTool instanceof _tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_3__["default"]){Object(_addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_2__["default"])(evt,activeTool)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/touchEventHandlers/index.js"),enable=function enable(element){element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.tap);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchStart,{passive:!1});element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchDrag,{passive:!1});element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchEnd);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START_ACTIVE,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchStartActive);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchPress);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].DOUBLE_TAP,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.doubleTap);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchPinch);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_ROTATE,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchRotate);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MULTI_TOUCH_DRAG,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.multiTouchDrag)},disable=function disable(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.tap);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchStart);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchDrag);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchEnd);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START_ACTIVE,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchStartActive);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchPress);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].DOUBLE_TAP,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.doubleTap);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchPinch);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_ROTATE,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchRotate);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MULTI_TOUCH_DRAG,_touchEventHandlers_index_js__WEBPACK_IMPORTED_MODULE_1__.multiTouchDrag)};__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventListeners/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _mouseEventListeners_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventListeners/mouseEventListeners.js");__webpack_require__.d(__webpack_exports__,"mouseEventListeners",function(){return _mouseEventListeners_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _wheelEventListener_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventListeners/wheelEventListener.js");__webpack_require__.d(__webpack_exports__,"wheelEventListener",function(){return _wheelEventListener_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _touchEventListeners_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./eventListeners/touchEventListeners.js");__webpack_require__.d(__webpack_exports__,"touchEventListeners",function(){return _touchEventListeners_js__WEBPACK_IMPORTED_MODULE_2__["default"]})},"./eventListeners/internals/normalizeWheel.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var PIXEL_STEP=10,LINE_HEIGHT=40,PAGE_HEIGHT=800;__webpack_exports__["default"]=function(event){var spinX=0,spinY=0,pixelX=0,pixelY=0;if("detail"in event){spinY=event.detail}if("wheelDelta"in event){spinY=-event.wheelDelta/120}if("wheelDeltaY"in event){spinY=-event.wheelDeltaY/120}if("wheelDeltaX"in event){spinX=-event.wheelDeltaX/120}pixelX=spinX*PIXEL_STEP;pixelY=spinY*PIXEL_STEP;if("deltaY"in event){pixelY=event.deltaY}if("deltaX"in event){pixelX=event.deltaX}if((pixelX||pixelY)&&event.deltaMode){if(1===event.deltaMode){pixelX*=LINE_HEIGHT;pixelY*=LINE_HEIGHT}else{pixelX*=PAGE_HEIGHT;pixelY*=PAGE_HEIGHT}}if(pixelX&&!spinX){spinX=1>pixelX?-1:1}if(pixelY&&!spinY){spinY=1>pixelY?-1:1}return{spinX:spinX,spinY:spinY,pixelX:pixelX,pixelY:pixelY}}},"./eventListeners/mouseEventListeners.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/copyPoints.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/triggerEvent.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_4__.getLogger)("eventListeners:mouseEventListeners"),isClickEvent=!0,preventClickTimeout,clickDelay=200;function getEventButtons(event){if("number"===typeof event.buttons){return event.buttons}switch(event.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2;}return 0}function preventClickHandler(){isClickEvent=!1}function mouseDoubleClick(e){var element=e.currentTarget,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOUBLE_CLICK,startPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);var lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(startPoints);logger.log("double-click: %o",getEventButtons(e));var eventData={event:e,buttons:getEventButtons(e),viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:startPoints,deltaPoints:{x:0,y:0},type:eventType};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,eventType,eventData)}function mouseDown(e){var element=e.currentTarget,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}preventClickTimeout=setTimeout(preventClickHandler,clickDelay);element.removeEventListener("mousemove",mouseMove);var startPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);var lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(startPoints),eventData={event:e,buttons:getEventButtons(e),viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:startPoints,deltaPoints:{x:0,y:0},type:_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN},eventPropagated=Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData.element,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN,eventData);if(eventPropagated){eventData.type=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN_ACTIVATE;Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData.element,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DOWN_ACTIVATE,eventData)}function onMouseMove(e){var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG,currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);var deltaPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.page,lastPoints.page),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.image,lastPoints.image),client:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.client,lastPoints.client),canvas:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.canvas,lastPoints.canvas)};logger.log("mousemove: %o",getEventButtons(e));var eventData={buttons:getEventButtons(e),viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:currentPoints,deltaPoints:deltaPoints,type:eventType,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData.element,eventType,eventData);lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(currentPoints)}function onMouseUp(e){clearTimeout(preventClickTimeout);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP;if(isClickEvent){eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK}var currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);var deltaPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.page,lastPoints.page),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.image,lastPoints.image),client:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.client,lastPoints.client),canvas:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.canvas,lastPoints.canvas)};logger.log("mouseup: %o",getEventButtons(e));var eventData={event:e,buttons:getEventButtons(e),viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:currentPoints,deltaPoints:deltaPoints,type:eventType};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData.element,eventType,eventData);document.removeEventListener("mousemove",onMouseMove);document.removeEventListener("mouseup",onMouseUp);element.addEventListener("mousemove",mouseMove);isClickEvent=!0}document.addEventListener("mousemove",onMouseMove);document.addEventListener("mouseup",onMouseUp)}function mouseMove(e){var element=e.currentTarget,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_MOVE,startPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);var lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(startPoints),currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);var deltaPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.page,lastPoints.page),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.image,lastPoints.image),client:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.client,lastPoints.client),canvas:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.canvas,lastPoints.canvas)},eventData={viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:currentPoints,deltaPoints:deltaPoints,type:eventType};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,eventType,eventData);lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(currentPoints)}function disable(element){element.removeEventListener("mousedown",mouseDown);element.removeEventListener("mousemove",mouseMove);element.removeEventListener("dblclick",mouseDoubleClick)}function enable(element){disable(element);element.addEventListener("mousedown",mouseDown);element.addEventListener("mousemove",mouseMove);element.addEventListener("dblclick",mouseDoubleClick)}__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getActiveToolsForElement.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolState.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/base/BaseBrushTool.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./drawing/index.js");if(!("createImageBitmap"in window)){window.createImageBitmap=function(imageData){return new Promise(function(resolve){var img=document.createElement("img");img.addEventListener("load",function(){resolve(this)});var conversionCanvas=document.createElement("canvas");conversionCanvas.width=imageData.width;conversionCanvas.height=imageData.height;var conversionCanvasContext=conversionCanvas.getContext("2d");conversionCanvasContext.putImageData(imageData,0,0,0,0,conversionCanvas.width,conversionCanvas.height);img.src=conversionCanvas.toDataURL()})}}var _store$modules$brush=_store_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].modules.brush,state=_store$modules$brush.state,getters=_store$modules$brush.getters,setters=_store$modules$brush.setters;__webpack_exports__["default"]=function(evt){var eventData=evt.detail,element=eventData.element,maxSegmentations=_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_4__["default"].getNumberOfColors(),toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(element,_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_4__["default"].getReferencedToolDataName());if(!toolData){return}for(var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.getEnabledElement(element),enabledElementUID=enabledElement.uuid,segData={visibleSegmentations:getters.visibleSegmentationsForElement(enabledElementUID),imageBitmapCache:getters.imageBitmapCacheForElement(enabledElementUID),toolData:toolData},segIndex=0;segIndex<maxSegmentations;segIndex++){if(shouldRenderSegmentation(evt,segIndex,segData)){renderSegmentation(evt,segIndex,segData)}}};function shouldRenderSegmentation(evt,segIndex,segData){var element=evt.detail.element,toolData=segData.toolData,visibleSegmentations=segData.visibleSegmentations;if(!toolData.data[segIndex]||!toolData.data[segIndex].pixelData){return!1}if(visibleSegmentations[segIndex]){return!0}var currentColor=state.drawColorId;if(currentColor!==segIndex){return!1}var activeTools=Object(_store_getActiveToolsForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,_store_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.tools),brushTools=activeTools.filter(function(tool){return tool instanceof _tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_4__["default"]});if(0<brushTools.length){return!0}return!1}function renderSegmentation(evt,segIndex,segData){var toolData=segData.toolData,imageBitmapCache=segData.imageBitmapCache,visibleSegmentations=segData.visibleSegmentations;if(imageBitmapCache&&imageBitmapCache[segIndex]){_drawImageBitmap(evt,imageBitmapCache[segIndex],visibleSegmentations[segIndex])}if(toolData.data[segIndex].invalidated){createNewBitmapAndQueueRenderOfSegmentation(evt,toolData,segIndex)}}function createNewBitmapAndQueueRenderOfSegmentation(evt,toolData,segIndex){var eventData=evt.detail,element=eventData.element,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.getEnabledElement(element),pixelData=toolData.data[segIndex].pixelData;if(!pixelData){return}var colormapId=state.colorMapId,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.colors.getColormap(colormapId),colorLutTable=[[0,0,0,0],colormap.getColor(segIndex)],imageData=new ImageData(eventData.image.width,eventData.image.height),image={stats:{},minPixelValue:0,getPixelData:function getPixelData(){return pixelData}};_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.storedPixelDataToCanvasImageDataColorLUT(image,colorLutTable,imageData.data);window.createImageBitmap(imageData).then(function(newImageBitmap){setters.imageBitmapCacheForElement(enabledElement.uuid,segIndex,newImageBitmap);toolData.data[segIndex].invalidated=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.updateImage(eventData.element)})}function _drawImageBitmap(evt,imageBitmap,alwaysVisible){var eventData=evt.detail,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_5__.getNewContext)(eventData.canvasContext.canvas),canvasTopLeft=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,{x:0,y:0}),canvasTopRight=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,{x:eventData.image.width,y:0}),canvasBottomRight=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,{x:eventData.image.width,y:eventData.image.height}),cornerstoneCanvasWidth=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstoneMath.point.distance(canvasTopLeft,canvasTopRight),cornerstoneCanvasHeight=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstoneMath.point.distance(canvasTopRight,canvasBottomRight),canvas=eventData.canvasContext.canvas,viewport=eventData.viewport;context.imageSmoothingEnabled=!1;context.globalAlpha=getLayerAlpha(alwaysVisible);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_5__.transformCanvasContext)(context,canvas,viewport);var canvasViewportTranslation={x:viewport.translation.x*viewport.scale,y:viewport.translation.y*viewport.scale};context.drawImage(imageBitmap,canvas.width/2-cornerstoneCanvasWidth/2+canvasViewportTranslation.x,canvas.height/2-cornerstoneCanvasHeight/2+canvasViewportTranslation.y,cornerstoneCanvasWidth,cornerstoneCanvasHeight);context.globalAlpha=1;Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_5__.resetCanvasContextTransform)(context)}function getLayerAlpha(alwaysVisible){if(alwaysVisible){return state.alpha}return state.hiddenButActiveAlpha}},"./eventListeners/onNewImageBrushEventHandler.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/toolState.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/base/BaseBrushTool.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(evt){var eventData=evt.detail,element=eventData.element,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__.getToolState)(element,_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"].getReferencedToolDataName());if(!toolData){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__.addToolState)(element,_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"].getReferencedToolDataName(),{});toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__.getToolState)(element,_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"].getReferencedToolDataName())}for(var maxSegmentations=_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"].getNumberOfColors(),i=0;i<maxSegmentations;i++){if(toolData.data[i]){toolData.data[i].invalidated=!0}}_externalModules_js__WEBPACK_IMPORTED_MODULE_2__["default"].cornerstone.updateImage(eventData.element)}},"./eventListeners/preventGhostClick.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var antiGhostDelay=2e3,pointerType={mouse:0,touch:1},lastInteractionType,lastInteractionTime;function handleTap(type,e){var now=Date.now();if(type!==lastInteractionType){if(now-lastInteractionTime<=antiGhostDelay){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();return!1}lastInteractionType=type}lastInteractionTime=now}var handleTapMouse=handleTap.bind(null,pointerType.mouse),handleTapTouch=handleTap.bind(null,pointerType.touch);function attachEvents(element,eventList,interactionType){var tapHandler=interactionType?handleTapMouse:handleTapTouch;eventList.forEach(function(eventName){element.addEventListener(eventName,tapHandler,{passive:!1})})}function removeEvents(element,eventList,interactionType){var tapHandler=interactionType?handleTapMouse:handleTapTouch;eventList.forEach(function(eventName){element.removeEventListener(eventName,tapHandler)})}var mouseEvents=["mousedown","mouseup"],touchEvents=["touchstart","touchend"];function disable(element){removeEvents(element,mouseEvents,pointerType.mouse);removeEvents(element,touchEvents,pointerType.touch)}function enable(element){disable(element);attachEvents(element,mouseEvents,pointerType.mouse);attachEvents(element,touchEvents,pointerType.touch)}__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventListeners/touchEventListeners.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/copyPoints.js"),_preventGhostClick_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./eventListeners/preventGhostClick.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/triggerEvent.js"),_toolOptions_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./toolOptions.js"),startPoints,currentPoints,lastPoints,deltaPoints,eventData,touchStartDelay,pressTimeout,pageDistanceMoved,lastScale=1,lastRotation=0,preventNextPinch=!1,isPress=!1,lastDelta,pressDelay=700,pressMaxDistance=5,toolType="touchInput";function onTouch(e){var element=e.currentTarget||e.srcEvent.currentTarget,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}var eventType,scaleChange,delta,remainingPointers,rotation;e.preventDefault();if(e.pointers&&1<e.pointers.length||e.touches&&1<e.touches.length){isPress=!1;clearTimeout(pressTimeout)}switch(e.type){case"tap":isPress=!1;clearTimeout(pressTimeout);currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.pointers[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP;eventData={event:e,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,currentPoints:currentPoints,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);break;case"doubletap":isPress=!1;clearTimeout(pressTimeout);currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.pointers[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].DOUBLE_TAP;eventData={event:e,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,currentPoints:currentPoints,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);break;case"pinchstart":isPress=!1;clearTimeout(pressTimeout);lastScale=1;break;case"pinchmove":isPress=!1;clearTimeout(pressTimeout);if(!0===preventNextPinch){lastScale=e.scale;preventNextPinch=!1;break}scaleChange=(e.scale-lastScale)/lastScale;startPoints={page:e.center,image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.center.x,e.center.y)};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH;eventData={event:e,startPoints:startPoints,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,direction:1>e.scale?1:-1,scaleChange:scaleChange,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);lastScale=e.scale;break;case"touchstart":lastScale=1;clearTimeout(pressTimeout);clearTimeout(touchStartDelay);touchStartDelay=setTimeout(function(){startPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.touches[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START;if(1<e.touches.length){eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MULTI_TOUCH_START}eventData={event:e,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,currentPoints:startPoints,type:eventType,isTouchEvent:!0};var eventPropagated=Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);if(!0===eventPropagated){eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START_ACTIVE;if(1<e.touches.length){eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MULTI_TOUCH_START_ACTIVE}eventData.type=eventType;Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData)}lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(startPoints)},50);isPress=!0;pageDistanceMoved=0;pressTimeout=setTimeout(function(){if(!isPress){return}currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.touches[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS;eventData={event:e,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,currentPoints:currentPoints,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData)},pressDelay);break;case"touchend":lastScale=1;isPress=!1;clearTimeout(pressTimeout);setTimeout(function(){startPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}};startPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,startPoints.image);eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END;eventData={event:e,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,currentPoints:startPoints,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData)},50);break;case"panmove":delta={x:e.deltaX-lastDelta.x,y:e.deltaY-lastDelta.y};lastDelta={x:e.deltaX,y:e.deltaY};currentPoints={page:{x:lastPoints.page.x+delta.x,y:lastPoints.page.y+delta.y},image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,lastPoints.page.x+delta.x,lastPoints.page.y+delta.y),client:{x:lastPoints.client.x+delta.x,y:lastPoints.client.y+delta.y}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);deltaPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.page,lastPoints.page),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.image,lastPoints.image),client:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.client,lastPoints.client),canvas:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.canvas,lastPoints.canvas)};pageDistanceMoved+=_Mathsqrt(deltaPoints.page.x*deltaPoints.page.x+deltaPoints.page.y*deltaPoints.page.y);if(pageDistanceMoved>pressMaxDistance){isPress=!1;clearTimeout(pressTimeout)}eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG;if(1<e.pointers.length){eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MULTI_TOUCH_DRAG}eventData={viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:currentPoints,deltaPoints:deltaPoints,numPointers:e.pointers.length,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(currentPoints);break;case"panstart":lastDelta={x:e.deltaX,y:e.deltaY};currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.pointers[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);lastPoints=Object(_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_2__["default"])(currentPoints);break;case"panend":isPress=!1;clearTimeout(pressTimeout);if(!lastPoints){return!1}currentPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.pageToPoint(e.pointers[0]),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}};currentPoints.canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,currentPoints.image);deltaPoints={page:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.page,lastPoints.page),image:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.image,lastPoints.image),client:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.client,lastPoints.client),canvas:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.subtract(currentPoints.canvas,lastPoints.canvas)};eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG_END;eventData={event:e.srcEvent,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,startPoints:startPoints,lastPoints:lastPoints,currentPoints:currentPoints,deltaPoints:deltaPoints,type:eventType,isTouchEvent:!0};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);remainingPointers=e.pointers.length-e.changedPointers.length;if(2===remainingPointers){preventNextPinch=!0}break;case"rotatemove":isPress=!1;clearTimeout(pressTimeout);rotation=e.rotation-lastRotation;lastRotation=e.rotation;eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_ROTATE;eventData={event:e.srcEvent,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),image:enabledElement.image,element:element,rotation:rotation,type:eventType};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,eventData);break;}return!1}function enable(element){disable(element);var Hammer=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].Hammer,hammerOptions={inputClass:Hammer.SUPPORT_POINTER_EVENTS?Hammer.PointerEventInput:Hammer.TouchInput},mc=new Hammer.Manager(element,hammerOptions),panOptions={pointers:0,direction:Hammer.DIRECTION_ALL,threshold:0},pan=new Hammer.Pan(panOptions),pinch=new Hammer.Pinch({threshold:0}),rotate=new Hammer.Rotate({threshold:0});pinch.recognizeWith(pan);pinch.recognizeWith(rotate);rotate.recognizeWith(pan);var doubleTap=new Hammer.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});doubleTap.recognizeWith(pan);mc.add([doubleTap,pan,rotate,pinch]);mc.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",onTouch);_preventGhostClick_js__WEBPACK_IMPORTED_MODULE_3__["default"].enable(element);var touchEvents=["touchstart","touchend"];touchEvents.forEach(function(eventType){element.addEventListener(eventType,onTouch,{passive:!1})});var options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_5__.getToolOptions)(toolType,element);options.hammer=mc;Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_5__.setToolOptions)(toolType,element,options)}function disable(element){_preventGhostClick_js__WEBPACK_IMPORTED_MODULE_3__["default"].disable(element);var touchEvents=["touchstart","touchend"];touchEvents.forEach(function(eventType){element.removeEventListener(eventType,onTouch)});var options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_5__.getToolOptions)(toolType,element),mc=options.hammer;if(mc){mc.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",onTouch)}}var touchInput={enable:enable,disable:disable};__webpack_exports__["default"]=touchInput},"./eventListeners/wheelEventListener.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/triggerEvent.js"),_internals_normalizeWheel_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./eventListeners/internals/normalizeWheel.js");function wheelEventHandler(evt){var element=evt.currentTarget,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}evt.preventDefault();var pageX=evt.pageX,pageY=evt.pageY,startingCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,pageX,pageY),_normalizeWheel=Object(_internals_normalizeWheel_js__WEBPACK_IMPORTED_MODULE_3__["default"])(evt),spinX=_normalizeWheel.spinX,spinY=_normalizeWheel.spinY,pixelX=_normalizeWheel.pixelX,pixelY=_normalizeWheel.pixelY,direction=0>spinY?-1:1,mouseWheelData={element:element,viewport:_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getViewport(element),detail:evt,image:enabledElement.image,direction:direction,spinX:spinX,spinY:spinY,pixelX:pixelX,pixelY:pixelY,pageX:pageX,pageY:pageY,imageX:startingCoords.x,imageY:startingCoords.y};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_WHEEL,mouseWheelData)}function enable(element){disable(element);element.addEventListener("wheel",wheelEventHandler,{passive:!1})}function disable(element){element.removeEventListener("wheel",wheelEventHandler,{passive:!1})}__webpack_exports__["default"]={enable:enable,disable:disable}},"./eventListeners/windowResizeHandler.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"forceEnabledElementResize",function(){return forceEnabledElementResize});var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),enable=function enable(){disable();window.addEventListener("resize",resizeThrottler,!1)},disable=function disable(){window.removeEventListener("resize",resizeThrottler,!1)},resizeTimeout;function resizeThrottler(){if(!resizeTimeout){resizeTimeout=setTimeout(function(){resizeTimeout=null;forceEnabledElementResize()},66)}}var forceEnabledElementResize=function forceEnabledElementResize(){_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.enabledElements.forEach(function(element){_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.resize(element)})};__webpack_exports__["default"]={enable:enable,disable:disable}},"./events.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var EVENTS={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll"};__webpack_exports__["default"]=EVENTS},"./externalModules.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var cornerstone=window.cornerstone,cornerstoneMath=window.cornerstoneMath,Hammer=window.Hammer;__webpack_exports__["default"]={set cornerstone(cs){cornerstone=cs},get cornerstone(){return cornerstone},set cornerstoneMath(cm){cornerstoneMath=cm},get cornerstoneMath(){return cornerstoneMath},set Hammer(module){Hammer=module},get Hammer(){return Hammer}}},"./import.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _lib_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./lib.js");__webpack_exports__["default"]=function(uri){return _lib_js__WEBPACK_IMPORTED_MODULE_0__.lib[uri]}},"./index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/annotation/index.js");__webpack_require__.d(__webpack_exports__,"AngleTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.AngleTool});__webpack_require__.d(__webpack_exports__,"ArrowAnnotateTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.ArrowAnnotateTool});__webpack_require__.d(__webpack_exports__,"BidirectionalTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.BidirectionalTool});__webpack_require__.d(__webpack_exports__,"CobbAngleTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.CobbAngleTool});__webpack_require__.d(__webpack_exports__,"EllipticalRoiTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.EllipticalRoiTool});__webpack_require__.d(__webpack_exports__,"FreehandMouseTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.FreehandMouseTool});__webpack_require__.d(__webpack_exports__,"LengthTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.LengthTool});__webpack_require__.d(__webpack_exports__,"ProbeTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.ProbeTool});__webpack_require__.d(__webpack_exports__,"RectangleRoiTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.RectangleRoiTool});__webpack_require__.d(__webpack_exports__,"TextMarkerTool",function(){return _tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.TextMarkerTool});var _tools_brush_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/brush/index.js");__webpack_require__.d(__webpack_exports__,"BrushTool",function(){return _tools_brush_index_js__WEBPACK_IMPORTED_MODULE_1__.BrushTool});var _tools_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./tools/index.js");__webpack_require__.d(__webpack_exports__,"CrosshairsTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.CrosshairsTool});__webpack_require__.d(__webpack_exports__,"DoubleTapFitToWindowTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.DoubleTapFitToWindowTool});__webpack_require__.d(__webpack_exports__,"DragProbeTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.DragProbeTool});__webpack_require__.d(__webpack_exports__,"EraserTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.EraserTool});__webpack_require__.d(__webpack_exports__,"FreehandSculpterMouseTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.FreehandSculpterMouseTool});__webpack_require__.d(__webpack_exports__,"MagnifyTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.MagnifyTool});__webpack_require__.d(__webpack_exports__,"PanMultiTouchTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.PanMultiTouchTool});__webpack_require__.d(__webpack_exports__,"PanTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.PanTool});__webpack_require__.d(__webpack_exports__,"ReferenceLinesTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ReferenceLinesTool});__webpack_require__.d(__webpack_exports__,"RotateTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.RotateTool});__webpack_require__.d(__webpack_exports__,"RotateTouchTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.RotateTouchTool});__webpack_require__.d(__webpack_exports__,"ScaleOverlayTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ScaleOverlayTool});__webpack_require__.d(__webpack_exports__,"StackScrollMouseWheelTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollMouseWheelTool});__webpack_require__.d(__webpack_exports__,"StackScrollMultiTouchTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollMultiTouchTool});__webpack_require__.d(__webpack_exports__,"StackScrollTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollTool});__webpack_require__.d(__webpack_exports__,"WwwcRegionTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.WwwcRegionTool});__webpack_require__.d(__webpack_exports__,"WwwcTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.WwwcTool});__webpack_require__.d(__webpack_exports__,"ZoomMouseWheelTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomMouseWheelTool});__webpack_require__.d(__webpack_exports__,"ZoomTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomTool});__webpack_require__.d(__webpack_exports__,"ZoomTouchPinchTool",function(){return _tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomTouchPinchTool});var _import_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./import.js"),_init_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./init.js");__webpack_require__.d(__webpack_exports__,"init",function(){return _init_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var _stackTools_stackPrefetch_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./stackTools/stackPrefetch.js");__webpack_require__.d(__webpack_exports__,"stackPrefetch",function(){return _stackTools_stackPrefetch_js__WEBPACK_IMPORTED_MODULE_5__["default"]});var _stackTools_stackRenderers_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./stackTools/stackRenderers.js");__webpack_require__.d(__webpack_exports__,"stackRenderers",function(){return _stackTools_stackRenderers_js__WEBPACK_IMPORTED_MODULE_6__["default"]});var _stackTools_playClip_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stackTools/playClip.js");__webpack_require__.d(__webpack_exports__,"playClip",function(){return _stackTools_playClip_js__WEBPACK_IMPORTED_MODULE_7__.playClip});__webpack_require__.d(__webpack_exports__,"stopClip",function(){return _stackTools_playClip_js__WEBPACK_IMPORTED_MODULE_7__.stopClip});var _store_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./store/index.js");__webpack_require__.d(__webpack_exports__,"store",function(){return _store_index_js__WEBPACK_IMPORTED_MODULE_8__["default"]});var _store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./store/getToolForElement.js");__webpack_require__.d(__webpack_exports__,"getToolForElement",function(){return _store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_9__["default"]});var _store_addTool_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./store/addTool.js");__webpack_require__.d(__webpack_exports__,"addTool",function(){return _store_addTool_js__WEBPACK_IMPORTED_MODULE_10__.addTool});__webpack_require__.d(__webpack_exports__,"addToolForElement",function(){return _store_addTool_js__WEBPACK_IMPORTED_MODULE_10__.addToolForElement});var _store_removeTool_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./store/removeTool.js");__webpack_require__.d(__webpack_exports__,"removeTool",function(){return _store_removeTool_js__WEBPACK_IMPORTED_MODULE_11__.removeTool});__webpack_require__.d(__webpack_exports__,"removeToolForElement",function(){return _store_removeTool_js__WEBPACK_IMPORTED_MODULE_11__.removeToolForElement});var _store_setToolOptions_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./store/setToolOptions.js");__webpack_require__.d(__webpack_exports__,"setToolOptions",function(){return _store_setToolOptions_js__WEBPACK_IMPORTED_MODULE_12__.setToolOptions});__webpack_require__.d(__webpack_exports__,"setToolOptionsForElement",function(){return _store_setToolOptions_js__WEBPACK_IMPORTED_MODULE_12__.setToolOptionsForElement});var _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./store/setToolMode.js");__webpack_require__.d(__webpack_exports__,"setToolActive",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolActive});__webpack_require__.d(__webpack_exports__,"setToolActiveForElement",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolActiveForElement});__webpack_require__.d(__webpack_exports__,"setToolEnabled",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolEnabled});__webpack_require__.d(__webpack_exports__,"setToolEnabledForElement",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolEnabledForElement});__webpack_require__.d(__webpack_exports__,"setToolDisabled",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolDisabled});__webpack_require__.d(__webpack_exports__,"setToolDisabledForElement",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolDisabledForElement});__webpack_require__.d(__webpack_exports__,"setToolPassive",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolPassive});__webpack_require__.d(__webpack_exports__,"setToolPassiveForElement",function(){return _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolPassiveForElement});var _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./stateManagement/toolState.js");__webpack_require__.d(__webpack_exports__,"addToolState",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.addToolState});__webpack_require__.d(__webpack_exports__,"getToolState",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.getToolState});__webpack_require__.d(__webpack_exports__,"removeToolState",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.removeToolState});__webpack_require__.d(__webpack_exports__,"clearToolState",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.clearToolState});__webpack_require__.d(__webpack_exports__,"setElementToolStateManager",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.setElementToolStateManager});__webpack_require__.d(__webpack_exports__,"getElementToolStateManager",function(){return _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.getElementToolStateManager});var _stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./stateManagement/textStyle.js");__webpack_require__.d(__webpack_exports__,"textStyle",function(){return _stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_15__["default"]});var _stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./stateManagement/toolStyle.js");__webpack_require__.d(__webpack_exports__,"toolStyle",function(){return _stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_16__["default"]});var _stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./stateManagement/toolColors.js");__webpack_require__.d(__webpack_exports__,"toolColors",function(){return _stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_17__["default"]});var _stateManagement_toolCoordinates_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./stateManagement/toolCoordinates.js");__webpack_require__.d(__webpack_exports__,"toolCoordinates",function(){return _stateManagement_toolCoordinates_js__WEBPACK_IMPORTED_MODULE_18__["default"]});var _stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./stateManagement/stackSpecificStateManager.js");__webpack_require__.d(__webpack_exports__,"stackSpecificStateManager",function(){return _stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.stackSpecificStateManager});__webpack_require__.d(__webpack_exports__,"newStackSpecificToolStateManager",function(){return _stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.newStackSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"addStackStateManager",function(){return _stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.addStackStateManager});var _stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./stateManagement/loadHandlerManager.js");__webpack_require__.d(__webpack_exports__,"loadHandlerManager",function(){return _stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_20__["default"]});var _stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./stateManagement/imageIdSpecificStateManager.js");__webpack_require__.d(__webpack_exports__,"newImageIdSpecificToolStateManager",function(){return _stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_21__.newImageIdSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"globalImageIdSpecificToolStateManager",function(){return _stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_21__.globalImageIdSpecificToolStateManager});var _stateManagement_frameOfReferenceStateManager_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./stateManagement/frameOfReferenceStateManager.js");__webpack_require__.d(__webpack_exports__,"newFrameOfReferenceSpecificToolStateManager",function(){return _stateManagement_frameOfReferenceStateManager_js__WEBPACK_IMPORTED_MODULE_22__.newFrameOfReferenceSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"globalFrameOfReferenceSpecificToolStateManager",function(){return _stateManagement_frameOfReferenceStateManager_js__WEBPACK_IMPORTED_MODULE_22__.globalFrameOfReferenceSpecificToolStateManager});var _eventListeners_windowResizeHandler_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("./eventListeners/windowResizeHandler.js");__webpack_require__.d(__webpack_exports__,"forceEnabledElementResize",function(){return _eventListeners_windowResizeHandler_js__WEBPACK_IMPORTED_MODULE_23__.forceEnabledElementResize});var _orientation_index_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./orientation/index.js");__webpack_require__.d(__webpack_exports__,"orientation",function(){return _orientation_index_js__WEBPACK_IMPORTED_MODULE_24__["default"]});var _util_SaveAs_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./util/SaveAs.js");__webpack_require__.d(__webpack_exports__,"SaveAs",function(){return _util_SaveAs_js__WEBPACK_IMPORTED_MODULE_25__["default"]});var _util_logger_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("./util/logger.js");__webpack_require__.d(__webpack_exports__,"enableLogger",function(){return _util_logger_js__WEBPACK_IMPORTED_MODULE_26__.enable});__webpack_require__.d(__webpack_exports__,"disableLogger",function(){return _util_logger_js__WEBPACK_IMPORTED_MODULE_26__.disable});var _thirdParty_register_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("./thirdParty/register.js");__webpack_require__.d(__webpack_exports__,"register",function(){return _thirdParty_register_js__WEBPACK_IMPORTED_MODULE_27__["default"]});var _thirdParty_registerSome_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("./thirdParty/registerSome.js");__webpack_require__.d(__webpack_exports__,"registerSome",function(){return _thirdParty_registerSome_js__WEBPACK_IMPORTED_MODULE_28__["default"]});var _synchronization_wwwcSynchronizer_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("./synchronization/wwwcSynchronizer.js");__webpack_require__.d(__webpack_exports__,"wwwcSynchronizer",function(){return _synchronization_wwwcSynchronizer_js__WEBPACK_IMPORTED_MODULE_29__["default"]});var _synchronization_updateImageSynchronizer_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("./synchronization/updateImageSynchronizer.js");__webpack_require__.d(__webpack_exports__,"updateImageSynchronizer",function(){return _synchronization_updateImageSynchronizer_js__WEBPACK_IMPORTED_MODULE_30__["default"]});var _synchronization_Synchronizer_js__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("./synchronization/Synchronizer.js");__webpack_require__.d(__webpack_exports__,"Synchronizer",function(){return _synchronization_Synchronizer_js__WEBPACK_IMPORTED_MODULE_31__["default"]});var _synchronization_stackScrollSynchronizer_js__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("./synchronization/stackScrollSynchronizer.js");__webpack_require__.d(__webpack_exports__,"stackScrollSynchronizer",function(){return _synchronization_stackScrollSynchronizer_js__WEBPACK_IMPORTED_MODULE_32__["default"]});var _synchronization_stackImagePositionSynchronizer_js__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("./synchronization/stackImagePositionSynchronizer.js");__webpack_require__.d(__webpack_exports__,"stackImagePositionSynchronizer",function(){return _synchronization_stackImagePositionSynchronizer_js__WEBPACK_IMPORTED_MODULE_33__["default"]});var _synchronization_stackImagePositionOffsetSynchronizer_js__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("./synchronization/stackImagePositionOffsetSynchronizer.js");__webpack_require__.d(__webpack_exports__,"stackImagePositionOffsetSynchronizer",function(){return _synchronization_stackImagePositionOffsetSynchronizer_js__WEBPACK_IMPORTED_MODULE_34__["default"]});var _synchronization_stackImageIndexSynchronizer_js__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("./synchronization/stackImageIndexSynchronizer.js");__webpack_require__.d(__webpack_exports__,"stackImageIndexSynchronizer",function(){return _synchronization_stackImageIndexSynchronizer_js__WEBPACK_IMPORTED_MODULE_35__["default"]});var _synchronization_panZoomSynchronizer_js__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("./synchronization/panZoomSynchronizer.js");__webpack_require__.d(__webpack_exports__,"panZoomSynchronizer",function(){return _synchronization_panZoomSynchronizer_js__WEBPACK_IMPORTED_MODULE_36__["default"]});var _requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("./requestPool/requestPoolManager.js");__webpack_require__.d(__webpack_exports__,"requestPoolManager",function(){return _requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_37__["default"]});var _externalModules_js__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("./externalModules.js");__webpack_require__.d(__webpack_exports__,"external",function(){return _externalModules_js__WEBPACK_IMPORTED_MODULE_38__["default"]});var _events_js__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("./events.js");__webpack_require__.d(__webpack_exports__,"EVENTS",function(){return _events_js__WEBPACK_IMPORTED_MODULE_39__["default"]});var _version_js__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("./version.js");__webpack_require__.d(__webpack_exports__,"version",function(){return _version_js__WEBPACK_IMPORTED_MODULE_40__["default"]});__webpack_require__.d(__webpack_exports__,"import",function(){return _import_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var cornerstoneTools={AngleTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.AngleTool,ArrowAnnotateTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.ArrowAnnotateTool,BidirectionalTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.BidirectionalTool,CobbAngleTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.CobbAngleTool,EllipticalRoiTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.EllipticalRoiTool,FreehandMouseTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.FreehandMouseTool,LengthTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.LengthTool,ProbeTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.ProbeTool,RectangleRoiTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.RectangleRoiTool,TextMarkerTool:_tools_annotation_index_js__WEBPACK_IMPORTED_MODULE_0__.TextMarkerTool,BrushTool:_tools_brush_index_js__WEBPACK_IMPORTED_MODULE_1__.BrushTool,CrosshairsTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.CrosshairsTool,DoubleTapFitToWindowTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.DoubleTapFitToWindowTool,DragProbeTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.DragProbeTool,EraserTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.EraserTool,FreehandSculpterMouseTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.FreehandSculpterMouseTool,MagnifyTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.MagnifyTool,PanMultiTouchTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.PanMultiTouchTool,PanTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.PanTool,ReferenceLinesTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ReferenceLinesTool,RotateTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.RotateTool,RotateTouchTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.RotateTouchTool,ScaleOverlayTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ScaleOverlayTool,StackScrollMouseWheelTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollMouseWheelTool,StackScrollMultiTouchTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollMultiTouchTool,StackScrollTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.StackScrollTool,WwwcRegionTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.WwwcRegionTool,WwwcTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.WwwcTool,ZoomMouseWheelTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomMouseWheelTool,ZoomTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomTool,ZoomTouchPinchTool:_tools_index_js__WEBPACK_IMPORTED_MODULE_2__.ZoomTouchPinchTool,init:_init_js__WEBPACK_IMPORTED_MODULE_4__["default"],stackPrefetch:_stackTools_stackPrefetch_js__WEBPACK_IMPORTED_MODULE_5__["default"],stackRenderers:_stackTools_stackRenderers_js__WEBPACK_IMPORTED_MODULE_6__["default"],playClip:_stackTools_playClip_js__WEBPACK_IMPORTED_MODULE_7__.playClip,stopClip:_stackTools_playClip_js__WEBPACK_IMPORTED_MODULE_7__.stopClip,store:_store_index_js__WEBPACK_IMPORTED_MODULE_8__["default"],getToolForElement:_store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_9__["default"],addTool:_store_addTool_js__WEBPACK_IMPORTED_MODULE_10__.addTool,addToolForElement:_store_addTool_js__WEBPACK_IMPORTED_MODULE_10__.addToolForElement,removeTool:_store_removeTool_js__WEBPACK_IMPORTED_MODULE_11__.removeTool,removeToolForElement:_store_removeTool_js__WEBPACK_IMPORTED_MODULE_11__.removeToolForElement,setToolOptions:_store_setToolOptions_js__WEBPACK_IMPORTED_MODULE_12__.setToolOptions,setToolOptionsForElement:_store_setToolOptions_js__WEBPACK_IMPORTED_MODULE_12__.setToolOptionsForElement,setToolActive:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolActive,setToolActiveForElement:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolActiveForElement,setToolEnabled:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolEnabled,setToolEnabledForElement:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolEnabledForElement,setToolDisabled:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolDisabled,setToolDisabledForElement:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolDisabledForElement,setToolPassive:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolPassive,setToolPassiveForElement:_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_13__.setToolPassiveForElement,addToolState:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.addToolState,getToolState:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.getToolState,removeToolState:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.removeToolState,clearToolState:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.clearToolState,setElementToolStateManager:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.setElementToolStateManager,getElementToolStateManager:_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_14__.getElementToolStateManager,textStyle:_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_15__["default"],toolStyle:_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_16__["default"],toolColors:_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_17__["default"],toolCoordinates:_stateManagement_toolCoordinates_js__WEBPACK_IMPORTED_MODULE_18__["default"],stackSpecificStateManager:_stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.stackSpecificStateManager,newStackSpecificToolStateManager:_stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.newStackSpecificToolStateManager,addStackStateManager:_stateManagement_stackSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_19__.addStackStateManager,loadHandlerManager:_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_20__["default"],newImageIdSpecificToolStateManager:_stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_21__.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:_stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_21__.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:_stateManagement_frameOfReferenceStateManager_js__WEBPACK_IMPORTED_MODULE_22__.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:_stateManagement_frameOfReferenceStateManager_js__WEBPACK_IMPORTED_MODULE_22__.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:_eventListeners_windowResizeHandler_js__WEBPACK_IMPORTED_MODULE_23__.forceEnabledElementResize,orientation:_orientation_index_js__WEBPACK_IMPORTED_MODULE_24__["default"],SaveAs:_util_SaveAs_js__WEBPACK_IMPORTED_MODULE_25__["default"],enableLogger:_util_logger_js__WEBPACK_IMPORTED_MODULE_26__.enable,disableLogger:_util_logger_js__WEBPACK_IMPORTED_MODULE_26__.disable,import:_import_js__WEBPACK_IMPORTED_MODULE_3__["default"],register:_thirdParty_register_js__WEBPACK_IMPORTED_MODULE_27__["default"],registerSome:_thirdParty_registerSome_js__WEBPACK_IMPORTED_MODULE_28__["default"],wwwcSynchronizer:_synchronization_wwwcSynchronizer_js__WEBPACK_IMPORTED_MODULE_29__["default"],updateImageSynchronizer:_synchronization_updateImageSynchronizer_js__WEBPACK_IMPORTED_MODULE_30__["default"],Synchronizer:_synchronization_Synchronizer_js__WEBPACK_IMPORTED_MODULE_31__["default"],stackScrollSynchronizer:_synchronization_stackScrollSynchronizer_js__WEBPACK_IMPORTED_MODULE_32__["default"],stackImagePositionSynchronizer:_synchronization_stackImagePositionSynchronizer_js__WEBPACK_IMPORTED_MODULE_33__["default"],stackImagePositionOffsetSynchronizer:_synchronization_stackImagePositionOffsetSynchronizer_js__WEBPACK_IMPORTED_MODULE_34__["default"],stackImageIndexSynchronizer:_synchronization_stackImageIndexSynchronizer_js__WEBPACK_IMPORTED_MODULE_35__["default"],panZoomSynchronizer:_synchronization_panZoomSynchronizer_js__WEBPACK_IMPORTED_MODULE_36__["default"],requestPoolManager:_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_37__["default"],external:_externalModules_js__WEBPACK_IMPORTED_MODULE_38__["default"],EVENTS:_events_js__WEBPACK_IMPORTED_MODULE_39__["default"],version:_version_js__WEBPACK_IMPORTED_MODULE_40__["default"]};__webpack_exports__["default"]=cornerstoneTools},"./init.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/index.js"),_store_internals_addEnabledElement_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/internals/addEnabledElement.js"),_store_internals_removeEnabledElement_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/internals/removeEnabledElement.js"),_eventListeners_windowResizeHandler_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./eventListeners/windowResizeHandler.js");__webpack_exports__["default"]=function(configuration){_addCornerstoneEventListeners();_initModules();_eventListeners_windowResizeHandler_js__WEBPACK_IMPORTED_MODULE_4__["default"].enable();_store_index_js__WEBPACK_IMPORTED_MODULE_1__["default"].modules.globalConfiguration.state=Object.assign({},_store_index_js__WEBPACK_IMPORTED_MODULE_1__["default"].modules.globalConfiguration.state,configuration)};function _addCornerstoneEventListeners(){_removeCornerstoneEventListeners();var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,elementEnabledEvent=cornerstone.EVENTS.ELEMENT_ENABLED,elementDisabledEvent=cornerstone.EVENTS.ELEMENT_DISABLED;cornerstone.events.addEventListener(elementEnabledEvent,_store_internals_addEnabledElement_js__WEBPACK_IMPORTED_MODULE_2__["default"]);cornerstone.events.addEventListener(elementDisabledEvent,_store_internals_removeEnabledElement_js__WEBPACK_IMPORTED_MODULE_3__["default"])}function _removeCornerstoneEventListeners(){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,elementEnabledEvent=cornerstone.EVENTS.ELEMENT_ENABLED,elementDisabledEvent=cornerstone.EVENTS.ELEMENT_DISABLED;cornerstone.events.removeEventListener(elementEnabledEvent,_store_internals_addEnabledElement_js__WEBPACK_IMPORTED_MODULE_2__["default"]);cornerstone.events.removeEventListener(elementDisabledEvent,_store_internals_removeEnabledElement_js__WEBPACK_IMPORTED_MODULE_3__["default"])}function _initModules(){var modules=_store_index_js__WEBPACK_IMPORTED_MODULE_1__["default"].modules;Object.keys(modules).forEach(function(key){if("function"===typeof modules[key].onRegisterCallback){modules[key].onRegisterCallback()}})}},"./lib.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"lib",function(){return lib});var _tools_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/base/BaseTool.js"),_tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./tools/base/BaseBrushTool.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./manipulators/index.js"),_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/findAndMoveHelpers.js"),_mixins_index_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./mixins/index.js"),_tools_cursors_index_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/cursors/index.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./drawing/index.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./drawing/drawTextBox.js"),_drawing_drawArrow_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./drawing/drawArrow.js"),_drawing_drawLink_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/drawLink.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/drawHandles.js"),_util_getLuminance_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./util/getLuminance.js"),_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./util/copyPoints.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/calculateSUV.js"),_util_setContextToDisplayFontSize_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/setContextToDisplayFontSize.js"),_util_scrollToIndex_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./util/scrollToIndex.js"),_util_scroll_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./util/scroll.js"),_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./util/roundToDecimal.js"),_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./util/pointProjector.js"),_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./util/lineSegDistance.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./util/pointInsideBoundingBox.js"),_util_makeUnselectable_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("./util/makeUnselectable.js"),_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./util/getRGBPixels.js"),_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./util/getMaxSimultaneousRequests.js"),_util_angleBetweenPoints_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("./util/angleBetweenPoints.js"),_util_getKeyFromKeyCode_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("./util/getKeyFromKeyCode.js"),_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("./util/numbersWithCommas.js"),_tools_cursors_MouseCursor_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("./tools/cursors/MouseCursor.js"),_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("./util/ellipse/index.js"),_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("./util/freehand/index.js"),_util_brush_index_js__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("./util/brush/index.js"),_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("./util/zoom/index.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("./util/triggerEvent.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("./util/convertToVector3.js"),lib={"base/BaseTool":_tools_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_0__["default"],"base/BaseAnnotationTool":_tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_1__["default"],"base/BaseBrushTool":_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_2__["default"],"tools/cursors/MouseCursor":_tools_cursors_MouseCursor_js__WEBPACK_IMPORTED_MODULE_29__["default"],"tools/cursors":_tools_cursors_index_js__WEBPACK_IMPORTED_MODULE_6__,"manipulators/anyHandlesOutsideImage":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.getHandleNearImagePoint,"manipulators/handleActivator":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.handleActivator,"manipulators/moveAllHandles":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.moveAllHandles,"manipulators/moveHandle":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.moveHandle,"manipulators/moveNewHandle":_manipulators_index_js__WEBPACK_IMPORTED_MODULE_3__.moveNewHandle,"manipulators/moveHandleNearImagePoint":_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_4__.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_4__.findHandleDataNearImagePoint,"manipulators/moveAnnotation":_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_4__.moveAnnotation,"mixins/activeOrDisabledBinaryTool":_mixins_index_js__WEBPACK_IMPORTED_MODULE_5__["default"].activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":_mixins_index_js__WEBPACK_IMPORTED_MODULE_5__["default"].enabledOrDisabledBinaryTool,"drawing/getNewContext":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.getNewContext,"drawing/draw":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.draw,"drawing/path":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.path,"drawing/setShadow":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.setShadow,"drawing/drawLine":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLine,"drawing/drawLines":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLines,"drawing/drawJoinedLines":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawJoinedLines,"drawing/drawCircle":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawCircle,"drawing/drawEllipse":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawEllipse,"drawing/drawRect":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawRect,"drawing/fillOutsideRect":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.fillOutsideRect,"drawing/drawTextBox":_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_8__["default"],"drawing/drawArrow":_drawing_drawArrow_js__WEBPACK_IMPORTED_MODULE_9__["default"],"drawing/fillBox":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.fillBox,"drawing/fillTextLines":_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.fillTextLines,"drawing/drawLink":_drawing_drawLink_js__WEBPACK_IMPORTED_MODULE_10__["default"],"drawing/drawLinkedTextBox":_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"],"drawing/drawHandles":_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__["default"],"drawing/textBoxWidth":_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_8__.textBoxWidth,"util/getLuminance":_util_getLuminance_js__WEBPACK_IMPORTED_MODULE_13__["default"],"util/copyPoints":_util_copyPoints_js__WEBPACK_IMPORTED_MODULE_14__["default"],"util/calculateSUV":_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_15__["default"],"util/setContextToDisplayFontSize":_util_setContextToDisplayFontSize_js__WEBPACK_IMPORTED_MODULE_16__["default"],"util/scrollToIndex":_util_scrollToIndex_js__WEBPACK_IMPORTED_MODULE_17__["default"],"util/scroll":_util_scroll_js__WEBPACK_IMPORTED_MODULE_18__["default"],"util/roundToDecimal":_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_19__["default"],"util/projectPatientPointToImagePlane":_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_20__.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_20__.imagePointToPatientPoint,"util/planePlaneIntersection":_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_20__.planePlaneIntersection,"util/pointInsideBoundingBox":_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_22__["default"],"util/makeUnselectable":_util_makeUnselectable_js__WEBPACK_IMPORTED_MODULE_23__["default"],"util/getRGBPixels":_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_24__["default"],"util/getDefaultSimultaneousRequests":_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_25__.getDefaultSimultaneousRequests,"util/getMaxSimultaneousRequests":_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_25__.getMaxSimultaneousRequests,"util/getBrowserInfo":_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_25__.getBrowserInfo,"util/isMobileDevice":_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_25__.isMobileDevice,"util/angleBetweenPoints":_util_angleBetweenPoints_js__WEBPACK_IMPORTED_MODULE_26__["default"],"util/getKeyFromKeyCode":_util_getKeyFromKeyCode_js__WEBPACK_IMPORTED_MODULE_27__["default"],"util/numbersWithCommas":_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_28__["default"],"util/lineSegDistance":_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_21__["default"],"util/triggerEvent":_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_34__["default"],"util/convertToVectro3":_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_35__["default"],"util/ellipseUtils":_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_30__["default"],"util/freehandUtils":_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_31__["default"],"util/brushUtils":_util_brush_index_js__WEBPACK_IMPORTED_MODULE_32__["default"],"util/zoomUtils":_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_33__["default"]}},"./manipulators/anyHandlesOutsideImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(renderData,handles){var image=renderData.image,imageRect={left:0,top:0,width:image.width,height:image.height},handleOutsideImage=!1;Object.keys(handles).forEach(function(name){var handle=handles[name];if(!0===handle.allowedOutsideImage){return}if(!1===_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.insideRect(handle,imageRect)){handleOutsideImage=!0}});return handleOutsideImage}},"./manipulators/getHandleNearImagePoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/pointInsideBoundingBox.js"),getHandleNearImagePoint=function getHandleNearImagePoint(element,handles,coords,distanceThreshold){var nearbyHandle;if(!handles){return}if(Array.isArray(handles)){for(var handleKeys=Object.keys(handles),i=0;i<handleKeys.length;i++){var key=handleKeys[i],handle=handles[key];if(!handle.hasOwnProperty("x")||!handle.hasOwnProperty("y")){continue}if(_isHandleNearImagePoint(handle,element,coords,distanceThreshold)){nearbyHandle=handle;break}}}else if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(handles)){for(var _handleKeys=Object.keys(handles),_i=0,handleName;_i<_handleKeys.length;_i++){handleName=_handleKeys[_i];if(Array.isArray(handles[handleName])){nearbyHandle=getHandleNearImagePoint(element,handles[handleName],coords,distanceThreshold);if(nearbyHandle){break}}else{var _handle=handles[handleName];if(_isHandleNearImagePoint(_handle,element,coords,distanceThreshold)){nearbyHandle=_handle;break}}}}return nearbyHandle},_isHandleNearImagePoint=function _isHandleNearImagePoint(handle,element,coords,distanceThreshold){if(handle.hasOwnProperty("pointNearHandle")){if(handle.pointNearHandle(element,handle,coords)){return!0}}else if(!0===handle.hasBoundingBox){if(Object(_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__["default"])(handle,coords)){return!0}}else{var handleCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pixelToCanvas(element,handle),distance=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath.point.distance(handleCanvas,coords);if(distance<=distanceThreshold){return!0}}return!1};__webpack_exports__["default"]=getHandleNearImagePoint},"./manipulators/handleActivator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./manipulators/getHandleNearImagePoint.js");__webpack_exports__["default"]=function(element,handles,canvasPoint,distanceThreshold){if(!distanceThreshold){distanceThreshold=6}var activeHandle=_getActiveHandle(handles),nearbyHandle=Object(_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,handles,canvasPoint,distanceThreshold);if(activeHandle!==nearbyHandle){if(void 0!==nearbyHandle){nearbyHandle.active=!0}if(void 0!==activeHandle){activeHandle.active=!1}return!0}return!1};function _getActiveHandle(handles){var activeHandle;Object.keys(handles).forEach(function(name){var handle=handles[name];if(!0===handle.active){activeHandle=handle;return}});return activeHandle}},"./manipulators/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js");__webpack_require__.d(__webpack_exports__,"anyHandlesOutsideImage",function(){return _anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./manipulators/getHandleNearImagePoint.js");__webpack_require__.d(__webpack_exports__,"getHandleNearImagePoint",function(){return _getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _handleActivator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/handleActivator.js");__webpack_require__.d(__webpack_exports__,"handleActivator",function(){return _handleActivator_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _moveAllHandles_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./manipulators/moveAllHandles.js");__webpack_require__.d(__webpack_exports__,"moveAllHandles",function(){return _moveAllHandles_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _moveHandle_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./manipulators/moveHandle.js");__webpack_require__.d(__webpack_exports__,"moveHandle",function(){return _moveHandle_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var _moveNewHandle_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./manipulators/moveNewHandle.js");__webpack_require__.d(__webpack_exports__,"moveNewHandle",function(){return _moveNewHandle_js__WEBPACK_IMPORTED_MODULE_5__["default"]})},"./manipulators/moveAllHandles.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/triggerEvent.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/clip.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./store/index.js"),_dragEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG]},_upOrEndEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG_END,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP]};__webpack_exports__["default"]=function(_ref,toolName,annotation,handle){var element=_ref.element,options=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},interactionType=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"mouse";options=Object.assign({deleteIfHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.preventHandleOutsideImage},options);var dragHandler=_dragHandler.bind(this,toolName,annotation,options),upOrEndHandler=function upOrEndHandler(evt){_upOrEndHandler(toolName,annotation,options,interactionType,{dragHandler:dragHandler,upOrEndHandler:upOrEndHandler},evt)};annotation.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!0;_dragEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,dragHandler)});_upOrEndEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,upOrEndHandler)})};function _dragHandler(toolName,annotation){var options=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},evt=3<arguments.length?arguments[3]:void 0,_evt$detail=evt.detail,element=_evt$detail.element,image=_evt$detail.image,_evt$detail$deltaPoin=evt.detail.deltaPoints.image,x=_evt$detail$deltaPoin.x,y=_evt$detail$deltaPoin.y;annotation.active=!0;annotation.invalidated=!0;for(var handleKeys=Object.keys(annotation.handles),i=0;i<handleKeys.length;i++){var key=handleKeys[i],handle=annotation.handles[key];if(!0===handle.movesIndependently||!handle.hasOwnProperty("x")||!handle.hasOwnProperty("y")){continue}handle.x+=x;handle.y+=y;if(options.preventHandleOutsideImage){Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_5__.clipToBox)(handle,image)}}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MEASUREMENT_MODIFIED,modifiedEventData={toolName:toolName,element:element,measurementData:annotation};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,modifiedEventData);evt.preventDefault();evt.stopPropagation()}function _upOrEndHandler(toolName,annotation){var options=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},interactionType=3<arguments.length?arguments[3]:void 0,_ref2=4<arguments.length?arguments[4]:void 0,dragHandler=_ref2.dragHandler,upOrEndHandler=_ref2.upOrEndHandler,evt=5<arguments.length?arguments[5]:void 0,eventData=evt.detail,element=evt.detail.element;annotation.active=!1;annotation.invalidated=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!1;_dragEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,dragHandler)});_upOrEndEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,upOrEndHandler)});if(options.deleteIfHandleOutsideImage&&Object(_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__["default"])(eventData,annotation.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.removeToolState)(element,toolName,annotation)}if("function"===typeof options.doneMovingCallback){options.doneMovingCallback()}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element)}},"./manipulators/moveHandle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/triggerEvent.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/clip.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./store/index.js"),runAnimation={value:!1},_dragEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG]},_upOrEndEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG_END,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP]};__webpack_exports__["default"]=function(evtDetail,toolName,annotation,handle){var options=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},interactionType=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"mouse";options=Object.assign({deleteIfHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.preventHandleOutsideImage},options);var element=evtDetail.element,dragHandler=_dragHandler.bind(this,toolName,annotation,handle,options,interactionType),upOrEndHandler=function upOrEndHandler(evt){_upOrEndHandler(toolName,evtDetail,annotation,handle,options,interactionType,{dragHandler:dragHandler,upOrEndHandler:upOrEndHandler},evt)};handle.active=!0;annotation.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!0;_dragEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,dragHandler)});_upOrEndEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,upOrEndHandler)});if("touch"===interactionType){runAnimation.value=!0;var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element),fingerDistance=-57,aboveFinger={x:evtDetail.currentPoints.page.x,y:evtDetail.currentPoints.page.y+fingerDistance},targetLocation=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,aboveFinger.x,aboveFinger.y);_animate(handle,runAnimation,enabledElement,targetLocation)}};function _dragHandler(toolName,annotation,handle,options,interactionType,evt){var _evt$detail=evt.detail,image=_evt$detail.image,currentPoints=_evt$detail.currentPoints,element=_evt$detail.element,page=currentPoints.page,fingerOffset=-57,targetLocation=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,page.x,"touch"===interactionType?page.y+fingerOffset:page.y);runAnimation.value=!1;handle.active=!0;handle.hasMoved=!0;handle.x=targetLocation.x;handle.y=targetLocation.y;annotation.invalidated=!0;if(options.preventHandleOutsideImage){Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_5__.clipToBox)(handle,image)}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MEASUREMENT_MODIFIED,modifiedEventData={toolName:toolName,element:element,measurementData:annotation};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,modifiedEventData)}function _upOrEndHandler(toolName,evtDetail,annotation,handle){var options=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},interactionType=5<arguments.length?arguments[5]:void 0,_ref=6<arguments.length?arguments[6]:void 0,dragHandler=_ref.dragHandler,upOrEndHandler=_ref.upOrEndHandler,evt=7<arguments.length?arguments[7]:void 0,image=evtDetail.currentPoints.image,element=evt.detail.element;handle.active=!1;annotation.active=!1;annotation.invalidated=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!1;runAnimation.value=!1;_dragEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,dragHandler)});_upOrEndEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,upOrEndHandler)});if(options.deleteIfHandleOutsideImage&&Object(_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__["default"])(evtDetail,annotation.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.removeToolState)(element,toolName,annotation)}if(evt.type===_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS){evt.detail.handlePressed=annotation;handle.x=image.x;handle.y=image.y}if("function"===typeof options.doneMovingCallback){options.doneMovingCallback()}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element)}function _animate(handle,runAnimation,enabledElement,targetLocation){if(!runAnimation.value){return}var distanceRemaining=_Mathabs(handle.y-targetLocation.y),linearDistEachFrame=distanceRemaining/10;if(1>distanceRemaining){handle.y=targetLocation.y;runAnimation.value=!1;return}if(handle.y>targetLocation.y){handle.y-=linearDistEachFrame}else if(handle.y<targetLocation.y){handle.y+=linearDistEachFrame}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(enabledElement.element);_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.requestAnimationFrame(function(){_animate(handle,runAnimation,enabledElement,targetLocation)})}},"./manipulators/moveNewHandle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/triggerEvent.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/clip.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./store/index.js"),_moveEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_MOVE,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_DRAG],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_DRAG]},_moveEndEvents={mouse:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_UP,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MOUSE_CLICK],touch:[_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_END,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TAP]};__webpack_exports__["default"]=function(evtDetail,toolName,annotation,handle,options){var interactionType=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"mouse";options=Object.assign({deleteIfHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.preventHandleOutsideImage},options);var element=evtDetail.element;annotation.active=!0;handle.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!0;var moveHandler=_moveHandler.bind(this,toolName,annotation,handle,options,interactionType),moveEndHandler=function moveEndHandler(evt){_moveEndHandler(toolName,annotation,handle,options,interactionType,{moveHandler:moveHandler,moveEndHandler:moveEndHandler},evt)};_moveEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,moveHandler)});_moveEndEvents[interactionType].forEach(function(eventType){element.addEventListener(eventType,moveEndHandler)});element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START,_stopImmediatePropagation)};function _moveHandler(toolName,annotation,handle,options,interactionType,evt){var _evt$detail=evt.detail,currentPoints=_evt$detail.currentPoints,image=_evt$detail.image,element=_evt$detail.element,page=currentPoints.page,fingerOffset=-57,targetLocation=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,"touch"===interactionType?page.x+fingerOffset:page.x,"touch"===interactionType?page.y+fingerOffset:page.y);annotation.invalidated=!0;handle.active=!0;handle.x=targetLocation.x;handle.y=targetLocation.y;if(options&&options.preventHandleOutsideImage){Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_5__.clipToBox)(handle,image)}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MEASUREMENT_MODIFIED,modifiedEventData={toolName:toolName,element:element,measurementData:annotation};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,eventType,modifiedEventData)}function _moveEndHandler(toolName,annotation,handle,options,interactionType,_ref,evt){var moveHandler=_ref.moveHandler,moveEndHandler=_ref.moveEndHandler,_evt$detail2=evt.detail,element=_evt$detail2.element,currentPoints=_evt$detail2.currentPoints,page=currentPoints.page,fingerOffset=-57,targetLocation=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.pageToPixel(element,"touch"===interactionType?page.x+fingerOffset:page.x,"touch"===interactionType?page.y+fingerOffset:page.y);annotation.active=!1;annotation.invalidated=!0;handle.active=!1;handle.x=targetLocation.x;handle.y=targetLocation.y;_store_index_js__WEBPACK_IMPORTED_MODULE_6__.state.isToolLocked=!1;_moveEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,moveHandler)});_moveEndEvents[interactionType].forEach(function(eventType){element.removeEventListener(eventType,moveEndHandler)});element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_START,_stopImmediatePropagation);if(evt.type===_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PINCH||evt.type===_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOUCH_PRESS){handle.active=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);if("function"===typeof options.doneMovingCallback){options.doneMovingCallback()}return}if(options.preventHandleOutsideImage){Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_5__.clipToBox)(handle,evt.detail.image)}if(options.deleteIfHandleOutsideImage&&Object(_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_2__["default"])(evt.detail,annotation.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.removeToolState)(element,toolName,annotation)}if("function"===typeof options.doneMovingCallback){options.doneMovingCallback()}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element)}function _stopImmediatePropagation(evt){evt.stopImmediatePropagation();return!1}},"./mixins/activeOrDisabledBinaryTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/setToolMode.js");function passiveCallback(element){Object(_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__.setToolDisabledForElement)(element,this.name)}function enabledCallback(element){Object(_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__.setToolActiveForElement)(element,this.name)}__webpack_exports__["default"]={passiveCallback:passiveCallback,enabledCallback:enabledCallback}},"./mixins/enabledOrDisabledBinaryTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/setToolMode.js");function passiveCallback(element){Object(_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__.setToolDisabledForElement)(element,this.name)}function activeCallback(element){Object(_store_setToolMode_js__WEBPACK_IMPORTED_MODULE_0__.setToolEnabledForElement)(element,this.name)}__webpack_exports__["default"]={passiveCallback:passiveCallback,activeCallback:activeCallback}},"./mixins/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _activeOrDisabledBinaryTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./mixins/activeOrDisabledBinaryTool.js"),_enabledOrDisabledBinaryTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./mixins/enabledOrDisabledBinaryTool.js");__webpack_exports__["default"]={activeOrDisabledBinaryTool:_activeOrDisabledBinaryTool_js__WEBPACK_IMPORTED_MODULE_0__["default"],enabledOrDisabledBinaryTool:_enabledOrDisabledBinaryTool_js__WEBPACK_IMPORTED_MODULE_1__["default"]}},"./orientation/getOrientationString.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/convertToVector3.js");__webpack_exports__["default"]=function(vector){for(var vec3=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(vector),orientation="",orientationX=0>vec3.x?"R":"L",orientationY=0>vec3.y?"A":"P",orientationZ=0>vec3.z?"F":"H",abs=new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Vector3(_Mathabs(vec3.x),_Mathabs(vec3.y),_Mathabs(vec3.z)),i=0;3>i;i++){if(1e-4<abs.x&&abs.x>abs.y&&abs.x>abs.z){orientation+=orientationX;abs.x=0}else if(1e-4<abs.y&&abs.y>abs.x&&abs.y>abs.z){orientation+=orientationY;abs.y=0}else if(1e-4<abs.z&&abs.z>abs.x&&abs.z>abs.y){orientation+=orientationZ;abs.z=0}else{break}}return orientation}},"./orientation/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getOrientationString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./orientation/getOrientationString.js"),_invertOrientationString_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./orientation/invertOrientationString.js"),orientation={getOrientationString:_getOrientationString_js__WEBPACK_IMPORTED_MODULE_0__["default"],invertOrientationString:_invertOrientationString_js__WEBPACK_IMPORTED_MODULE_1__["default"]};__webpack_exports__["default"]=orientation},"./orientation/invertOrientationString.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(orientationString){var inverted=orientationString.replace("H","f");inverted=inverted.replace("F","h");inverted=inverted.replace("R","l");inverted=inverted.replace("L","r");inverted=inverted.replace("A","p");inverted=inverted.replace("P","a");inverted=inverted.toUpperCase();return inverted}},"./requestPool/requestPoolManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/getMaxSimultaneousRequests.js"),requestPool={interaction:[],thumbnail:[],prefetch:[]},numRequests={interaction:0,thumbnail:0,prefetch:0},maxNumRequests={interaction:6,thumbnail:6,prefetch:5},awake=!1,grabDelay=20;function addRequest(element,imageId,type,preventCache,doneCallback,failCallback,addToBeginning){if(!requestPool.hasOwnProperty(type)){throw new Error("Request type must be one of interaction, thumbnail, or prefetch")}if(!element||!imageId){return}var requestDetails={type:type,imageId:imageId,preventCache:preventCache,doneCallback:doneCallback,failCallback:failCallback},imageLoadObject=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.imageCache.getImageLoadObject(imageId);if(imageLoadObject){imageLoadObject.promise.then(function(image){doneCallback(image)},function(error){failCallback(error)});return}if(addToBeginning){requestPool[type].unshift(requestDetails)}else{requestPool[type].push(requestDetails)}awake=!0}function clearRequestStack(type){if(!requestPool.hasOwnProperty(type)){throw new Error("Request type must be one of interaction, thumbnail, or prefetch")}requestPool[type]=[]}function startAgain(){if(!awake){return}setTimeout(function(){startGrabbing()},grabDelay)}function sendRequest(requestDetails){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,type=requestDetails.type;numRequests[type]++;awake=!0;var imageId=requestDetails.imageId,doneCallback=requestDetails.doneCallback,failCallback=requestDetails.failCallback,imageLoadObject=cornerstone.imageCache.getImageLoadObject(imageId);if(imageLoadObject){imageLoadObject.promise.then(function(image){numRequests[type]--;doneCallback(image);startAgain()},function(error){numRequests[type]--;failCallback(error);startAgain()});return}function requestTypeToLoadPriority(requestDetails){if("prefetch"===requestDetails.type){return-5}else if("interactive"===requestDetails.type){return 0}else if("thumbnail"===requestDetails.type){return 5}}var priority=requestTypeToLoadPriority(requestDetails),loader;if(!0===requestDetails.preventCache){loader=cornerstone.loadImage(imageId,{priority:priority,type:requestDetails.type})}else{loader=cornerstone.loadAndCacheImage(imageId,{priority:priority,type:requestDetails.type})}loader.then(function(image){numRequests[type]--;doneCallback(image);startAgain()},function(error){numRequests[type]--;failCallback(error);startAgain()})}function startGrabbing(){var maxSimultaneousRequests=Object(_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_1__.getMaxSimultaneousRequests)();maxNumRequests={interaction:_Mathmax(maxSimultaneousRequests,1),thumbnail:_Mathmax(maxSimultaneousRequests-2,1),prefetch:_Mathmax(maxSimultaneousRequests-1,1)};for(var currentRequests=numRequests.interaction+numRequests.thumbnail+numRequests.prefetch,requestsToSend=maxSimultaneousRequests-currentRequests,i=0,requestDetails;i<requestsToSend;i++){requestDetails=getNextRequest();if(requestDetails){sendRequest(requestDetails)}}}function getNextRequest(){if(requestPool.interaction.length&&numRequests.interaction<maxNumRequests.interaction){return requestPool.interaction.shift()}if(requestPool.thumbnail.length&&numRequests.thumbnail<maxNumRequests.thumbnail){return requestPool.thumbnail.shift()}if(requestPool.prefetch.length&&numRequests.prefetch<maxNumRequests.prefetch){return requestPool.prefetch.shift()}if(!requestPool.interaction.length&&!requestPool.thumbnail.length&&!requestPool.prefetch.length){awake=!1}return!1}function getRequestPool(){return requestPool}__webpack_exports__["default"]={addRequest:addRequest,clearRequestStack:clearRequestStack,startGrabbing:startGrabbing,getRequestPool:getRequestPool}},"./stackTools/fusionRenderer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return FusionRenderer});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_externalModules_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),FusionRenderer=function(){function FusionRenderer(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,FusionRenderer);this.currentImageIdIndex=0;this.layerIds=[];this.findImageFn=void 0}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(FusionRenderer,[{key:"render",value:function render(element,imageStacks){var _this=this;if(!Number.isInteger(this.currentImageIdIndex)){throw new Error("FusionRenderer: render - Image ID Index is not an integer")}if(!this.findImageFn){throw new Error("No findImage function has been defined")}if(!imageStacks){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stack");imageStacks=toolData.data}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_2__["default"].cornerstone,baseImageObject=imageStacks[0],currentImageId=baseImageObject.imageIds[this.currentImageIdIndex],overlayImageStacks=imageStacks.slice(1,imageStacks.length);cornerstone.loadAndCacheImage(currentImageId).then(function(baseImage){var baseLayerId=_this.layerIds[0];if(baseLayerId){cornerstone.setLayerImage(element,baseImage,baseLayerId)}else{baseLayerId=cornerstone.addLayer(element,baseImage,baseImageObject.options);_this.layerIds.push(baseLayerId)}cornerstone.displayImage(element,baseImage);overlayImageStacks.forEach(function(imgObj,overlayLayerIndex){var imageId=_this.findImageFn(imgObj.imageIds,currentImageId),layerIndex=overlayLayerIndex+1,currentLayerId=_this.layerIds[layerIndex];if(!currentLayerId){currentLayerId=cornerstone.addLayer(element,void 0,imgObj.options);_this.layerIds.push(currentLayerId)}if(imageId){cornerstone.loadAndCacheImage(imageId).then(function(image){cornerstone.setLayerImage(element,image,currentLayerId);cornerstone.updateImage(element)})}else{cornerstone.setLayerImage(element,void 0,currentLayerId);cornerstone.setActiveLayer(element,baseLayerId);cornerstone.updateImage(element)}})})}}]);return FusionRenderer}()},"./stackTools/playClip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"playClip",function(){return playClip});__webpack_require__.d(__webpack_exports__,"stopClip",function(){return stopClip});var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/triggerEvent.js"),toolType="playClip";function getPlayClipTimeouts(vector,speed){var i,sample,delay,sum=0,limit=vector.length,timeouts=[];timeouts.isTimeVarying=!1;if("number"!==typeof speed||0>=speed){speed=1}for(i=1;i<limit;i++){delay=0|+vector[i]/speed;timeouts.push(delay);if(1===i){sample=delay}else if(delay!==sample){timeouts.isTimeVarying=!0}sum+=delay}if(0<timeouts.length){if(timeouts.isTimeVarying){delay=0|sum/timeouts.length}else{delay=timeouts[0]}timeouts.push(delay)}return timeouts}function stopClipWithData(playClipData){var id=playClipData.intervalId;if("undefined"!==typeof id){playClipData.intervalId=void 0;if(playClipData.usingFrameTimeVector){clearTimeout(id)}else{clearInterval(id)}}}function triggerStopEvent(element){var eventDetail={element:element};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_4__["default"])(element,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].CLIP_STOPPED,eventDetail)}function playClip(element,framesPerSecond){var playClipData,playClipTimeouts;if(void 0===element){throw new Error("playClip: element must not be undefined")}var stackToolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stack");if(!stackToolData||!stackToolData.data||!stackToolData.data.length){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone,stackRenderer;if(1<stackToolData.data.length){var stackRendererData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stackRenderer");if(stackRendererData&&stackRendererData.data&&stackRendererData.data.length){stackRenderer=stackRendererData.data[0]}}var stackData=stackToolData.data[0],playClipToolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);if(!playClipToolData||!playClipToolData.data||!playClipToolData.data.length){playClipData={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0};Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.addToolState)(element,toolType,playClipData)}else{playClipData=playClipToolData.data[0];stopClipWithData(playClipData)}if(0>framesPerSecond||0<framesPerSecond){playClipData.framesPerSecond=+framesPerSecond;playClipData.reverse=0>playClipData.framesPerSecond;playClipData.ignoreFrameTimeVector=!0}if(!0!==playClipData.ignoreFrameTimeVector&&playClipData.frameTimeVector&&playClipData.frameTimeVector.length===stackData.imageIds.length){playClipTimeouts=getPlayClipTimeouts(playClipData.frameTimeVector,playClipData.speed)}var playClipAction=function playClipAction(){var loader,startLoadingHandler,endLoadingHandler,errorLoadingHandler,newImageIdIndex=stackData.currentImageIdIndex,imageCount=stackData.imageIds.length;if(playClipData.reverse){newImageIdIndex--}else{newImageIdIndex++}if(!playClipData.loop&&(0>newImageIdIndex||newImageIdIndex>=imageCount)){stopClipWithData(playClipData);triggerStopEvent(element);return}if(newImageIdIndex>=imageCount){newImageIdIndex=0}if(0>newImageIdIndex){newImageIdIndex=imageCount-1}if(newImageIdIndex!==stackData.currentImageIdIndex){startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getStartLoadHandler();endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getEndLoadHandler();errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();if(startLoadingHandler){startLoadingHandler(element)}if(!0===stackData.preventCache){loader=cornerstone.loadImage(stackData.imageIds[newImageIdIndex])}else{loader=cornerstone.loadAndCacheImage(stackData.imageIds[newImageIdIndex])}loader.then(function(image){try{stackData.currentImageIdIndex=newImageIdIndex;if(stackRenderer){stackRenderer.currentImageIdIndex=newImageIdIndex;stackRenderer.render(element,stackToolData.data)}else{cornerstone.displayImage(element,image)}if(endLoadingHandler){endLoadingHandler(element,image)}}catch(error){return}},function(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(element,imageId,error)}})}};if(playClipTimeouts&&0<playClipTimeouts.length&&playClipTimeouts.isTimeVarying){playClipData.usingFrameTimeVector=!0;playClipData.intervalId=setTimeout(function playClipTimeoutHandler(){playClipData.intervalId=setTimeout(playClipTimeoutHandler,playClipTimeouts[stackData.currentImageIdIndex]);playClipAction()},0)}else{playClipData.usingFrameTimeVector=!1;playClipData.intervalId=setInterval(playClipAction,1e3/_Mathabs(playClipData.framesPerSecond))}}function stopClip(element){var playClipToolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);if(!playClipToolData||!playClipToolData.data||!playClipToolData.data.length){return}stopClipWithData(playClipToolData.data[0])}},"./stackTools/stackPrefetch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./requestPool/requestPoolManager.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/getMaxSimultaneousRequests.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_5__.getLogger)("stackTools:stackPrefetch"),toolType="stackPrefetch",requestType="prefetch",configuration={maxImagesToPrefetch:1/0},resetPrefetchTimeout,resetPrefetchDelay=10;function range(lowEnd,highEnd){lowEnd=_Mathround(lowEnd)||0;highEnd=_Mathround(highEnd)||0;var arr=[],c=highEnd-lowEnd+1;if(0>=c){return arr}while(c--){arr[c]=highEnd--}return arr}var max=function max(arr){return _Mathmax.apply(null,arr)},min=function min(arr){return _Mathmin.apply(null,arr)};function nearestIndex(arr,x){var l=[],h=[];arr.forEach(function(v){if(v<x){l.push(v)}else if(v>x){h.push(v)}});return{low:arr.indexOf(max(l)),high:arr.indexOf(min(h))}}function prefetch(element){var stackData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stack");if(!stackData||!stackData.data||!stackData.data.length){return}var stack=stackData.data[0],stackPrefetchData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);if(!stackPrefetchData){return}var stackPrefetch=stackPrefetchData.data[0]||{};if(!stackPrefetch.indicesToRequest||!stackPrefetch.indicesToRequest.length){stackPrefetch.enabled=!1}if(!1===stackPrefetch.enabled){return}function removeFromList(imageIdIndex){var index=stackPrefetch.indicesToRequest.indexOf(imageIdIndex);if(-1<index){stackPrefetch.indicesToRequest.splice(index,1)}}stackPrefetchData.data[0].indicesToRequest.sort(function(a,b){return a-b});var indicesToRequestCopy=stackPrefetch.indicesToRequest.slice();indicesToRequestCopy.forEach(function(imageIdIndex){var imageId=stack.imageIds[imageIdIndex];if(!imageId){return}var imageLoadObject=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.imageCache.getImageLoadObject(imageId);if(imageLoadObject){removeFromList(imageIdIndex)}});if(!stackPrefetch.indicesToRequest.length){return}_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].clearRequestStack(requestType);var nearest=nearestIndex(stackPrefetch.indicesToRequest,stack.currentImageIdIndex),imageId,nextImageIdIndex,preventCache=!1;function doneCallback(image){logger.log("prefetch done: %s",image.imageId);var imageIdIndex=stack.imageIds.indexOf(image.imageId);removeFromList(imageIdIndex)}var errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();function failCallback(error){logger.log("prefetch errored: %o",error);if(errorLoadingHandler){errorLoadingHandler(element,imageId,error,"stackPrefetch")}}var lowerIndex=nearest.low,higherIndex=nearest.high;while(0<=lowerIndex||higherIndex<stackPrefetch.indicesToRequest.length){var currentIndex=stack.currentImageIdIndex,shouldSkipLower=currentIndex-stackPrefetch.indicesToRequest[lowerIndex]>configuration.maxImagesToPrefetch,shouldSkipHigher=stackPrefetch.indicesToRequest[higherIndex]-currentIndex>configuration.maxImagesToPrefetch,shouldLoadLower=!shouldSkipLower&&0<=lowerIndex,shouldLoadHigher=!shouldSkipHigher&&higherIndex<stackPrefetch.indicesToRequest.length;if(!shouldLoadHigher&&!shouldLoadLower){break}if(shouldLoadLower){nextImageIdIndex=stackPrefetch.indicesToRequest[lowerIndex--];imageId=stack.imageIds[nextImageIdIndex];_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].addRequest(element,imageId,requestType,preventCache,doneCallback,failCallback)}if(shouldLoadHigher){nextImageIdIndex=stackPrefetch.indicesToRequest[higherIndex++];imageId=stack.imageIds[nextImageIdIndex];_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].addRequest(element,imageId,requestType,preventCache,doneCallback,failCallback)}}_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].startGrabbing()}function getPromiseRemovedHandler(element){return function(e){var eventData=e.detail,stackData;try{stackData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stack")}catch(error){return}if(!stackData||!stackData.data||!stackData.data.length){return}var stack=stackData.data[0],imageIdIndex=stack.imageIds.indexOf(eventData.imageId);if(0>imageIdIndex){return}var stackPrefetchData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);if(!stackPrefetchData||!stackPrefetchData.data||!stackPrefetchData.data.length){return}stackPrefetchData.data[0].indicesToRequest.push(imageIdIndex)}}function onImageUpdated(e){clearTimeout(resetPrefetchTimeout);resetPrefetchTimeout=setTimeout(function(){var element=e.target;try{prefetch(element)}catch(error){return}},resetPrefetchDelay)}function enable(element){var stackPrefetchDataArray=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);stackPrefetchDataArray.data=[];var stackData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,"stack");if(!stackData||!stackData.data||!stackData.data.length){return}var stack=stackData.data[0];if(!0===stack.preventCache){logger.warn("A stack that should not be cached was given the stackPrefetch");return}var stackPrefetchData={indicesToRequest:range(0,stack.imageIds.length-1),enabled:!0,direction:1},indexOfCurrentImage=stackPrefetchData.indicesToRequest.indexOf(stack.currentImageIdIndex);stackPrefetchData.indicesToRequest.splice(indexOfCurrentImage,1);Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.addToolState)(element,toolType,stackPrefetchData);prefetch(element);element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.NEW_IMAGE,onImageUpdated);element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.NEW_IMAGE,onImageUpdated);var promiseRemovedHandler=getPromiseRemovedHandler(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.events.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,promiseRemovedHandler);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.events.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,promiseRemovedHandler)}function disable(element){clearTimeout(resetPrefetchTimeout);element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.NEW_IMAGE,onImageUpdated);var promiseRemovedHandler=getPromiseRemovedHandler(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.events.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,promiseRemovedHandler);var stackPrefetchData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,toolType);if(stackPrefetchData&&stackPrefetchData.data.length){stackPrefetchData.data[0].enabled=!1;_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].clearRequestStack(requestType)}}function getConfiguration(){return configuration}function setConfiguration(config){configuration=config;if(config.maxSimultaneousRequests){Object(_util_getMaxSimultaneousRequests_js__WEBPACK_IMPORTED_MODULE_4__.setMaxSimultaneousRequests)(config.maxSimultaneousRequests)}}var stackPrefetch={enable:enable,disable:disable,getConfiguration:getConfiguration,setConfiguration:setConfiguration};__webpack_exports__["default"]=stackPrefetch},"./stackTools/stackRenderers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _fusionRenderer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stackTools/fusionRenderer.js"),stackRenderers={};stackRenderers.FusionRenderer=_fusionRenderer_js__WEBPACK_IMPORTED_MODULE_0__["default"];__webpack_exports__["default"]=stackRenderers},"./stateManagement/frameOfReferenceStateManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"newFrameOfReferenceSpecificToolStateManager",function(){return newFrameOfReferenceSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"globalFrameOfReferenceSpecificToolStateManager",function(){return globalFrameOfReferenceSpecificToolStateManager});function newFrameOfReferenceSpecificToolStateManager(){var toolState={};function addFrameOfReferenceSpecificToolState(frameOfReference,toolType,data){if(!1===toolState.hasOwnProperty(frameOfReference)){toolState[frameOfReference]={}}var frameOfReferenceToolState=toolState[frameOfReference];if(!1===frameOfReferenceToolState.hasOwnProperty(toolType)){frameOfReferenceToolState[toolType]={data:[]}}var toolData=frameOfReferenceToolState[toolType];toolData.data.push(data)}function getFrameOfReferenceSpecificToolState(frameOfReference,toolType){if(!1===toolState.hasOwnProperty(frameOfReference)){return}var frameOfReferenceToolState=toolState[frameOfReference];if(!1===frameOfReferenceToolState.hasOwnProperty(toolType)){return}var toolData=frameOfReferenceToolState[toolType];return toolData}function removeFrameOfReferenceSpecificToolState(frameOfReference,toolType,data){if(!1===toolState.hasOwnProperty(frameOfReference)){return}var frameOfReferenceToolState=toolState[frameOfReference];if(!1===frameOfReferenceToolState.hasOwnProperty(toolType)){return}for(var toolData=frameOfReferenceToolState[toolType],indexOfData=-1,i=0;i<toolData.data.length;i++){if(toolData.data[i]===data){indexOfData=i}}if(-1!==indexOfData){toolData.data.splice(indexOfData,1)}}return{get:getFrameOfReferenceSpecificToolState,add:addFrameOfReferenceSpecificToolState,remove:removeFrameOfReferenceSpecificToolState}}var globalFrameOfReferenceSpecificToolStateManager=newFrameOfReferenceSpecificToolStateManager()},"./stateManagement/imageIdSpecificStateManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"newImageIdSpecificToolStateManager",function(){return newImageIdSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"globalImageIdSpecificToolStateManager",function(){return globalImageIdSpecificToolStateManager});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");function newImageIdSpecificToolStateManager(){var toolState={};function saveImageIdToolState(imageId){return toolState[imageId]}function restoreImageIdToolState(imageId,imageIdToolState){toolState[imageId]=imageIdToolState}function saveToolState(){return toolState}function restoreToolState(savedToolState){toolState=savedToolState}function addImageIdSpecificToolState(element,toolType,data){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return}if(!1===toolState.hasOwnProperty(enabledElement.image.imageId)){toolState[enabledElement.image.imageId]={}}var imageIdToolState=toolState[enabledElement.image.imageId];if(!1===imageIdToolState.hasOwnProperty(toolType)){imageIdToolState[toolType]={data:[]}}var toolData=imageIdToolState[toolType];toolData.data.push(data)}function getImageIdSpecificToolState(element,toolType){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image||!1===toolState.hasOwnProperty(enabledElement.image.imageId)){return}var imageIdToolState=toolState[enabledElement.image.imageId];if(!1===imageIdToolState.hasOwnProperty(toolType)){return}var toolData=imageIdToolState[toolType];return toolData}function clearImageIdSpecificToolStateManager(element){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image||!1===toolState.hasOwnProperty(enabledElement.image.imageId)){return}delete toolState[enabledElement.image.imageId]}return{get:getImageIdSpecificToolState,add:addImageIdSpecificToolState,clear:clearImageIdSpecificToolStateManager,saveImageIdToolState:saveImageIdToolState,restoreImageIdToolState:restoreImageIdToolState,saveToolState:saveToolState,restoreToolState:restoreToolState,toolState:toolState}}var globalImageIdSpecificToolStateManager=newImageIdSpecificToolStateManager()},"./stateManagement/loadHandlerManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defaultStartLoadHandler,defaultEndLoadHandler,defaultErrorLoadingHandler;function setStartLoadHandler(handler){defaultStartLoadHandler=handler}function getStartLoadHandler(){return defaultStartLoadHandler}function setEndLoadHandler(handler){defaultEndLoadHandler=handler}function getEndLoadHandler(){return defaultEndLoadHandler}function setErrorLoadingHandler(handler){defaultErrorLoadingHandler=handler}function getErrorLoadingHandler(){return defaultErrorLoadingHandler}var loadHandlerManager={setStartLoadHandler:setStartLoadHandler,getStartLoadHandler:getStartLoadHandler,setEndLoadHandler:setEndLoadHandler,getEndLoadHandler:getEndLoadHandler,setErrorLoadingHandler:setErrorLoadingHandler,getErrorLoadingHandler:getErrorLoadingHandler};__webpack_exports__["default"]=loadHandlerManager},"./stateManagement/stackSpecificStateManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"stackSpecificStateManager",function(){return stackSpecificStateManager});__webpack_require__.d(__webpack_exports__,"newStackSpecificToolStateManager",function(){return newStackSpecificToolStateManager});__webpack_require__.d(__webpack_exports__,"addStackStateManager",function(){return addStackStateManager});var _imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/imageIdSpecificStateManager.js"),_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js");function newStackSpecificToolStateManager(toolTypes,oldStateManager){var toolState={};function saveToolState(){return toolState}function restoreToolState(stackToolState){toolState=stackToolState}function addStackSpecificToolState(element,toolType,data){if(0<=toolTypes.indexOf(toolType)){if(!1===toolState.hasOwnProperty(toolType)){toolState[toolType]={data:[]}}var toolData=toolState[toolType];toolData.data.push(data)}else{return oldStateManager.add(element,toolType,data)}}function getStackSpecificToolState(element,toolType){if(0<=toolTypes.indexOf(toolType)){if(!1===toolState.hasOwnProperty(toolType)){toolState[toolType]={data:[]}}return toolState[toolType]}return oldStateManager.get(element,toolType)}var stackSpecificToolStateManager={get:getStackSpecificToolState,add:addStackSpecificToolState,saveToolState:saveToolState,restoreToolState:restoreToolState,toolState:toolState};return stackSpecificToolStateManager}var stackStateManagers=[];function addStackStateManager(element,otherTools){var oldStateManager=Object(_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getElementToolStateManager)(element);if(!oldStateManager){oldStateManager=_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_0__.globalImageIdSpecificToolStateManager}var stackTools=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];if(otherTools){stackTools=stackTools.concat(otherTools)}var stackSpecificStateManager=newStackSpecificToolStateManager(stackTools,oldStateManager);stackStateManagers.push(stackSpecificStateManager);Object(_toolState_js__WEBPACK_IMPORTED_MODULE_1__.setElementToolStateManager)(element,stackSpecificStateManager)}var stackSpecificStateManager={newStackSpecificToolStateManager:newStackSpecificToolStateManager,addStackStateManager:addStackStateManager}},"./stateManagement/textStyle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defaultFontSize=15,defaultFont="".concat(defaultFontSize,"px Arial"),defaultBackgroundColor="transparent";function setFont(font){defaultFont=font}function getFont(){return defaultFont}function setFontSize(fontSize){defaultFontSize=fontSize}function getFontSize(){return defaultFontSize}function setBackgroundColor(backgroundColor){defaultBackgroundColor=backgroundColor}function getBackgroundColor(){return defaultBackgroundColor}var textStyle={setFont:setFont,getFont:getFont,setFontSize:setFontSize,getFontSize:getFontSize,setBackgroundColor:setBackgroundColor,getBackgroundColor:getBackgroundColor};__webpack_exports__["default"]=textStyle},"./stateManagement/toolColors.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defaultColor="white",activeColor="greenyellow",fillColor="transparent";function setFillColor(color){fillColor=color}function getFillColor(){return fillColor}function setToolColor(color){defaultColor=color}function getToolColor(){return defaultColor}function setActiveColor(color){activeColor=color}function getActiveColor(){return activeColor}function getColorIfActive(data){if(data.color){return data.color}return data.active?activeColor:defaultColor}var toolColors={setFillColor:setFillColor,getFillColor:getFillColor,setToolColor:setToolColor,getToolColor:getToolColor,setActiveColor:setActiveColor,getActiveColor:getActiveColor,getColorIfActive:getColorIfActive};__webpack_exports__["default"]=toolColors},"./stateManagement/toolCoordinates.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var coordsData;function setCoords(eventData){coordsData=eventData.currentPoints.canvas}function getCoords(){return coordsData}var toolCoordinates={setCoords:setCoords,getCoords:getCoords};__webpack_exports__["default"]=toolCoordinates},"./stateManagement/toolState.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"addToolState",function(){return addToolState});__webpack_require__.d(__webpack_exports__,"getToolState",function(){return getToolState});__webpack_require__.d(__webpack_exports__,"removeToolState",function(){return removeToolState});__webpack_require__.d(__webpack_exports__,"clearToolState",function(){return clearToolState});__webpack_require__.d(__webpack_exports__,"setElementToolStateManager",function(){return setElementToolStateManager});__webpack_require__.d(__webpack_exports__,"getElementToolStateManager",function(){return getElementToolStateManager});var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/imageIdSpecificStateManager.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/triggerEvent.js");function getElementToolStateManager(element){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);if(void 0===enabledElement.toolStateManager){enabledElement.toolStateManager=_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_2__.globalImageIdSpecificToolStateManager}return enabledElement.toolStateManager}function addToolState(element,toolType,measurementData){var toolStateManager=getElementToolStateManager(element);toolStateManager.add(element,toolType,measurementData);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MEASUREMENT_ADDED,eventData={toolType:toolType,element:element,measurementData:measurementData};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,eventType,eventData)}function getToolState(element,toolType){var toolStateManager=getElementToolStateManager(element);return toolStateManager.get(element,toolType)}function removeToolState(element,toolType,data){for(var toolStateManager=getElementToolStateManager(element),toolData=toolStateManager.get(element,toolType),indexOfData=-1,i=0;i<toolData.data.length;i++){if(toolData.data[i]===data){indexOfData=i}}if(-1!==indexOfData){toolData.data.splice(indexOfData,1);var eventType=_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].MEASUREMENT_REMOVED,eventData={toolType:toolType,element:element,measurementData:data};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_3__["default"])(element,eventType,eventData)}}function clearToolState(element,toolType){var toolStateManager=getElementToolStateManager(element),toolData=toolStateManager.get(element,toolType);if(void 0!==toolData){toolData.data=[]}}function setElementToolStateManager(element,toolStateManager){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.getEnabledElement(element);enabledElement.toolStateManager=toolStateManager}},"./stateManagement/toolStyle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defaultWidth=1,activeWidth=2;function setToolWidth(width){defaultWidth=width}function getToolWidth(){return defaultWidth}function setActiveWidth(width){activeWidth=width}function getActiveWidth(){return activeWidth}var toolStyle={setToolWidth:setToolWidth,getToolWidth:getToolWidth,setActiveWidth:setActiveWidth,getActiveWidth:getActiveWidth};__webpack_exports__["default"]=toolStyle},"./store/addTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"addTool",function(){return addTool});__webpack_require__.d(__webpack_exports__,"addToolForElement",function(){return addToolForElement});var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_getToolForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getToolForElement.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_2__.getLogger)("addTool"),addToolForElement=function addToolForElement(element,ApiTool,configuration){var tool=new ApiTool(configuration),toolAlreadyAddedToElement=Object(_getToolForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,tool.name);if(toolAlreadyAddedToElement){logger.warn("%s has already been added to the target element",tool.name);return}tool.element=element;_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.tools.push(tool)},addTool=function addTool(ApiTool,configuration){_addToolGlobally(ApiTool,configuration);_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.enabledElements.forEach(function(element){addToolForElement(element,ApiTool,configuration)})},_addToolGlobally=function _addToolGlobally(ApiTool,configuration){if(!_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].modules.globalConfiguration.state.globalToolSyncEnabled){return}var tool=new ApiTool(configuration),toolAlreadyAddedGlobally=void 0!==_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.globalTools[tool.name];if(toolAlreadyAddedGlobally){logger.warn("%s has already been added globally",tool.name);return}_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.globalTools[tool.name]={tool:ApiTool,configuration:configuration,activeBindings:[]}}},"./store/filterToolsUsableWithMultiPartTools.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/base/BaseBrushTool.js");__webpack_exports__["default"]=function(tools){return tools.filter(function(tool){return!tool.isMultiPartTool&&!(tool instanceof _tools_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_0__["default"])&&!(tool instanceof _tools_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_1__["default"])})}},"./store/getActiveToolsForElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(element,tools,handlerType){return tools.filter(function(tool){return tool.element===element&&"active"===tool.mode&&(void 0===handlerType||tool.options["is".concat(handlerType,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(element,tools){return tools.filter(function(tool){return tool.element===element&&("active"===tool.mode||"passive"===tool.mode)})}},"./store/getToolForElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js");__webpack_exports__["default"]=function(element,name){return _index_js__WEBPACK_IMPORTED_MODULE_0__.state.tools.find(function(tool){return tool.element===element&&tool.name===name})}},"./store/getToolsWithDataForElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./stateManagement/toolState.js");__webpack_exports__["default"]=function(element,tools){return tools.filter(function(tool){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_0__.getToolState)(element,tool.name);return toolState&&0<toolState.data.length})}},"./store/getToolsWithMoveableHandles.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/getHandleNearImagePoint.js");__webpack_exports__["default"]=function(element,tools,coords){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse",proximity="mouse"===interactionType?_index_js__WEBPACK_IMPORTED_MODULE_0__.state.clickProximity:_index_js__WEBPACK_IMPORTED_MODULE_0__.state.touchProximity;return tools.filter(function(tool){for(var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(element,tool.name),i=0;i<toolState.data.length;i++){if(void 0!==Object(_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,toolState.data[i].handles,coords,proximity)){return!0}}return!1})}},"./store/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"state",function(){return state});__webpack_require__.d(__webpack_exports__,"getters",function(){return getters});__webpack_require__.d(__webpack_exports__,"setters",function(){return setters});__webpack_require__.d(__webpack_exports__,"modules",function(){return modules});var _modules_brushModule_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/modules/brushModule.js"),_modules_cursorModule_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/modules/cursorModule.js"),_modules_globalConfigurationModule_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/modules/globalConfigurationModule.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),state={globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,svgCursorUrl:null},getters={mouseTools:function mouseTools(){return state.tools.filter(function(tool){return tool.supportedInteractionTypes.includes("Mouse")})},touchTools:function touchTools(){return state.tools.filter(function(tool){return tool.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function enabledElementByUID(enabledElementUID){return state.enabledElements.find(function(element){return _externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.getEnabledElement(element).uuid===enabledElementUID})}},setters={},modules={brush:_modules_brushModule_js__WEBPACK_IMPORTED_MODULE_0__["default"],cursor:_modules_cursorModule_js__WEBPACK_IMPORTED_MODULE_1__["default"],globalConfiguration:_modules_globalConfigurationModule_js__WEBPACK_IMPORTED_MODULE_2__["default"]};__webpack_exports__["default"]={modules:modules,state:state,getters:getters}},"./store/internals/addEnabledElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventListeners/index.js"),_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/index.js"),_addTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/addTool.js"),_setToolMode_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/setToolMode.js"),_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_5__.getLogger)("internals:addEnabledElement");__webpack_exports__["default"]=function(elementEnabledEvt){logger.log("EVENT:ELEMENT_ENABLED");var enabledElement=elementEnabledEvt.detail.element;_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.imageRenderedEventDispatcher.enable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.newImageEventDispatcher.enable(enabledElement);if(_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules.globalConfiguration.state.mouseEnabled){_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.mouseEventListeners.enable(enabledElement);_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.wheelEventListener.enable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseToolEventDispatcher.enable(enabledElement)}if(_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules.globalConfiguration.state.touchEnabled){_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.touchEventListeners.enable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchToolEventDispatcher.enable(enabledElement)}_addEnabledElement(enabledElement)};var _addEnabledElement=function _addEnabledElement(enabledElement){_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].state.enabledElements.push(enabledElement);if(_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules){_initModulesOnElement(enabledElement)}_addGlobalToolsToElement(enabledElement);_repeatGlobalToolHistory(enabledElement)};function _initModulesOnElement(enabledElement){var modules=_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules;Object.keys(modules).forEach(function(key){if("function"===typeof modules[key].enabledElementCallback){modules[key].enabledElementCallback(enabledElement)}})}function _addGlobalToolsToElement(enabledElement){if(!_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules.globalConfiguration.state.globalToolSyncEnabled){return}Object.keys(_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].state.globalTools).forEach(function(key){var _store$state$globalTo=_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].state.globalTools[key],tool=_store$state$globalTo.tool,configuration=_store$state$globalTo.configuration;Object(_addTool_js__WEBPACK_IMPORTED_MODULE_2__.addToolForElement)(enabledElement,tool,configuration)})}function _repeatGlobalToolHistory(enabledElement){if(!_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].modules.globalConfiguration.state.globalToolSyncEnabled){return}var setToolModeFns={active:_setToolMode_js__WEBPACK_IMPORTED_MODULE_3__.setToolActiveForElement,passive:_setToolMode_js__WEBPACK_IMPORTED_MODULE_3__.setToolPassiveForElement,enabled:_setToolMode_js__WEBPACK_IMPORTED_MODULE_3__.setToolEnabledForElement,disabled:_setToolMode_js__WEBPACK_IMPORTED_MODULE_3__.setToolDisabledForElement};_index_js__WEBPACK_IMPORTED_MODULE_4__["default"].state.globalToolChangeHistory.forEach(function(historyEvent){var args=historyEvent.args.slice(0);args.unshift(enabledElement);setToolModeFns[historyEvent.mode].apply(null,args)})}},"./store/internals/removeEnabledElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./eventListeners/index.js"),_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./eventDispatchers/index.js"),_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_3__.getLogger)("internals:removeEnabledElement");__webpack_exports__["default"]=function(elementDisabledEvt){logger.log("EVENT:ELEMENT_DISABLED");var enabledElement=elementDisabledEvt.detail.element;_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.imageRenderedEventDispatcher.disable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.newImageEventDispatcher.disable(enabledElement);if(_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].modules.globalConfiguration.state.mouseEnabled){_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.mouseEventListeners.disable(enabledElement);_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.wheelEventListener.disable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.mouseToolEventDispatcher.disable(enabledElement)}if(_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].modules.globalConfiguration.state.touchEnabled){_eventListeners_index_js__WEBPACK_IMPORTED_MODULE_0__.touchEventListeners.disable(enabledElement);_eventDispatchers_index_js__WEBPACK_IMPORTED_MODULE_1__.touchToolEventDispatcher.disable(enabledElement)}_removeAllToolsForElement(enabledElement);_removeEnabledElement(enabledElement)};var _removeAllToolsForElement=function _removeAllToolsForElement(enabledElement){_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].state.tools=_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].state.tools.filter(function(tool){return tool.element!==enabledElement})},_removeEnabledElement=function _removeEnabledElement(enabledElement){if(_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].modules){_cleanModulesOnElement(enabledElement)}var foundElementIndex=_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].state.enabledElements.findIndex(function(element){return element===enabledElement});if(-1<foundElementIndex){_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].state.enabledElements.splice(foundElementIndex,1)}else{logger.warn("unable to remove element")}};function _cleanModulesOnElement(enabledElement){var modules=_index_js__WEBPACK_IMPORTED_MODULE_2__["default"].modules;Object.keys(modules).forEach(function(key){if("function"===typeof modules[key].removeEnabledElementCallback){modules[key].removeEnabledElementCallback(enabledElement)}})}},"./store/isToolActive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getToolForElement_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/getToolForElement.js");__webpack_exports__["default"]=function(element,name){var tool=Object(_getToolForElement_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,name);return"active"===tool.mode}},"./store/modules/brushModule.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),state={drawColorId:0,radius:10,minRadius:1,maxRadius:50,alpha:.4,renderBrushIfHiddenButActive:!0,hiddenButActiveAlpha:.2,colorMapId:"BrushColorMap",visibleSegmentations:{},imageBitmapCache:{},segmentationMetadata:{}},setters={radius:function radius(_radius){state.radius=_Mathmin(_Mathmax(_radius,state.minRadius),state.maxRadius)},brushColorMap:function brushColorMap(colors){var colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.colors.getColormap(state.colorMapId);colormap.setNumberOfColors(colors.length);for(var i=0;i<colors.length;i++){colormap.setColor(i,colors[i])}},elementVisible:function elementVisible(enabledElement){if(!_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone){return}var cornerstoneEnabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(enabledElement),enabledElementUID=cornerstoneEnabledElement.uuid,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.colors.getColormap(state.colorMapId),numberOfColors=colormap.getNumberOfColors();state.visibleSegmentations[enabledElementUID]=[];for(var i=0;i<numberOfColors;i++){state.visibleSegmentations[enabledElementUID].push(!0)}},brushVisibilityForElement:function brushVisibilityForElement(enabledElementUID,segIndex){var visible=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if(!state.visibleSegmentations[enabledElementUID]){state.imageBitmapCache[enabledElementUID]=[]}state.visibleSegmentations[enabledElementUID][segIndex]=visible},imageBitmapCacheForElement:function imageBitmapCacheForElement(enabledElementUID,segIndex,imageBitmap){if(!state.imageBitmapCache[enabledElementUID]){state.imageBitmapCache[enabledElementUID]=[]}state.imageBitmapCache[enabledElementUID][segIndex]=imageBitmap},clearImageBitmapCacheForElement:function clearImageBitmapCacheForElement(enabledElementUID){state.imageBitmapCache[enabledElementUID]=[]},metadata:function metadata(seriesInstanceUid,segIndex,_metadata){if(!state.segmentationMetadata[seriesInstanceUid]){state.segmentationMetadata[seriesInstanceUid]=[]}state.segmentationMetadata[seriesInstanceUid][segIndex]=_metadata}},getters={imageBitmapCacheForElement:function imageBitmapCacheForElement(enabledElementUID){if(!state.imageBitmapCache[enabledElementUID]){return null}return state.imageBitmapCache[enabledElementUID]},visibleSegmentationsForElement:function visibleSegmentationsForElement(enabledElementUID){if(!state.visibleSegmentations[enabledElementUID]){return null}return state.visibleSegmentations[enabledElementUID]},metadata:function metadata(seriesInstanceUid,segIndex){if(!state.segmentationMetadata[seriesInstanceUid]){return}if(void 0!==segIndex){return state.segmentationMetadata[seriesInstanceUid][segIndex]}return state.segmentationMetadata[seriesInstanceUid]}};function enabledElementCallback(enabledElement){setters.elementVisible(enabledElement)}function removeEnabledElementCallback(enabledElement){if(!_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone){return}var cornerstoneEnabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(enabledElement),enabledElementUID=cornerstoneEnabledElement.uuid,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.colors.getColormap(state.colorMapId),numberOfColors=colormap.getNumberOfColors();delete state.visibleSegmentations[enabledElementUID];delete state.imageBitmapCache[enabledElementUID]}function onRegisterCallback(){_initDefaultColorMap()}__webpack_exports__["default"]={state:state,onRegisterCallback:onRegisterCallback,enabledElementCallback:enabledElementCallback,getters:getters,setters:setters};var distinctColors=[[230,25,75,255],[60,180,175,255],[255,225,25,255],[0,130,200,255],[245,130,48,255],[145,30,180,255],[70,240,240,255],[240,50,230,255],[210,245,60,255],[250,190,190,255],[0,128,128,255],[230,190,255,255],[170,110,40,255],[255,250,200,255],[128,0,0,255],[170,255,195,255],[128,128,0,255],[255,215,180,255],[0,0,128,255]],colorPairIndex=0;function _initDefaultColorMap(){var defaultSegmentationCount=19,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.colors.getColormap(state.colorMapId);colormap.setNumberOfColors(defaultSegmentationCount);for(var i=0;i<defaultSegmentationCount;i++){if(i<distinctColors.length){colormap.setColor(i,distinctColors[i])}else{colormap.setColor(i,_generateInterpolatedColor())}}}function _generateInterpolatedColor(){for(var randIndicies=_getNextColorPair(),fraction=Math.random(),interpolatedColor=[],i=0;4>i;i++){interpolatedColor.push(_Mathfloor(fraction*distinctColors[randIndicies[0]][i]+(1-fraction)*distinctColors[randIndicies[1]][i]))}return interpolatedColor}function _getNextColorPair(){var indexPair=[colorPairIndex];if(colorPairIndex<distinctColors.length-1){colorPairIndex++;indexPair.push(colorPairIndex)}else{colorPairIndex=0;indexPair.push(colorPairIndex)}return indexPair}},"./store/modules/cursorModule.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var state={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:"\n    <path stroke=\"ACTIVE_COLOR\" d=\"M8 16L8 0\"></path>\n    <path stroke=\"ACTIVE_COLOR\" d=\"M16 8L0 8\"></path>\n  "},setters={defaultOptions:function defaultOptions(newOptions){Object.assign(state,newOptions)}},getters={defaultOptions:function defaultOptions(){return state}};__webpack_exports__["default"]={getters:getters,setters:setters}},"./store/modules/globalConfigurationModule.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var state={mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1};__webpack_exports__["default"]={state:state,setters:{}}},"./store/removeTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"removeTool",function(){return removeTool});__webpack_require__.d(__webpack_exports__,"removeToolForElement",function(){return removeToolForElement});var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),removeToolForElement=function removeToolForElement(element,toolName){var toolIndex=_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.tools.findIndex(function(tool){return tool.element===element&&tool.name===toolName});if(0<=toolIndex){_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.tools.splice(toolIndex,1)}},removeTool=function removeTool(toolName){_removeToolGlobally(toolName);_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.enabledElements.forEach(function(element){removeToolForElement(element,toolName)})},_removeToolGlobally=function _removeToolGlobally(toolName){if(!_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].modules.globalConfiguration.state.globalToolSyncEnabled){return}if(_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.globalTools[toolName]){delete _index_js__WEBPACK_IMPORTED_MODULE_0__["default"].state.globalTools[toolName]}}},"./store/setToolCursor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"setToolCursor",function(){return setToolCursor});__webpack_require__.d(__webpack_exports__,"resetToolCursor",function(){return resetToolCursor});__webpack_require__.d(__webpack_exports__,"hideToolCursor",function(){return hideToolCursor});var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),globalConfiguration=_index_js__WEBPACK_IMPORTED_MODULE_0__.modules.globalConfiguration;function setToolCursor(element,svgCursor){if(!globalConfiguration.state.showSVGCursors){return}var cursorBlob=svgCursor.getIconWithPointerSVG(),mousePoint=svgCursor.mousePoint,svgCursorUrl=window.URL.createObjectURL(cursorBlob);element.style.cursor="url('".concat(svgCursorUrl,"') ").concat(mousePoint,", auto");_index_js__WEBPACK_IMPORTED_MODULE_0__.state.svgCursorUrl=svgCursorUrl}function resetToolCursor(element){_clearStateAndSetCursor(element,"initial")}function hideToolCursor(element){if(!globalConfiguration.state.showSVGCursors){return}_clearStateAndSetCursor(element,"none")}function _clearStateAndSetCursor(element,cursorSeting){if(_index_js__WEBPACK_IMPORTED_MODULE_0__.state.svgCursorUrl){window.URL.revokeObjectURL(_index_js__WEBPACK_IMPORTED_MODULE_0__.state.svgCursorUrl)}_index_js__WEBPACK_IMPORTED_MODULE_0__.state.svgCursorUrl=null;element.style.cursor=cursorSeting}},"./store/setToolMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"setToolActive",function(){return setToolActive});__webpack_require__.d(__webpack_exports__,"setToolActiveForElement",function(){return setToolActiveForElement});__webpack_require__.d(__webpack_exports__,"setToolDisabled",function(){return setToolDisabled});__webpack_require__.d(__webpack_exports__,"setToolDisabledForElement",function(){return setToolDisabledForElement});__webpack_require__.d(__webpack_exports__,"setToolEnabled",function(){return setToolEnabled});__webpack_require__.d(__webpack_exports__,"setToolEnabledForElement",function(){return setToolEnabledForElement});__webpack_require__.d(__webpack_exports__,"setToolPassive",function(){return setToolPassive});__webpack_require__.d(__webpack_exports__,"setToolPassiveForElement",function(){return setToolPassiveForElement});var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/triggerEvent.js"),_getToolForElement_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/getToolForElement.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/index.js"),_setToolCursor_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./store/setToolCursor.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/logger.js"),globalConfiguration=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].modules.globalConfiguration,logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_5__.getLogger)("store:setToolMode"),setToolActiveForElement=function setToolActiveForElement(element,toolName,options,interactionTypes){if(void 0===interactionTypes&&Array.isArray(options)){interactionTypes=options;options=null}var tool=Object(_getToolForElement_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,toolName);if(tool){_resolveInputConflicts(element,tool,options,interactionTypes);tool.supportedInteractionTypes.forEach(function(interactionType){if(void 0===interactionTypes||interactionTypes.includes(interactionType)){options["is".concat(interactionType,"Active")]=!0}else{options["is".concat(interactionType,"Active")]=!1}});if(globalConfiguration.state.showSVGCursors&&tool.supportedInteractionTypes.includes("Mouse")){_setToolCursorIfPrimary(element,options,tool)}}setToolModeForElement("active",null,element,toolName,options)};function _setToolCursorIfPrimary(element,options,tool){var mouseButtonMask;if("number"===typeof options){mouseButtonMask=[options]}else{mouseButtonMask=options.mouseButtonMask}if(mouseButtonMask.includes(1)){if(tool.svgCursor){Object(_setToolCursor_js__WEBPACK_IMPORTED_MODULE_4__.setToolCursor)(tool.element,tool.svgCursor)}else if(tool.hideDefaultCursor){Object(_setToolCursor_js__WEBPACK_IMPORTED_MODULE_4__.hideToolCursor)(element)}else{Object(_setToolCursor_js__WEBPACK_IMPORTED_MODULE_4__.resetToolCursor)(element)}}}var setToolActive=function setToolActive(toolName,options,interactionTypes){_trackGlobalToolModeChange("active",toolName,options,interactionTypes);_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.enabledElements.forEach(function(element){setToolActiveForElement(element,toolName,options,interactionTypes)})},setToolDisabledForElement=setToolModeForElement.bind(null,"disabled",null),setToolDisabled=setToolMode.bind(null,"disabled",null),setToolEnabledForElement=setToolModeForElement.bind(null,"enabled",null),setToolEnabled=setToolMode.bind(null,"enabled",null),setToolPassiveForElement=setToolModeForElement.bind(null,"passive",_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOOL_DEACTIVATED),setToolPassive=setToolMode.bind(null,"passive",_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOOL_DEACTIVATED);function setToolModeForElement(mode,changeEvent,element,toolName,options){var tool=Object(_getToolForElement_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,toolName);if(!tool){logger.warn("Unable to find tool \"%s\" for enabledElement",toolName);return}options=_getNormalizedOptions(options);if(Array.isArray(options.mouseButtonMask)&&0!==options.mouseButtonMask.length&&Array.isArray(tool.options.mouseButtonMask)){options.mouseButtonMask=options.mouseButtonMask.concat(tool.options.mouseButtonMask).reduce(function(acc,m){if(-1===acc.indexOf(m)){acc.push(m)}return acc},[])}tool.mode=mode;tool.mergeOptions(options);if(tool["".concat(mode,"Callback")]){tool["".concat(mode,"Callback")](element,options)}if(changeEvent){var statusChangeEventData={options:options,toolName:toolName,type:changeEvent};Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,changeEvent,statusChangeEventData)}}function setToolMode(mode,changeEvent,toolName,options){_trackGlobalToolModeChange(mode,toolName,options);_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.enabledElements.forEach(function(element){setToolModeForElement(mode,changeEvent,element,toolName,options)})}function _resolveInputConflicts(element,tool,options,interactionTypes){tool.supportedInteractionTypes.forEach(function(interactionType){if(void 0===interactionTypes||interactionTypes.includes(interactionType)){var inputResolver=_inputResolvers[interactionType];if(inputResolver){inputResolver(tool,element,options)}else{logger.warn("Unable to resolve input conflicts for type %s",interactionType)}}});var activeToolsForElement=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.filter(function(t){return t.element===element&&"active"===t.mode&&0<t.supportedInteractionTypes.length});activeToolsForElement.forEach(function(t){var toolHasAnyActiveInteractionType=!1;t.supportedInteractionTypes.forEach(function(interactionType){if(t.options["is".concat(interactionType,"Active")]){toolHasAnyActiveInteractionType=!0}});if(!toolHasAnyActiveInteractionType){logger.log("Setting tool %s's to PASSIVE",t.name);setToolPassiveForElement(element,t.name)}})}function _resolveMouseInputConflicts(tool,element,options){var mouseButtonMask=_getNormalizedOptions(options).mouseButtonMask,hasMouseButtonMask=Array.isArray(mouseButtonMask)&&0<mouseButtonMask.length;if(!hasMouseButtonMask){return}var activeToolWithMatchingMouseButtonMask=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isMouseActive&&Array.isArray(t.options.mouseButtonMask)&&t.options.mouseButtonMask.some(function(v){return mouseButtonMask.includes(v)})});if(activeToolWithMatchingMouseButtonMask){activeToolWithMatchingMouseButtonMask.options.mouseButtonMask=activeToolWithMatchingMouseButtonMask.options.mouseButtonMask.filter(function(mask){return!mouseButtonMask.includes(mask)});if(0===activeToolWithMatchingMouseButtonMask.options.mouseButtonMask.length){activeToolWithMatchingMouseButtonMask.options.isMouseActive=!1}}}function _resolveTouchInputConflicts(tool,element,options){var activeTouchTool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isTouchActive}),activeMultiTouchToolWithOneTouchPointer=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isMultiTouchActive&&1===t.configuration.touchPointers});if(activeTouchTool){logger.log("Setting tool %s's isTouchActive to false",activeTouchTool.name);activeTouchTool.options.isTouchActive=!1}if(activeMultiTouchToolWithOneTouchPointer){logger.log("Setting tool %s's isTouchActive to false",activeMultiTouchToolWithOneTouchPointer.name);activeMultiTouchToolWithOneTouchPointer.options.isMultiTouchActive=!1}}function _resolveMultiTouchInputConflicts(tool,element,options){var activeMultiTouchTool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isMultiTouchActive&&t.configuration.touchPointers===tool.configuration.touchPointers}),activeTouchTool;if(1===tool.configuration.touchPointers){activeTouchTool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isTouchActive})}if(activeMultiTouchTool){logger.log("Setting tool %s's isMultiTouchActive to false",activeMultiTouchTool.name);activeMultiTouchTool.options.isMultiTouchActive=!1}if(activeTouchTool){logger.log("Setting tool %s's isTouchActive to false",activeTouchTool.name);activeTouchTool.options.isTouchActive=!1}}function _resolveGenericInputConflicts(interactionType,tool,element,options){var interactionTypeFlag="is".concat(interactionType,"Active"),activeToolWithActiveInteractionType=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.tools.find(function(t){return t.element===element&&"active"===t.mode&&!0===t.options[interactionTypeFlag]});if(activeToolWithActiveInteractionType){logger.log("Setting tool %s's %s to false",activeToolWithActiveInteractionType.name,interactionTypeFlag);activeToolWithActiveInteractionType.options[interactionTypeFlag]=!1}}function _trackGlobalToolModeChange(mode,toolName,options,interactionTypes){if(!_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].modules.globalConfiguration.state.globalToolSyncEnabled){return}var historyEvent={mode:mode,args:[toolName,options]};if(interactionTypes){historyEvent.push(interactionTypes)}_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalToolChangeHistory.push(historyEvent);var arbitraryChangeHistoryLimit=50;if(_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalToolChangeHistory.length>arbitraryChangeHistoryLimit){_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalToolChangeHistory.shift()}var globalTool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalTools[toolName];if("active"===mode){var stringBindings=_determineStringBindings(toolName,options,interactionTypes);Object.keys(_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalTools).forEach(function(key){var tool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalTools[key];tool.activeBindings=tool.activeBindings.filter(function(binding){return!stringBindings.includes(binding)})});if(stringBindings.some(function(binding){return binding.includes("Mouse-DELETE")})){globalTool.activeBindings=globalTool.activeBindings.filter(function(binding){return!binding.includes("Mouse")});stringBindings=stringBindings.filter(function(binding){return!binding.includes("Mouse")})}globalTool.activeBindings=globalTool.activeBindings.concat(stringBindings)}else{globalTool.activeBindings=[]}}function _determineStringBindings(toolName,options,interactionTypes){if(void 0===interactionTypes&&Array.isArray(options)){interactionTypes=options;options=null}var stringBindings=[],globalTool=_store_index_js__WEBPACK_IMPORTED_MODULE_3__["default"].state.globalTools[toolName];if(globalTool){var tool=new globalTool.tool(globalTool.configuration);tool.supportedInteractionTypes.forEach(function(interactionType){if(void 0===interactionTypes||interactionTypes.includes(interactionType)){if("Mouse"===interactionType){var mouseButtonMasks=_getNormalizedOptions(options).mouseButtonMask;if(Array.isArray(mouseButtonMasks)&&0<mouseButtonMasks.length){mouseButtonMasks.forEach(function(mask){return stringBindings.push("".concat(interactionType,"-").concat(mask))})}else if(Array.isArray(mouseButtonMasks)&&0===mouseButtonMasks.length){stringBindings.push("".concat(interactionType,"-DELETE"))}}else if("MultiTouch"===interactionType){stringBindings.push("".concat(interactionType,"-").concat(tool.configuration.touchPointers))}else{stringBindings.push(interactionType)}}})}return stringBindings}var _inputResolvers={Mouse:_resolveMouseInputConflicts,MouseWheel:_resolveGenericInputConflicts.bind(void 0,"MouseWheel"),Touch:_resolveTouchInputConflicts,TouchPinch:_resolveGenericInputConflicts.bind(void 0,"TouchPinch"),TouchRotate:_resolveGenericInputConflicts.bind(void 0,"TouchRotate"),DoubleTap:_resolveGenericInputConflicts.bind(void 0,"DoubleTap"),MultiTouch:_resolveMultiTouchInputConflicts};function _getNormalizedOptions(options){if(options===Object(options)&&!Array.isArray(options)){if(0===options.mouseButtonMask||null===options.mouseButtonMask){options.mouseButtonMask=[]}else if("number"===typeof options.mouseButtonMask){var tempArray=[options.mouseButtonMask];options.mouseButtonMask=tempArray}}else if("number"===typeof options){var _tempArray=[options];options={mouseButtonMask:0===options?[]:_tempArray}}else if(null===options){options={mouseButtonMask:[]}}else{logger.log("No options provided when changing tool mode");options={}}return options}},"./store/setToolOptions.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"setToolOptions",function(){return setToolOptions});__webpack_require__.d(__webpack_exports__,"setToolOptionsForElement",function(){return setToolOptionsForElement});var _index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_getToolForElement_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/getToolForElement.js"),setToolOptionsForElement=function setToolOptionsForElement(element,toolName,options){var tool=Object(_getToolForElement_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,toolName);if(tool){tool.mergeOptions(options)}},setToolOptions=function setToolOptions(toolName,options){_index_js__WEBPACK_IMPORTED_MODULE_0__.state.enabledElements.forEach(function(element){setToolOptionsForElement(element,options)})}},"./synchronization/Synchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/convertToVector3.js"),_toolOptions_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./toolOptions.js");function unique(array){return array.filter(function(value,index,self){return self.indexOf(value)===index})}function Synchronizer(event,handler){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,that=this,sourceElements=[],targetElements=[],ignoreFiredEvents=!1,initialData={},eventHandler=handler;this.enabled=!0;this.setHandler=function(handler){eventHandler=handler};this.getHandler=function(){return eventHandler};this.getDistances=function(){if(!sourceElements.length||!targetElements.length){return}initialData.distances={};initialData.imageIds={sourceElements:[],targetElements:[]};sourceElements.forEach(function(sourceElement){var sourceEnabledElement=cornerstone.getEnabledElement(sourceElement);if(!sourceEnabledElement||!sourceEnabledElement.image){return}var sourceImageId=sourceEnabledElement.image.imageId,sourceImagePlane=cornerstone.metaData.get("imagePlaneModule",sourceImageId);if(!sourceImagePlane||!sourceImagePlane.imagePositionPatient){return}var sourceImagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(sourceImagePlane.imagePositionPatient);if(initialData.hasOwnProperty(sourceEnabledElement)){return}initialData.distances[sourceImageId]={};initialData.imageIds.sourceElements.push(sourceImageId);targetElements.forEach(function(targetElement){var targetEnabledElement=cornerstone.getEnabledElement(targetElement);if(!targetEnabledElement||!targetEnabledElement.image){return}var targetImageId=targetEnabledElement.image.imageId;initialData.imageIds.targetElements.push(targetImageId);if(sourceElement===targetElement){return}if(sourceImageId===targetImageId){return}if(initialData.distances[sourceImageId].hasOwnProperty(targetImageId)){return}var targetImagePlane=cornerstone.metaData.get("imagePlaneModule",targetImageId);if(!targetImagePlane||!targetImagePlane.imagePositionPatient){return}var targetImagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(targetImagePlane.imagePositionPatient);initialData.distances[sourceImageId][targetImageId]=targetImagePosition.clone().sub(sourceImagePosition)});if(!Object.keys(initialData.distances[sourceImageId]).length){delete initialData.distances[sourceImageId]}})};function fireEvent(sourceElement,eventData){var isDisabled=!that.enabled,noElements=!sourceElements.length||!targetElements.length;if(isDisabled||noElements){return}ignoreFiredEvents=!0;targetElements.forEach(function(targetElement){var targetIndex=targetElements.indexOf(targetElement);if(-1===targetIndex){return}var targetImageId=initialData.imageIds.targetElements[targetIndex],sourceIndex=sourceElements.indexOf(sourceElement);if(-1===sourceIndex){return}var sourceImageId=initialData.imageIds.sourceElements[sourceIndex],positionDifference;if(sourceImageId===targetImageId){positionDifference=0}else if(void 0!==initialData.distances[sourceImageId]){positionDifference=initialData.distances[sourceImageId][targetImageId]}eventHandler(that,sourceElement,targetElement,eventData,positionDifference)});ignoreFiredEvents=!1}function onEvent(e){var eventData=e.detail;if(!0===ignoreFiredEvents){return}fireEvent(e.currentTarget,eventData)}this.addSource=function(element){var index=sourceElements.indexOf(element);if(-1!==index){return}sourceElements.push(element);event.split(" ").forEach(function(oneEvent){element.addEventListener(oneEvent,onEvent)});that.getDistances();that.updateDisableHandlers()};this.addTarget=function(element){var index=targetElements.indexOf(element);if(-1!==index){return}targetElements.push(element);that.getDistances();eventHandler(that,element,element,0);that.updateDisableHandlers()};this.add=function(element){that.addSource(element);that.addTarget(element)};this.removeSource=function(element){var index=sourceElements.indexOf(element);if(-1===index){return}sourceElements.splice(index,1);event.split(" ").forEach(function(oneEvent){element.removeEventListener(oneEvent,onEvent)});that.getDistances();fireEvent(element);that.updateDisableHandlers()};this.removeTarget=function(element){var index=targetElements.indexOf(element);if(-1===index){return}targetElements.splice(index,1);that.getDistances();eventHandler(that,element,element,0);that.updateDisableHandlers()};this.remove=function(element){that.removeTarget(element);that.removeSource(element)};this.getSourceElements=function(){return sourceElements};this.getTargetElements=function(){return targetElements};this.displayImage=function(element,image,viewport){ignoreFiredEvents=!0;cornerstone.displayImage(element,image,viewport);ignoreFiredEvents=!1};this.setViewport=function(element,viewport){ignoreFiredEvents=!0;cornerstone.setViewport(element,viewport);ignoreFiredEvents=!1};function disableHandler(e){var element=e.detail.element;that.remove(element);Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_2__.clearToolOptionsByElement)(element)}this.updateDisableHandlers=function(){var elements=unique(sourceElements.concat(targetElements));elements.forEach(function(element){element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.ELEMENT_DISABLED,disableHandler);element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.ELEMENT_DISABLED,disableHandler)})};this.destroy=function(){var elements=unique(sourceElements.concat(targetElements));elements.forEach(function(element){that.remove(element)})}}__webpack_exports__["default"]=Synchronizer},"./synchronization/panZoomSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement){if(targetElement===sourceElement){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,sourceViewport=cornerstone.getViewport(sourceElement),targetViewport=cornerstone.getViewport(targetElement);if(targetViewport.scale===sourceViewport.scale&&targetViewport.translation.x===sourceViewport.translation.x&&targetViewport.translation.y===sourceViewport.translation.y){return}targetViewport.scale=sourceViewport.scale;targetViewport.translation.x=sourceViewport.translation.x;targetViewport.translation.y=sourceViewport.translation.y;synchronizer.setViewport(targetElement,targetViewport)}},"./synchronization/stackImageIndexSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/clip.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement){if(targetElement===sourceElement){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,sourceStackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(sourceElement,"stack"),sourceStackData=sourceStackToolDataSource.data[0],targetStackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(targetElement,"stack"),targetStackData=targetStackToolDataSource.data[0],newImageIdIndex=sourceStackData.currentImageIdIndex;newImageIdIndex=Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_3__["default"])(newImageIdIndex,0,targetStackData.imageIds.length-1);if(newImageIdIndex===targetStackData.currentImageIdIndex){return}var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();if(startLoadingHandler){startLoadingHandler(targetElement)}var loader;if(!0===targetStackData.preventCache){loader=cornerstone.loadImage(targetStackData.imageIds[newImageIdIndex])}else{loader=cornerstone.loadAndCacheImage(targetStackData.imageIds[newImageIdIndex])}loader.then(function(image){var viewport=cornerstone.getViewport(targetElement);targetStackData.currentImageIdIndex=newImageIdIndex;synchronizer.displayImage(targetElement,image,viewport);if(endLoadingHandler){endLoadingHandler(targetElement,image)}},function(error){var imageId=targetStackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(targetElement,imageId,error)}})}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/convertToVector3.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement,eventData,positionDifference){if(targetElement===sourceElement){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,sourceStackData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(sourceElement,"stack").data[0],sourceImageId=sourceStackData.imageIds[sourceStackData.currentImageIdIndex],sourceImagePlane=cornerstone.metaData.get("imagePlaneModule",sourceImageId);if(void 0===sourceImagePlane||void 0===sourceImagePlane.imagePositionPatient){return}var sourceImagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(sourceImagePlane.imagePositionPatient),stackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(targetElement,"stack"),stackData=stackToolDataSource.data[0],minDistance=_NumberMAX_VALUE,newImageIdIndex=-1;if(!positionDifference){return}var finalPosition=sourceImagePosition.clone().add(positionDifference);stackData.imageIds.forEach(function(imageId,index){var imagePlane=cornerstone.metaData.get("imagePlaneModule",imageId);if(void 0===imagePlane||void 0===imagePlane.imagePositionPatient){return}var imagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(imagePlane.imagePositionPatient),distance=finalPosition.distanceToSquared(imagePosition);if(distance<minDistance){minDistance=distance;newImageIdIndex=index}});if(newImageIdIndex===stackData.currentImageIdIndex||-1===newImageIdIndex){return}var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();stackData.currentImageIdIndex=newImageIdIndex;var newImageId=stackData.imageIds[newImageIdIndex];if(startLoadingHandler){startLoadingHandler(targetElement)}var loader;if(!0===stackData.preventCache){loader=cornerstone.loadImage(newImageId)}else{loader=cornerstone.loadAndCacheImage(newImageId)}loader.then(function(image){var viewport=cornerstone.getViewport(targetElement);if(stackData.currentImageIdIndex!==newImageIdIndex){return}synchronizer.displayImage(targetElement,image,viewport);if(endLoadingHandler){endLoadingHandler(targetElement,image)}},function(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(targetElement,imageId,error)}})}},"./synchronization/stackImagePositionSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/convertToVector3.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement){if(targetElement===sourceElement){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,sourceStackData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(sourceElement,"stack").data[0],sourceImageId=sourceStackData.imageIds[sourceStackData.currentImageIdIndex],sourceImagePlane=cornerstone.metaData.get("imagePlaneModule",sourceImageId);if(void 0===sourceImagePlane||void 0===sourceImagePlane.imagePositionPatient){return}var sourceImagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(sourceImagePlane.imagePositionPatient),stackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(targetElement,"stack"),stackData=stackToolDataSource.data[0],minDistance=_NumberMAX_VALUE,newImageIdIndex=-1;stackData.imageIds.forEach(function(imageId,index){var imagePlane=cornerstone.metaData.get("imagePlaneModule",imageId);if(void 0===imagePlane||void 0===imagePlane.imagePositionPatient){return}var imagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(imagePlane.imagePositionPatient),distance=imagePosition.distanceToSquared(sourceImagePosition);if(distance<minDistance){minDistance=distance;newImageIdIndex=index}});if(newImageIdIndex===stackData.currentImageIdIndex){return}var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();stackData.currentImageIdIndex=newImageIdIndex;var newImageId=stackData.imageIds[newImageIdIndex];if(startLoadingHandler){startLoadingHandler(targetElement)}if(-1!==newImageIdIndex){var loader;if(!0===stackData.preventCache){loader=cornerstone.loadImage(newImageId)}else{loader=cornerstone.loadAndCacheImage(newImageId)}loader.then(function(image){var viewport=cornerstone.getViewport(targetElement);if(stackData.currentImageIdIndex!==newImageIdIndex){return}synchronizer.displayImage(targetElement,image,viewport);if(endLoadingHandler){endLoadingHandler(targetElement,image)}},function(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(targetElement,imageId,error)}})}}},"./synchronization/stackScrollSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/clip.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement,eventData){if(sourceElement===targetElement){return}if(!eventData||!eventData.direction){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,stackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(targetElement,"stack"),stackData=stackToolDataSource.data[0],newImageIdIndex=stackData.currentImageIdIndex+eventData.direction;newImageIdIndex=Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_3__["default"])(newImageIdIndex,0,stackData.imageIds.length-1);if(stackData.currentImageIdIndex===newImageIdIndex){return}var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].getErrorLoadingHandler();stackData.currentImageIdIndex=newImageIdIndex;var newImageId=stackData.imageIds[newImageIdIndex];if(startLoadingHandler){startLoadingHandler(targetElement)}var loader;if(!0===stackData.preventCache){loader=cornerstone.loadImage(newImageId)}else{loader=cornerstone.loadAndCacheImage(newImageId)}loader.then(function(image){var viewport=cornerstone.getViewport(targetElement);if(stackData.currentImageIdIndex!==newImageIdIndex){return}synchronizer.displayImage(targetElement,image,viewport);if(endLoadingHandler){endLoadingHandler(targetElement,image)}},function(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(targetElement,imageId,error)}})}},"./synchronization/updateImageSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement){if(targetElement===sourceElement){return}_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(targetElement)}},"./synchronization/wwwcSynchronizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(synchronizer,sourceElement,targetElement){if(targetElement===sourceElement){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,sourceViewport=cornerstone.getViewport(sourceElement),targetViewport=cornerstone.getViewport(targetElement);if(targetViewport.voi.windowWidth===sourceViewport.voi.windowWidth&&targetViewport.voi.windowCenter===sourceViewport.voi.windowCenter&&targetViewport.invert===sourceViewport.invert){return}targetViewport.voi.windowWidth=sourceViewport.voi.windowWidth;targetViewport.voi.windowCenter=sourceViewport.voi.windowCenter;targetViewport.invert=sourceViewport.invert;synchronizer.setViewport(targetElement,targetViewport)}},"./thirdParty/register.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),_registerModule_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./thirdParty/registerModule.js"),_registerMixin_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./thirdParty/registerMixin.js"),_registerItem_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./thirdParty/registerItem.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_4__.getLogger)("thirdParty:register");__webpack_exports__["default"]=function(type,name,item){var overwrite=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1;if(!isValidInput(type,name,item)){return}switch(type){case"module":Object(_registerModule_js__WEBPACK_IMPORTED_MODULE_1__["default"])(name,item,overwrite);break;case"mixin":Object(_registerMixin_js__WEBPACK_IMPORTED_MODULE_2__["default"])(name,item,overwrite);break;default:Object(_registerItem_js__WEBPACK_IMPORTED_MODULE_3__["default"])(type,name,item,overwrite);}};function isValidInput(type,name,item){if(!type){logger.warn("The type must be given in order to register.");return!1}if(!name){logger.warn("The %s must have a name in order to register.",type);return!1}if("object"!==_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(item)&&"function"!==typeof item){logger.warn("The %s is a %s, it should be an Object or a function.",item,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(item));return!1}return!0}},"./thirdParty/registerItem.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _lib_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./lib.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_1__.getLogger)("thirdParty:registerType");__webpack_exports__["default"]=function(type,name,item){var overwrite=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,itemKey="".concat(type,"/").concat(name),alreadyRegistered=isItemNameRegistered(itemKey);if(alreadyRegistered&&!overwrite){logger.warn("%s is already registered",itemKey);return}if(alreadyRegistered){logger.warn("Overwriting %s",itemKey)}_lib_js__WEBPACK_IMPORTED_MODULE_0__.lib[itemKey]=item};function isItemNameRegistered(itemKey){return void 0!==_lib_js__WEBPACK_IMPORTED_MODULE_0__.lib[itemKey]}},"./thirdParty/registerMixin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _lib_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./lib.js"),_mixins_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./mixins/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_2__.getLogger)("thirdParty:registerMixin");__webpack_exports__["default"]=function(name,mixin){var overwrite=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,alreadyRegistered=isMixinRegistered(name);if(alreadyRegistered&&!overwrite){logger.warn("mixins/%s is already registered",name);return}if(alreadyRegistered){logger.warn("Overwriting mixins/%s",name)}_mixins_index_js__WEBPACK_IMPORTED_MODULE_1__["default"][name]=mixin;_lib_js__WEBPACK_IMPORTED_MODULE_0__.lib["mixins/".concat(name)]=_mixins_index_js__WEBPACK_IMPORTED_MODULE_1__["default"][name]};function isMixinRegistered(name){return void 0!==_mixins_index_js__WEBPACK_IMPORTED_MODULE_1__["default"][name]}},"./thirdParty/registerModule.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_1__.getLogger)("thirdParty:registerModule");__webpack_exports__["default"]=function(name,newModule){var overwrite=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,alreadyRegistered=isModuleNameRegistered(name);if(alreadyRegistered&&!overwrite){logger.warn("A module with the name %s is already registered",name);return}if(alreadyRegistered){logger.warn("Overwriting module %s",name)}_store_index_js__WEBPACK_IMPORTED_MODULE_0__.modules[name]=newModule};function isModuleNameRegistered(name){return void 0!==_store_index_js__WEBPACK_IMPORTED_MODULE_0__.modules[name]}},"./thirdParty/registerSome.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _register_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./thirdParty/register.js");__webpack_exports__["default"]=function(items){var overwrite=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;items.forEach(function(_ref){var type=_ref.type,name=_ref.name,item=_ref.item;Object(_register_js__WEBPACK_IMPORTED_MODULE_0__["default"])(type,name,item,overwrite)})}},"./toolOptions.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"getToolOptions",function(){return getToolOptions});__webpack_require__.d(__webpack_exports__,"setToolOptions",function(){return setToolOptions});__webpack_require__.d(__webpack_exports__,"clearToolOptions",function(){return clearToolOptions});__webpack_require__.d(__webpack_exports__,"clearToolOptionsByToolType",function(){return clearToolOptionsByToolType});__webpack_require__.d(__webpack_exports__,"clearToolOptionsByElement",function(){return clearToolOptionsByElement});var elementToolOptions={};function getToolOptions(toolType,element){if(!elementToolOptions[toolType]){return{}}var toolOptions=elementToolOptions[toolType],optionsObject=toolOptions.find(function(toolOptionObject){return toolOptionObject.element===element});if(!optionsObject){return{}}return optionsObject.options}function setToolOptions(toolType,element,options){if(!elementToolOptions[toolType]){elementToolOptions[toolType]=[{element:element,options:options}];return}var toolOptions=elementToolOptions[toolType],index=toolOptions.findIndex(function(toolOptionObject){return toolOptionObject.element===element});if(-1===index){elementToolOptions[toolType].push({element:element,options:options})}else{var elementOptions=elementToolOptions[toolType][index].options||{};elementToolOptions[toolType][index].options=Object.assign(elementOptions,options)}}function clearToolOptions(toolType,element){var toolOptions=elementToolOptions[toolType];if(toolOptions){elementToolOptions[toolType]=toolOptions.filter(function(toolOptionObject){return toolOptionObject.element!==element})}}function clearToolOptionsByToolType(toolType){delete elementToolOptions[toolType]}function clearToolOptionsByElement(element){for(var toolType in elementToolOptions){elementToolOptions[toolType]=elementToolOptions[toolType].filter(function(toolOptionObject){return toolOptionObject.element!==element})}}},"./tools/CrosshairsTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return CrosshairsTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./externalModules.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./stateManagement/toolColors.js"),_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/pointProjector.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/convertToVector3.js"),_toolOptions_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./toolOptions.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/cursors/index.js"),CrosshairsTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(CrosshairsTool,_BaseTool);function CrosshairsTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,CrosshairsTool);var defaultConfig={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__.crosshairsCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(CrosshairsTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.mouseDownCallback=_this._chooseLocation.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseDragCallback=_this._chooseLocation.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchDragCallback=_this._chooseLocation.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(CrosshairsTool,[{key:"_chooseLocation",value:function _chooseLocation(evt){var eventData=evt.detail,element=eventData.element;evt.stopImmediatePropagation();var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_9__.getToolState)(element,this.name);if(!toolData){return}var sourceElement=element,sourceEnabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.getEnabledElement(sourceElement),sourceImageId=sourceEnabledElement.image.imageId,sourceImagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.metaData.get("imagePlaneModule",sourceImageId);if(!sourceImagePlane){return}var sourceImagePoint=eventData.currentPoints.image,patientPoint=Object(_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_11__.imagePointToPatientPoint)(sourceImagePoint,sourceImagePlane),syncContext=toolData.data[0].synchronizationContext,enabledElements=syncContext.getSourceElements();enabledElements.forEach(function(targetElement){if(targetElement===sourceElement){return}var minDistance=_NumberMAX_VALUE,newImageIdIndex=-1,stackToolDataSource=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_9__.getToolState)(targetElement,"stack");if(void 0===stackToolDataSource){return}var stackData=stackToolDataSource.data[0];stackData.imageIds.forEach(function(imageId,index){var imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.metaData.get("imagePlaneModule",imageId);if(!imagePlane||!imagePlane.imagePositionPatient||!imagePlane.rowCosines||!imagePlane.columnCosines){return}var imagePosition=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_12__["default"])(imagePlane.imagePositionPatient),row=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_12__["default"])(imagePlane.rowCosines),column=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_12__["default"])(imagePlane.columnCosines),normal=column.clone().cross(row.clone()),distance=_Mathabs(normal.clone().dot(imagePosition)-normal.clone().dot(patientPoint));if(distance<minDistance){minDistance=distance;newImageIdIndex=index}});if(newImageIdIndex===stackData.currentImageIdIndex){return}if(-1!==newImageIdIndex&&void 0!==stackData.imageIds[newImageIdIndex]){var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_8__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_8__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_8__["default"].getErrorLoadingHandler();if(startLoadingHandler){startLoadingHandler(targetElement)}var loader;if(!0===stackData.preventCache){loader=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.loadImage(stackData.imageIds[newImageIdIndex])}else{loader=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.loadAndCacheImage(stackData.imageIds[newImageIdIndex])}loader.then(function(image){var viewport=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.getViewport(targetElement);stackData.currentImageIdIndex=newImageIdIndex;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.displayImage(targetElement,image,viewport);if(endLoadingHandler){endLoadingHandler(targetElement,image)}},function(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(targetElement,imageId,error)}})}})}},{key:"activeCallback",value:function activeCallback(element,_ref){var mouseButtonMask=_ref.mouseButtonMask,synchronizationContext=_ref.synchronizationContext;Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_13__.setToolOptions)(this.name,element,{mouseButtonMask:mouseButtonMask});Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_9__.clearToolState)(element,this.name);Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_9__.addToolState)(element,this.name,{synchronizationContext:synchronizationContext})}}]);return CrosshairsTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/DoubleTapFitToWindowTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return DoubleTapFitToWindowTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),DoubleTapFitToWindowTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(DoubleTapFitToWindowTool,_BaseTool);function DoubleTapFitToWindowTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,DoubleTapFitToWindowTool);var defaultConfig={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(DoubleTapFitToWindowTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(DoubleTapFitToWindowTool,[{key:"doubleTapCallback",value:function doubleTapCallback(evt){var eventData=evt.detail;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.fitToWindow(eventData.element)}}]);return DoubleTapFitToWindowTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/DragProbeTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return DragProbeTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseTool.js"),_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/textStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./util/getRGBPixels.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/calculateSUV.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/index.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./drawing/drawTextBox.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/cursors/index.js"),DragProbeTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(DragProbeTool,_BaseTool);function DragProbeTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,DragProbeTool);var defaultConfig={name:"DragProbe",strategies:{default:defaultStrategy,minimal:minimalStrategy},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__.probeCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(DragProbeTool).call(this,initialConfiguration));_this.touchDragCallback=_this._movingEventCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchEndCallback=_this._endMovingEventCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseDragCallback=_this._movingEventCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseUpCallback=_this._endMovingEventCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.initialConfiguration=initialConfiguration;_this.dragEventData={};return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(DragProbeTool,[{key:"_movingEventCallback",value:function _movingEventCallback(evt){var eventData=evt.detail,element=eventData.element;this.dragEventData=eventData;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}},{key:"_endMovingEventCallback",value:function _endMovingEventCallback(evt){var eventData=evt.detail,element=eventData.element;this.dragEventData={};_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}},{key:"renderToolData",value:function renderToolData(evt){if(!this.dragEventData.currentPoints){return}if(evt&&evt.detail&&!!Object.keys(this.dragEventData.currentPoints).length){evt.detail.currentPoints=this.dragEventData.currentPoints;this.applyActiveStrategy(evt)}}}]);return DragProbeTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__["default"]),defaultStrategy=function defaultStrategy(evt,config){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone,eventData=evt.detail,element=eventData.element,image=eventData.image,currentPoints=eventData.currentPoints,canvasContext=eventData.canvasContext,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.getNewContext)(canvasContext.canvas),color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getActiveColor(),fontHeight=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize(),x=_Mathround(currentPoints.image.x),y=_Mathround(currentPoints.image.y);if(0>x||0>y||x>=image.columns||y>=image.rows){return}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.setShadow)(context,config);var text="".concat(x,", ").concat(y),storedPixels,str;if(image.color){storedPixels=Object(_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_10__["default"])(element,x,y,1,1);str="R: ".concat(storedPixels[0]," G: ").concat(storedPixels[1]," B: ").concat(storedPixels[2]," A: ").concat(storedPixels[3])}else{storedPixels=cornerstone.getStoredPixels(element,x,y,1,1);var sp=storedPixels[0],mo=sp*image.slope+image.intercept,suv=Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,sp);str="SP: ".concat(sp," MO: ").concat(parseFloat(mo.toFixed(3)));if(suv){str+=" SUV: ".concat(parseFloat(suv.toFixed(3)))}}var textCoords={x:currentPoints.canvas.x+5,y:currentPoints.canvas.y-5};Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__["default"])(context,str,textCoords.x,textCoords.y+fontHeight+5,color);Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__["default"])(context,text,textCoords.x,textCoords.y,color)})},minimalStrategy=function minimalStrategy(evt,config){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone,eventData=evt.detail,element=eventData.element,image=eventData.image,currentPoints=eventData.currentPoints,canvasContext=eventData.canvasContext,isTouchEvent=eventData.isTouchEvent,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.getNewContext)(canvasContext.canvas),color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getActiveColor(),pageCoordY=currentPoints.page.y-_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize()/2;if(isTouchEvent){pageCoordY=currentPoints.page.y-4*_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize()}var toolCoords=cornerstone.pageToPixel(element,currentPoints.page.x,pageCoordY);if(0>toolCoords.x||0>toolCoords.y||toolCoords.x>=image.columns||toolCoords.y>=image.rows){return}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.setShadow)(context,config);var seriesModule=cornerstone.metaData.get("generalSeriesModule",image.imageId),modality=seriesModule&&seriesModule.modality,storedPixels,text="";if(image.color){storedPixels=Object(_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_10__["default"])(element,toolCoords.x,toolCoords.y,1,1);text="R: ".concat(storedPixels[0]," G: ").concat(storedPixels[1]," B: ").concat(storedPixels[2])}else{storedPixels=cornerstone.getStoredPixels(element,toolCoords.x,toolCoords.y,1,1);var sp=storedPixels[0],mo=sp*image.slope+image.intercept,modalityPixelValueText=parseFloat(mo.toFixed(2));if("CT"===modality){text+="HU: ".concat(modalityPixelValueText)}else if("PT"===modality){text+=modalityPixelValueText;var suv=Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,sp);if(suv){text+=" SUV: ".concat(parseFloat(suv.toFixed(2)))}}else{text+=modalityPixelValueText}}var textCoords=cornerstone.pixelToCanvas(element,toolCoords),translation={x:12,y:-(_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize()+10)/2},handleRadius=6,padding=5,width=Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__.textBoxWidth)(context,text,padding);if(isTouchEvent){translation={x:-width/2,y:-_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize()-10-2*handleRadius}}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.drawCircle)(context,element,textCoords,handleRadius,{color:color},"canvas");Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__["default"])(context,text,textCoords.x+translation.x,textCoords.y+translation.y,color)})}},"./tools/EraserTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return EraserTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolState.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./store/index.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/cursors/index.js"),EraserTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(EraserTool,_BaseTool);function EraserTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,EraserTool);var defaultConfig={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__.eraserCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(EraserTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.preMouseDownCallback=_this._deleteAllNearbyTools.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.preTouchStartCallback=_this._deleteAllNearbyTools.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(EraserTool,[{key:"_deleteAllNearbyTools",value:function _deleteAllNearbyTools(evt){var coords=evt.detail.currentPoints.canvas,element=evt.detail.element;_store_index_js__WEBPACK_IMPORTED_MODULE_9__.state.tools.forEach(function(tool){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,tool.name);if(toolState){toolState.data.forEach(function(data){if("function"===typeof tool.pointNearTool&&tool.pointNearTool(element,data,coords)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.removeToolState)(element,tool.name,data);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}})}});var consumeEvent=!0;return consumeEvent}}]);return EraserTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__["default"])},"./tools/FreehandSculpterMouseTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return FreehandSculpterMouseTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_events_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./externalModules.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./drawing/drawHandles.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./store/index.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./stateManagement/toolState.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/clip.js"),_store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./store/getToolForElement.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/base/BaseTool.js"),_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./store/setToolCursor.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./tools/cursors/index.js"),_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./util/freehand/index.js"),FreehandHandleData=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_17__["default"].FreehandHandleData,FreehandSculpterMouseTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(FreehandSculpterMouseTool,_BaseTool);function FreehandSculpterMouseTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,FreehandSculpterMouseTool);var defaultConfig={name:"FreehandSculpterMouse",referencedToolName:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:getDefaultFreehandSculpterMouseToolConfiguration(),svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_16__.freehandSculpterMouseCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(FreehandSculpterMouseTool).call(this,initialConfiguration));_this.updateOnMouseMove=!0;_this.isMultiPartTool=!0;_this.initialConfiguration=initialConfiguration;_this.referencedToolName=initialConfiguration.referencedToolName;_this._active=!1;_this.activeMouseUpCallback=_this.activeMouseUpCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.activeTouchEndCallback=_this.activeTouchEndCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.activeMouseDragCallback=_this.activeMouseDragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(FreehandSculpterMouseTool,[{key:"renderToolData",value:function renderToolData(evt){var eventData=evt.detail;if(null===this.configuration.currentTool){return!1}var element=eventData.element,config=this.configuration,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolState.data[config.currentTool];if(!data){return!1}if(this._active){var context=eventData.canvasContext.canvas.getContext("2d"),options={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_9__["default"])(context,eventData,this.configuration.mouseLocation.handles,options)}else if(this.configuration.showCursorOnHover&&!this._recentTouchEnd){this._renderHoverCursor(evt)}}},{key:"doubleClickCallback",value:function doubleClickCallback(evt){var eventData=evt.detail;this._selectFreehandTool(eventData);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(eventData.element)}},{key:"doubleTapCallback",value:function doubleTapCallback(evt){var eventData=evt.detail;this._selectFreehandTool(eventData);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(eventData.element)}},{key:"preTouchStartCallback",value:function preTouchStartCallback(evt){this._initialiseSculpting(evt);return!0}},{key:"preMouseDownCallback",value:function preMouseDownCallback(evt){if(!this.options.mouseButtonMask.includes(evt.detail.buttons)){return}this._initialiseSculpting(evt);return!0}},{key:"activeMouseDragCallback",value:function activeMouseDragCallback(evt){var config=this.configuration;if(!this._active){return}var eventData=evt.detail,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(eventData.element,this.referencedToolName);if(!toolState){return}var points=toolState.data[config.currentTool].handles.points;this._getMouseLocation(eventData);this._sculpt(eventData,points);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(eventData.element)}},{key:"activeMouseUpCallback",value:function activeMouseUpCallback(evt){this._activeEnd(evt)}},{key:"activeTouchEndCallback",value:function activeTouchEndCallback(evt){this._activeEnd(evt);this._deselectAllTools(evt);this._recentTouchEnd=!0}},{key:"_activeEnd",value:function _activeEnd(evt){var eventData=evt.detail,element=eventData.element,config=this.configuration;this._active=!1;_store_index_js__WEBPACK_IMPORTED_MODULE_10__.state.isMultiPartToolActive=!1;this._getMouseLocation(eventData);this._invalidateToolData(eventData);config.mouseUpRender=!0;this._deactivateSculpt(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(eventData.element);preventPropagation(evt)}},{key:"_renderHoverCursor",value:function _renderHoverCursor(evt){var eventData=evt.detail,element=eventData.element,context=eventData.canvasContext.canvas.getContext("2d"),toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolState.data[this.configuration.currentTool];this._recentTouchEnd=!1;var coords;if(this.configuration.mouseUpRender){coords=this.configuration.mouseLocation.handles.start;this.configuration.mouseUpRender=!1}else{coords=_store_index_js__WEBPACK_IMPORTED_MODULE_10__.state.mousePositionImage}var freehandMouseTool=Object(_store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_13__["default"])(element,this.referencedToolName),radiusCanvas=freehandMouseTool.distanceFromPointCanvas(element,data,coords);this.configuration.mouseLocation.handles.start.x=coords.x;this.configuration.mouseLocation.handles.start.y=coords.y;if(this.configuration.limitRadiusOutsideRegion){var unlimitedRadius=radiusCanvas;radiusCanvas=this._limitCursorRadiusCanvas(eventData,radiusCanvas);if(unlimitedRadius>this.configuration.hoverCursorFadeDistance*radiusCanvas){context.globalAlpha=this.configuration.hoverCursorFadeAlpha}}var options={fill:null,color:this.configuration.hoverColor,handleRadius:radiusCanvas};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_9__["default"])(context,eventData,this.configuration.mouseLocation.handles,options);if(this.configuration.limitRadiusOutsideRegion){context.globalAlpha=1}}},{key:"newImageCallback",value:function newImageCallback(evt){this._deselectAllTools(evt)}},{key:"enabledCallback",value:function enabledCallback(evt){this._deselectAllTools(evt)}},{key:"passiveCallback",value:function passiveCallback(evt){this._deselectAllTools(evt)}},{key:"disabledCallback",value:function disabledCallback(evt){this._deselectAllTools(evt)}},{key:"_selectFreehandTool",value:function _selectFreehandTool(eventData){var config=this.configuration,element=eventData.element,closestToolIndex=this._getClosestFreehandToolOnElement(element,eventData);if(void 0===closestToolIndex){return}config.currentTool=closestToolIndex;Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_15__.hideToolCursor)(element)}},{key:"_activateFreehandTool",value:function _activateFreehandTool(element,toolIndex){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolState.data,config=this.configuration;config.currentTool=toolIndex;for(var i=0;i<data.length;i++){if(i===toolIndex){data[i].active=!0}else{data[i].active=!1}}}},{key:"_initialiseSculpting",value:function _initialiseSculpting(evt){var eventData=evt.detail,config=this.configuration,element=eventData.element;if(null===config.currentTool){this._selectFreehandTool(eventData);if(null===config.currentTool){return}}this._active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_10__.state.isMultiPartToolActive=!0;this._configureToolSize(eventData);this._getMouseLocation(eventData);this._activateFreehandTool(element,config.currentTool);this._activateSculpt(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(eventData.element)}},{key:"_sculpt",value:function _sculpt(eventData,points){var config=this.configuration;this._sculptData={element:eventData.element,image:eventData.image,mousePoint:eventData.currentPoints.image,points:points,toolSize:this._toolSizeImage,minSpacing:config.minSpacing,maxSpacing:_Mathmax(this._toolSizeImage,2*config.minSpacing)};var pushedHandles=this._pushHandles();if(void 0!==pushedHandles.first){this._insertNewHandles(pushedHandles);this._consolidateHandles()}}},{key:"_pushHandles",value:function _pushHandles(){for(var _this$_sculptData=this._sculptData,points=_this$_sculptData.points,mousePoint=_this$_sculptData.mousePoint,toolSize=_this$_sculptData.toolSize,pushedHandles={},i=0,distanceToHandle;i<points.length;i++){distanceToHandle=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.point.distance(points[i],mousePoint);if(distanceToHandle>toolSize){continue}this._pushOneHandle(i,distanceToHandle);if(void 0===pushedHandles.first){pushedHandles.first=i;pushedHandles.last=i}else{pushedHandles.last=i}}return pushedHandles}},{key:"_pushOneHandle",value:function _pushOneHandle(i,distanceToHandle){var _this$_sculptData2=this._sculptData,points=_this$_sculptData2.points,mousePoint=_this$_sculptData2.mousePoint,toolSize=_this$_sculptData2.toolSize,image=_this$_sculptData2.image,handle=points[i],directionUnitVector={x:(handle.x-mousePoint.x)/distanceToHandle,y:(handle.y-mousePoint.y)/distanceToHandle},position={x:mousePoint.x+toolSize*directionUnitVector.x,y:mousePoint.y+toolSize*directionUnitVector.y};Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_12__.clipToBox)(position,image);handle.x=position.x;handle.y=position.y;var lastHandleIndex=this.constructor._getPreviousHandleIndex(i,points.length);points[lastHandleIndex].lines.pop();points[lastHandleIndex].lines.push(handle)}},{key:"_insertNewHandles",value:function _insertNewHandles(pushedHandles){for(var indiciesToInsertAfter=this._findNewHandleIndicies(pushedHandles),newIndexModifier=0,i=0,insertIndex;i<indiciesToInsertAfter.length;i++){insertIndex=indiciesToInsertAfter[i]+1+newIndexModifier;this._insertHandleRadially(insertIndex);newIndexModifier++}}},{key:"_findNewHandleIndicies",value:function _findNewHandleIndicies(pushedHandles){for(var _this$_sculptData3=this._sculptData,points=_this$_sculptData3.points,maxSpacing=_this$_sculptData3.maxSpacing,indiciesToInsertAfter=[],i=pushedHandles.first;i<=pushedHandles.last;i++){this._checkSpacing(i,points,indiciesToInsertAfter,maxSpacing)}var pointAfterLast=this.constructor._getNextHandleIndex(pushedHandles.last,points.length);if(pointAfterLast!==pushedHandles.first){this._checkSpacing(pointAfterLast,points,indiciesToInsertAfter,maxSpacing);var pointBeforeFirst=this.constructor._getPreviousHandleIndex(pushedHandles.first,points.length);if(pointBeforeFirst!==pointAfterLast){this._checkSpacing(pointBeforeFirst,points,indiciesToInsertAfter,maxSpacing)}}return indiciesToInsertAfter}},{key:"_checkSpacing",value:function _checkSpacing(i,points,indiciesToInsertAfter,maxSpacing){var nextHandleIndex=this.constructor._getNextHandleIndex(i,points.length),distanceToNextHandle=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.point.distance(points[i],points[nextHandleIndex]);if(distanceToNextHandle>maxSpacing){indiciesToInsertAfter.push(i)}}},{key:"_insertHandleRadially",value:function _insertHandleRadially(insertIndex){var points=this._sculptData.points,previousIndex=insertIndex-1,nextIndex=this.constructor._getNextHandleIndexBeforeInsert(insertIndex,points.length),insertPosition=this._getInsertPosition(insertIndex,previousIndex,nextIndex),handleData=new FreehandHandleData(insertPosition);points.splice(insertIndex,0,handleData);points[previousIndex].lines.pop();points[previousIndex].lines.push(points[insertIndex]);_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_17__["default"].addLine(points,insertIndex)}},{key:"_consolidateHandles",value:function _consolidateHandles(){var points=this._sculptData.points;if(3>=points.length){return}var closePairs=this._findCloseHandlePairs();this._mergeCloseHandles(closePairs)}},{key:"_findCloseHandlePairs",value:function _findCloseHandlePairs(){for(var _this$_sculptData4=this._sculptData,points=_this$_sculptData4.points,minSpacing=_this$_sculptData4.minSpacing,closePairs=[],length=points.length,i=0;i<length;i++){var nextHandleIndex=this.constructor._getNextHandleIndex(i,points.length),distanceToNextHandle=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.point.distance(points[i],points[nextHandleIndex]);if(distanceToNextHandle<minSpacing){var pair=[i,nextHandleIndex];closePairs.push(pair);if(0===i){length-=1}i++}}return closePairs}},{key:"_mergeCloseHandles",value:function _mergeCloseHandles(closePairs){for(var removedIndexModifier=0,i=0,pair;i<closePairs.length;i++){pair=this.constructor._getCorrectedPair(closePairs[i],removedIndexModifier);this._combineHandles(pair);removedIndexModifier++}var newClosePairs=this._findCloseHandlePairs();if(newClosePairs.length){this._mergeCloseHandles(newClosePairs)}}},{key:"_combineHandles",value:function _combineHandles(handlePair){var _this$_sculptData5=this._sculptData,points=_this$_sculptData5.points,image=_this$_sculptData5.image,midPoint={x:(points[handlePair[0]].x+points[handlePair[1]].x)/2,y:(points[handlePair[0]].y+points[handlePair[1]].y)/2};Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_12__.clipToBox)(midPoint,image);points[handlePair[0]].x=midPoint.x;points[handlePair[0]].y=midPoint.y;var handleAfterPairIndex=this.constructor._getNextHandleIndex(handlePair[1],points.length);points[handlePair[0]].lines.pop();points[handlePair[0]].lines.push(points[handleAfterPairIndex]);points.splice(handlePair[1],1)}},{key:"_configureToolSize",value:function _configureToolSize(eventData){var element=eventData.element,config=this.configuration,toolIndex=config.currentTool,coords=eventData.currentPoints.image,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolState.data[toolIndex],freehandMouseTool=Object(_store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_13__["default"])(element,this.referencedToolName),radiusImage=freehandMouseTool.distanceFromPoint(element,data,coords),radiusCanvas=freehandMouseTool.distanceFromPointCanvas(element,data,coords);if(config.limitRadiusOutsideRegion){radiusImage=this._limitCursorRadiusImage(eventData,radiusImage);radiusCanvas=this._limitCursorRadiusCanvas(eventData,radiusCanvas)}this._toolSizeImage=radiusImage;this._toolSizeCanvas=radiusCanvas}},{key:"_getMouseLocation",value:function _getMouseLocation(eventData){var config=this.configuration;config.mouseLocation.handles.start.x=eventData.currentPoints.image.x;config.mouseLocation.handles.start.y=eventData.currentPoints.image.y;Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_12__.clipToBox)(config.mouseLocation.handles.start,eventData.image)}},{key:"_activateSculpt",value:function _activateSculpt(element){this._deactivateSculpt(element);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_UP,this.activeMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_CLICK,this.activeMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_DRAG,this.activeMouseDragCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_END,this.activeTouchEndCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_TAP,this.activeTouchEndCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_DRAG,this.activeMouseDragCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(element)}},{key:"_deactivateSculpt",value:function _deactivateSculpt(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_UP,this.activeMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_CLICK,this.activeMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].MOUSE_DRAG,this.activeMouseDragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_END,this.activeTouchEndCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_TAP,this.activeTouchEndCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_6__["default"].TOUCH_DRAG,this.activeMouseDragCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(element)}},{key:"_invalidateToolData",value:function _invalidateToolData(eventData){var config=this.configuration,element=eventData.element,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolData.data[config.currentTool];data.invalidated=!0}},{key:"_deselectAllTools",value:function _deselectAllTools(evt){var config=this.configuration,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(this.element,this.referencedToolName);config.currentTool=null;if(toolData){for(var i=0;i<toolData.data.length;i++){toolData.data[i].active=!1}}Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_15__.setToolCursor)(this.element,this.svgCursor);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function _limitCursorRadiusCanvas(eventData,radiusCanvas){return this._limitCursorRadius(eventData,radiusCanvas,!0)}},{key:"_limitCursorRadiusImage",value:function _limitCursorRadiusImage(eventData,radiusImage){return this._limitCursorRadius(eventData,radiusImage,!1)}},{key:"_limitCursorRadius",value:function _limitCursorRadius(eventData,radius){var canvasCoords=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,element=eventData.element,image=eventData.image,config=this.configuration,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName),data=toolState.data[config.currentTool],areaModifier=1;if(canvasCoords){var topLeft=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.pixelToCanvas(element,{x:0,y:0}),bottomRight=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.pixelToCanvas(element,{x:image.width,y:image.height}),canvasArea=(bottomRight.x-topLeft.x)*(bottomRight.y-topLeft.y);areaModifier=canvasArea/(image.width*image.height)}var area=data.area*areaModifier,maxRadius=_Mathpow(area/_MathPI,.5);return _Mathmin(radius,maxRadius)}},{key:"_getClosestFreehandToolOnElement",value:function _getClosestFreehandToolOnElement(element,eventData){var freehand=Object(_store_getToolForElement_js__WEBPACK_IMPORTED_MODULE_13__["default"])(element,this.referencedToolName),toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,this.referencedToolName);if(!toolState){return}for(var data=toolState.data,pixelCoords=eventData.currentPoints.image,closest={distance:1/0,toolIndex:null},i=0,distanceFromToolI;i<data.length;i++){distanceFromToolI=freehand.distanceFromPoint(element,data[i],pixelCoords);if(-1===distanceFromToolI){continue}if(distanceFromToolI<closest.distance){closest.distance=distanceFromToolI;closest.toolIndex=i}}return closest.toolIndex}},{key:"_getInsertPosition",value:function _getInsertPosition(insertIndex,previousIndex,nextIndex){var _this$_sculptData6=this._sculptData,points=_this$_sculptData6.points,toolSize=_this$_sculptData6.toolSize,mousePoint=_this$_sculptData6.mousePoint,image=_this$_sculptData6.image,midPoint={x:(points[previousIndex].x+points[nextIndex].x)/2,y:(points[previousIndex].y+points[nextIndex].y)/2},distanceToMidPoint=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.point.distance(mousePoint,midPoint),insertPosition;if(distanceToMidPoint<toolSize){var directionUnitVector={x:(midPoint.x-mousePoint.x)/distanceToMidPoint,y:(midPoint.y-mousePoint.y)/distanceToMidPoint};insertPosition={x:mousePoint.x+toolSize*directionUnitVector.x,y:mousePoint.y+toolSize*directionUnitVector.y}}else{insertPosition=midPoint}Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_12__.clipToBox)(insertPosition,image);return insertPosition}},{key:"minSpacing",get:function get(){return this.configuration.minSpacing},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.")}this.configuration.minSpacing=value}},{key:"maxSpacing",get:function get(){return this.configuration.maxSpacing},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.")}this.configuration.maxSpacing=value}},{key:"showCursorOnHover",get:function get(){return this.configuration.showCursorOnHover},set:function set(value){if("boolean"!==typeof value){throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.")}this.configuration.showCursorOnHover=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function get(){return this.configuration.limitRadiusOutsideRegion},set:function set(value){if("boolean"!==typeof value){throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.")}this.configuration.limitRadiusOutsideRegion=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function get(){return this.configuration.hoverCursorFadeAlpha},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.")}value=_Mathmax(_Mathmin(value,1),0);this.configuration.hoverCursorFadeAlpha=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function get(){return this.configuration.hoverCursorFadeDistance},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.")}value=_Mathmax(value,1);this.configuration.hoverCursorFadeDistance=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function _getCorrectedPair(pair,removedIndexModifier){var correctedPair=[pair[0]-removedIndexModifier,pair[1]-removedIndexModifier];if(0>correctedPair[1]){correctedPair[1]=0}return correctedPair}},{key:"_getNextHandleIndex",value:function _getNextHandleIndex(i,length){if(i===length-1){return 0}return i+1}},{key:"_getPreviousHandleIndex",value:function _getPreviousHandleIndex(i,length){if(0===i){return length-1}return i-1}},{key:"_getNextHandleIndexBeforeInsert",value:function _getNextHandleIndexBeforeInsert(insertIndex,length){if(insertIndex===length){return 0}return insertIndex}}]);return FreehandSculpterMouseTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_14__["default"]);function getDefaultFreehandSculpterMouseToolConfiguration(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_8__["default"].getActiveColor(),hoverColor:_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}function preventPropagation(evt){evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault()}},"./tools/MagnifyTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return MagnifyTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./drawing/index.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/base/BaseTool.js"),_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./store/setToolCursor.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/cursors/index.js"),MagnifyTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(MagnifyTool,_BaseTool);function MagnifyTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,MagnifyTool);var defaultConfig={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__.magnifyCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(MagnifyTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.zoomCanvas=void 0;_this.zoomElement=void 0;_this.activeCallback=_this._createMagnificationCanvas.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.enabledCallback=_this._createMagnificationCanvas.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.disabledCallback=_this._destroyMagnificationCanvas.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.postTouchStartCallback=_this._addMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchDragCallback=_this._updateMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchEndCallback=_this._removeMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchDragEndCallback=_this._removeMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.postMouseDownCallback=_this._addMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseDragCallback=_this._updateMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseUpCallback=_this._removeMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseClickCallback=_this._removeMagnifyingGlass.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.newImageCallback=_this._drawMagnificationTool.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(MagnifyTool,[{key:"_addMagnifyingGlass",value:function _addMagnifyingGlass(evt){var _this2=this;this._removeZoomElement();this._drawZoomedElement(evt);window.requestAnimationFrame(function(){return _this2._drawMagnificationTool(evt)});Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_9__.hideToolCursor)(evt.detail.element);evt.preventDefault();evt.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function _updateMagnifyingGlass(evt){this._drawMagnificationTool(evt);evt.preventDefault();evt.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function _removeMagnifyingGlass(evt){var element=evt.detail.element;Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_9__.setToolCursor)(this.element,this.svgCursor);element.querySelector(".magnifyTool").style.display="none";this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function _drawMagnificationTool(evt){var element=evt.detail.element,magnifyCanvas=element.querySelector(".magnifyTool");if(!magnifyCanvas){this._createMagnificationCanvas(element)}if(void 0===this.zoomCanvas){return}var canvas=element.querySelector("canvas:not(.magnifyTool)"),context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.getNewContext)(magnifyCanvas),canvasLocation=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.pixelToCanvas(evt.detail.element,evt.detail.currentPoints.image),magnifySize=_Mathmin(this.configuration.magnifySize,canvas.width,canvas.height),magnificationLevel=this.configuration.magnificationLevel;magnifyCanvas.width=magnifySize;magnifyCanvas.height=magnifySize;canvasLocation.x=_Mathmax(canvasLocation.x,.5*magnifySize/magnificationLevel);canvasLocation.x=_Mathmin(canvasLocation.x,canvas.width-.5*magnifySize/magnificationLevel);canvasLocation.y=_Mathmax(canvasLocation.y,.5*magnifySize/magnificationLevel);canvasLocation.y=_Mathmin(canvasLocation.y,canvas.height-.5*magnifySize/magnificationLevel);var copyFrom={x:canvasLocation.x*magnificationLevel-.5*magnifySize,y:canvasLocation.y*magnificationLevel-.5*magnifySize};copyFrom.x=_Mathmax(copyFrom.x,0);copyFrom.y=_Mathmax(copyFrom.y,0);context.drawImage(this.zoomCanvas,copyFrom.x,copyFrom.y,magnifySize,magnifySize,0,0,magnifySize,magnifySize);var touchOffset=evt.detail.isTouchEvent?120:0,magnifyPosition={top:_Mathmax(canvasLocation.y-.5*magnifySize-touchOffset,0),left:_Mathmax(canvasLocation.x-.5*magnifySize,0)},magnifierBox=magnifyCanvas.getBoundingClientRect();magnifyPosition.top=_Mathmin(magnifyPosition.top,canvas.height-magnifierBox.height);magnifyPosition.left=_Mathmin(magnifyPosition.left,canvas.width-magnifierBox.width);magnifyCanvas.style.top="".concat(magnifyPosition.top,"px");magnifyCanvas.style.left="".concat(magnifyPosition.left,"px");magnifyCanvas.style.display="block"}},{key:"_drawZoomedElement",value:function _drawZoomedElement(evt){var element=evt.detail.element,enabledElement=evt.detail.enabledElement;if(void 0===enabledElement){enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getEnabledElement(element)}var magnificationLevel=this.configuration.magnificationLevel,origCanvas=enabledElement.canvas,image=enabledElement.image;this.zoomElement=document.createElement("div");this.zoomElement.width=origCanvas.width*magnificationLevel;this.zoomElement.height=origCanvas.height*magnificationLevel;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.enable(this.zoomElement,enabledElement.options);var zoomEnabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getEnabledElement(this.zoomElement),viewport=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getViewport(enabledElement.element);this.zoomCanvas=zoomEnabledElement.canvas;this.zoomCanvas.width=origCanvas.width*magnificationLevel;this.zoomCanvas.height=origCanvas.height*magnificationLevel;zoomEnabledElement.viewport=Object.assign({},viewport);viewport.scale*=magnificationLevel;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.displayImage(this.zoomElement,image);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.setViewport(this.zoomElement,viewport)}},{key:"_removeZoomElement",value:function _removeZoomElement(){if(void 0!==this.zoomElement){_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.disable(this.zoomCanvas);this.zoomElement=void 0;this.zoomCanvas=void 0}}},{key:"_createMagnificationCanvas",value:function _createMagnificationCanvas(element){if(null===element.querySelector(".magnifyTool")){var magnifyCanvas=document.createElement("canvas");magnifyCanvas.classList.add("magnifyTool");magnifyCanvas.width=this.configuration.magnifySize;magnifyCanvas.height=this.configuration.magnifySize;magnifyCanvas.style.position="absolute";magnifyCanvas.style.display="none";element.appendChild(magnifyCanvas)}}},{key:"_destroyMagnificationCanvas",value:function _destroyMagnificationCanvas(evt){var element=evt.detail.element,magnifyCanvas=element.querySelector(".magnifyTool");if(magnifyCanvas){element.removeChild(magnifyCanvas)}}}]);return MagnifyTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__["default"])},"./tools/PanMultiTouchTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return PanMultiTouchTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseTool.js"),PanMultiTouchTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(PanMultiTouchTool,_BaseTool);function PanMultiTouchTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,PanMultiTouchTool);var defaultConfig={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(PanMultiTouchTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.multiTouchDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(PanMultiTouchTool,[{key:"_dragCallback",value:function _dragCallback(evt){var eventData=evt.detail,element=eventData.element,viewport=eventData.viewport;if(eventData.numPointers===this.configuration.touchPointers){var translation=this._getTranslation(eventData);this._applyTranslation(viewport,translation);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.setViewport(element,viewport)}}},{key:"_getTranslation",value:function _getTranslation(eventData){var viewport=eventData.viewport,image=eventData.image,deltaPoints=eventData.deltaPoints,widthScale=viewport.scale,heightScale=viewport.scale;if(image.rowPixelSpacing<image.columnPixelSpacing){widthScale*=image.columnPixelSpacing/image.rowPixelSpacing}else if(image.columnPixelSpacing<image.rowPixelSpacing){heightScale*=image.rowPixelSpacing/image.columnPixelSpacing}return{x:deltaPoints.page.x/widthScale,y:deltaPoints.page.y/heightScale}}},{key:"_applyTranslation",value:function _applyTranslation(viewport,translation){viewport.translation.x+=translation.x;viewport.translation.y+=translation.y}}]);return PanMultiTouchTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__["default"])},"./tools/PanTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return PanTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseTool.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/cursors/index.js"),PanTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(PanTool,_BaseTool);function PanTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,PanTool);var defaultConfig={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_8__.panCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(PanTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.touchDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(PanTool,[{key:"_dragCallback",value:function _dragCallback(evt){var eventData=evt.detail,element=eventData.element,viewport=eventData.viewport,translation=this._getTranslation(eventData);this._applyTranslation(viewport,translation);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.setViewport(element,viewport)}},{key:"_getTranslation",value:function _getTranslation(eventData){var viewport=eventData.viewport,image=eventData.image,deltaPoints=eventData.deltaPoints,widthScale=viewport.scale,heightScale=viewport.scale;if(image.rowPixelSpacing<image.columnPixelSpacing){widthScale*=image.columnPixelSpacing/image.rowPixelSpacing}else if(image.columnPixelSpacing<image.rowPixelSpacing){heightScale*=image.rowPixelSpacing/image.columnPixelSpacing}return{x:deltaPoints.page.x/widthScale,y:deltaPoints.page.y/heightScale}}},{key:"_applyTranslation",value:function _applyTranslation(viewport,translation){viewport.translation.x+=translation.x;viewport.translation.y+=translation.y}}]);return PanTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__["default"])},"./tools/ReferenceLinesTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ReferenceLinesTool});var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/regenerator/index.js"),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__),_externalModules_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/base/BaseTool.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./drawing/index.js"),_referenceLines_renderActiveReferenceLine_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/referenceLines/renderActiveReferenceLine.js"),_util_wait_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/wait.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_12__.getLogger)("tools:ReferenceLinesTool"),ReferenceLinesTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default()(ReferenceLinesTool,_BaseTool);function ReferenceLinesTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this,ReferenceLinesTool);var defaultConfig={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:_referenceLines_renderActiveReferenceLine_js__WEBPACK_IMPORTED_MODULE_10__["default"]}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(ReferenceLinesTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.renderer=null;_this.synchronizationContext=null;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(ReferenceLinesTool,[{key:"enabledCallback",value:function(){var _enabledCallback=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(element){var _ref,synchronizationContext,renderer,enabledElement,_args=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref=1<_args.length&&void 0!==_args[1]?_args[1]:{},synchronizationContext=_ref.synchronizationContext;renderer=this.configuration.renderer;_context.next=4;return Object(_util_wait_js__WEBPACK_IMPORTED_MODULE_11__.waitForEnabledElementImageToLoad)(element);case 4:enabledElement=_context.sent;if(!(!enabledElement||!renderer||!synchronizationContext)){_context.next=8;break}logger.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render."));return _context.abrupt("return");case 8:this.renderer=renderer;this.synchronizationContext=synchronizationContext;this.forceImageUpdate(element);case 11:case"end":return _context.stop();}}},_callee,this)}));function enabledCallback(_x){return _enabledCallback.apply(this,arguments)}return enabledCallback}()},{key:"disabledCallback",value:function disabledCallback(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function forceImageUpdate(element){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.getEnabledElement(element);if(enabledElement.image){_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(element)}}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail;if(!this.renderer||!this.synchronizationContext){return}var enabledElements=this.synchronizationContext.getSourceElements(),context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_9__.getNewContext)(eventData.canvasContext.canvas);_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.setToPixelCoordinateSystem(eventData.enabledElement,context);enabledElements.forEach(function(referenceEnabledElement){if(referenceEnabledElement===evt.currentTarget){return}_this2.renderer(context,eventData,evt.currentTarget,referenceEnabledElement)})}}]);return ReferenceLinesTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__["default"])},"./tools/RotateTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return RotateTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_angleBetweenPoints_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/angleBetweenPoints.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/cursors/index.js"),RotateTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(RotateTool,_BaseTool);function RotateTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,RotateTool);var defaultConfig={name:"Rotate",strategies:{default:defaultStrategy,horizontal:horizontalStrategy,vertical:verticalStrategy},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_8__.rotateCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(RotateTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(RotateTool,[{key:"touchDragCallback",value:function touchDragCallback(evt){this.dragCallback(evt)}},{key:"mouseDragCallback",value:function mouseDragCallback(evt){this.dragCallback(evt)}},{key:"postMouseDownCallback",value:function postMouseDownCallback(evt){this.initialRotation=evt.detail.viewport.rotation}},{key:"dragCallback",value:function dragCallback(evt){evt.detail.viewport.initialRotation=this.initialRotation;this.applyActiveStrategy(evt,this.configuration);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(evt.detail.element,evt.detail.viewport)}}]);return RotateTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),defaultStrategy=function defaultStrategy(evt){var eventData=evt.detail,element=eventData.element,viewport=eventData.viewport,initialRotation=viewport.initialRotation,rect=element.getBoundingClientRect(element),width=element.clientWidth,height=element.clientHeight,initialPoints={x:eventData.startPoints.client.x,y:eventData.startPoints.client.y},scale=viewport.scale,translation=viewport.translation,centerPoints={x:rect.left+width/2+translation.x*scale,y:rect.top+height/2+translation.y*scale},currentPoints={x:eventData.currentPoints.client.x,y:eventData.currentPoints.client.y},angleInfo=Object(_util_angleBetweenPoints_js__WEBPACK_IMPORTED_MODULE_7__["default"])(centerPoints,initialPoints,currentPoints);if(0>angleInfo.direction){angleInfo.angle=-angleInfo.angle}viewport.rotation=initialRotation+angleInfo.angle},horizontalStrategy=function horizontalStrategy(evt){var eventData=evt.detail,viewport=eventData.viewport,deltaPoints=eventData.deltaPoints;viewport.rotation+=deltaPoints.page.x/viewport.scale},verticalStrategy=function verticalStrategy(evt){var eventData=evt.detail,viewport=eventData.viewport,deltaPoints=eventData.deltaPoints;viewport.rotation+=deltaPoints.page.y/viewport.scale}},"./tools/RotateTouchTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return RotateTouchTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),RotateTouchTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(RotateTouchTool,_BaseTool);function RotateTouchTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,RotateTouchTool);var defaultConfig={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(RotateTouchTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(RotateTouchTool,[{key:"touchRotateCallback",value:function touchRotateCallback(evt){var eventData=evt.detail,element=eventData.element,viewport=eventData.viewport,rotation=eventData.rotation;viewport.rotation+=rotation;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(element,viewport)}}]);return RotateTouchTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/ScaleOverlayTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ScaleOverlayTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./drawing/index.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_10__.getLogger)("tools:ScaleOverlayTool"),ScaleOverlayTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ScaleOverlayTool,_BaseTool);function ScaleOverlayTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ScaleOverlayTool);var defaultConfig={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ScaleOverlayTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ScaleOverlayTool,[{key:"enabledCallback",value:function enabledCallback(element){this.forceImageUpdate(element)}},{key:"disabledCallback",value:function disabledCallback(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function forceImageUpdate(element){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.getEnabledElement(element);if(enabledElement.image){_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element)}}},{key:"renderToolData",value:function renderToolData(evt){var eventData=evt.detail,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.getNewContext)(eventData.canvasContext.canvas),image=eventData.image,viewport=eventData.viewport,element=eventData.element,rowPixelSpacing=image.rowPixelSpacing,colPixelSpacing=image.columnPixelSpacing,imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId);if(imagePlane){rowPixelSpacing=imagePlane.rowPixelSpacing||imagePlane.rowImagePixelSpacing;colPixelSpacing=imagePlane.columnPixelSpacing||imagePlane.colImagePixelSpacing}if(!rowPixelSpacing||!colPixelSpacing){logger.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"));return}var canvasSize={width:context.canvas.width,height:context.canvas.height},verticalIntervalScale=10/rowPixelSpacing*viewport.scale,horizontalIntervalScale=10/colPixelSpacing*viewport.scale,hscaleBounds=computeScaleBounds(canvasSize,.25,.05),vscaleBounds=computeScaleBounds(canvasSize,.05,.15);if(!canvasSize.width||!canvasSize.height||!hscaleBounds||!vscaleBounds){return}var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getToolColor(),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolWidth(),imageAttributes=Object.assign({},{hscaleBounds:hscaleBounds,vscaleBounds:vscaleBounds,verticalMinorTick:verticalIntervalScale,horizontalMinorTick:horizontalIntervalScale,verticalLine:{start:{x:vscaleBounds.bottomRight.x,y:vscaleBounds.topLeft.y},end:{x:vscaleBounds.bottomRight.x,y:vscaleBounds.bottomRight.y}},horizontalLine:{start:{x:hscaleBounds.topLeft.x,y:hscaleBounds.bottomRight.y},end:{x:hscaleBounds.bottomRight.x,y:hscaleBounds.bottomRight.y}},color:color,lineWidth:lineWidth},this.configuration);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.setShadow)(context,imageAttributes);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLine)(context,element,imageAttributes.verticalLine.start,imageAttributes.verticalLine.end,{color:color,lineWidth:lineWidth},"canvas");drawVerticalScalebarIntervals(context,element,imageAttributes);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLine)(context,element,imageAttributes.horizontalLine.start,imageAttributes.horizontalLine.end,{color:color,lineWidth:lineWidth},"canvas");drawHorizontalScalebarIntervals(context,element,imageAttributes)})}}]);return ScaleOverlayTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),computeScaleBounds=function computeScaleBounds(canvasSize,horizontalReduction,verticalReduction){var hReduction=horizontalReduction*_Mathmin(1e3,canvasSize.width),vReduction=verticalReduction*_Mathmin(1e3,canvasSize.height),canvasBounds={left:hReduction,top:vReduction,width:canvasSize.width-2*hReduction,height:canvasSize.height-2*vReduction};return{topLeft:{x:canvasBounds.left,y:canvasBounds.top},bottomRight:{x:canvasBounds.left+canvasBounds.width,y:canvasBounds.top+canvasBounds.height}}},drawVerticalScalebarIntervals=function drawVerticalScalebarIntervals(context,element,imageAttributes){var i=0;while(imageAttributes.verticalLine.start.y+i*imageAttributes.verticalMinorTick<=imageAttributes.vscaleBounds.bottomRight.y){var color=imageAttributes.color,lineWidth=imageAttributes.lineWidth,startPoint={x:imageAttributes.verticalLine.start.x,y:imageAttributes.verticalLine.start.y+i*imageAttributes.verticalMinorTick},endPoint={x:0,y:imageAttributes.verticalLine.start.y+i*imageAttributes.verticalMinorTick};if(0===i%5){endPoint.x=imageAttributes.verticalLine.start.x-imageAttributes.majorTickLength}else{endPoint.x=imageAttributes.verticalLine.start.x-imageAttributes.minorTickLength}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLine)(context,element,startPoint,endPoint,{color:color,lineWidth:lineWidth},"canvas");i++}},drawHorizontalScalebarIntervals=function drawHorizontalScalebarIntervals(context,element,imageAttributes){var i=0;while(imageAttributes.horizontalLine.start.x+i*imageAttributes.horizontalMinorTick<=imageAttributes.hscaleBounds.bottomRight.x){var color=imageAttributes.color,lineWidth=imageAttributes.lineWidth,startPoint={x:imageAttributes.horizontalLine.start.x+i*imageAttributes.horizontalMinorTick,y:imageAttributes.horizontalLine.start.y},endPoint={x:imageAttributes.horizontalLine.start.x+i*imageAttributes.horizontalMinorTick,y:0};if(0===i%5){endPoint.y=imageAttributes.horizontalLine.start.y-imageAttributes.majorTickLength}else{endPoint.y=imageAttributes.horizontalLine.start.y-imageAttributes.minorTickLength}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_7__.drawLine)(context,element,startPoint,endPoint,{color:color,lineWidth:lineWidth},"canvas");i++}}},"./tools/StackScrollMouseWheelTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return StackScrollMouseWheelTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./tools/base/BaseTool.js"),_util_scroll_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./util/scroll.js"),StackScrollMouseWheelTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(StackScrollMouseWheelTool,_BaseTool);function StackScrollMouseWheelTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,StackScrollMouseWheelTool);var defaultConfig={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(StackScrollMouseWheelTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(StackScrollMouseWheelTool,[{key:"mouseWheelCallback",value:function mouseWheelCallback(evt){var _evt$detail=evt.detail,images=_evt$detail.direction,element=_evt$detail.element,_this$configuration=this.configuration,loop=_this$configuration.loop,allowSkipping=_this$configuration.allowSkipping,invert=_this$configuration.invert,direction=invert?-images:images;Object(_util_scroll_js__WEBPACK_IMPORTED_MODULE_6__["default"])(element,direction,loop,allowSkipping)}}]);return StackScrollMouseWheelTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_5__["default"])},"./tools/StackScrollMultiTouchTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return StackScrollMultiTouchTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_scroll_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/scroll.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolState.js"),_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./toolOptions.js"),StackScrollMultiTouchTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(StackScrollMultiTouchTool,_BaseTool);function StackScrollMultiTouchTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,StackScrollMultiTouchTool);var defaultConfig={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(StackScrollMultiTouchTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.multiTouchDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(StackScrollMultiTouchTool,[{key:"_dragCallback",value:function _dragCallback(evt){var eventData=evt.detail;if(eventData.numPointers===this.configuration.touchPointers){var element=eventData.element,deltaPoints=eventData.deltaPoints,_this$configuration=this.configuration,loop=_this$configuration.loop,allowSkipping=_this$configuration.allowSkipping,options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.getToolOptions)(this.name,element),pixelsPerImage=this._getPixelPerImage(element),deltaY=this._getDeltaY(element,deltaPoints.page.y);if(!pixelsPerImage){return}if(_Mathabs(deltaY)>=pixelsPerImage){var imageIdIndexOffset=_Mathround(deltaY/pixelsPerImage);Object(_util_scroll_js__WEBPACK_IMPORTED_MODULE_7__["default"])(element,imageIdIndexOffset,loop,allowSkipping);options.deltaY=deltaY%pixelsPerImage}else{options.deltaY=deltaY}Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.setToolOptions)(this.name,element,options)}}},{key:"_getDeltaY",value:function _getDeltaY(element,deltaPointsY){var options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.getToolOptions)(this.name,element),deltaY=options.deltaY||0;return deltaY+deltaPointsY}},{key:"_getPixelPerImage",value:function _getPixelPerImage(element){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,"stack");if(!toolData||!toolData.data||!toolData.data.length){return}var stackData=toolData.data[0],stackScrollSpeed=this.configuration.stackScrollSpeed;return stackScrollSpeed||_Mathmax(2,element.offsetHeight/_Mathmax(stackData.imageIds.length,8))}}]);return StackScrollMultiTouchTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/StackScrollTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return StackScrollTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_scroll_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/scroll.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolState.js"),_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./toolOptions.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/cursors/index.js"),StackScrollTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(StackScrollTool,_BaseTool);function StackScrollTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,StackScrollTool);var defaultConfig={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_10__.stackScrollCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(StackScrollTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.mouseDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchDragCallback=_this._dragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(StackScrollTool,[{key:"_dragCallback",value:function _dragCallback(evt){var eventData=evt.detail,element=eventData.element,deltaPoints=eventData.deltaPoints,_this$configuration=this.configuration,loop=_this$configuration.loop,allowSkipping=_this$configuration.allowSkipping,options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.getToolOptions)(this.name,element),pixelsPerImage=this._getPixelPerImage(element),deltaY=this._getDeltaY(element,deltaPoints.page.y);if(!pixelsPerImage){return}if(_Mathabs(deltaY)>=pixelsPerImage){var imageIdIndexOffset=_Mathround(deltaY/pixelsPerImage);Object(_util_scroll_js__WEBPACK_IMPORTED_MODULE_7__["default"])(element,imageIdIndexOffset,loop,allowSkipping);options.deltaY=deltaY%pixelsPerImage}else{options.deltaY=deltaY}Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.setToolOptions)(this.name,element,options)}},{key:"_getDeltaY",value:function _getDeltaY(element,deltaPointsY){var options=Object(_toolOptions_js__WEBPACK_IMPORTED_MODULE_9__.getToolOptions)(this.name,element),deltaY=options.deltaY||0;return deltaY+deltaPointsY}},{key:"_getPixelPerImage",value:function _getPixelPerImage(element){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,"stack");if(!toolData||!toolData.data||!toolData.data.length){return}var stackData=toolData.data[0],stackScrollSpeed=this.configuration.stackScrollSpeed;return stackScrollSpeed||_Mathmax(2,element.offsetHeight/_Mathmax(stackData.imageIds.length,8))}}]);return StackScrollTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/WwwcRegionTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return WwwcRegionTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseTool.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./drawing/index.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./util/clip.js"),_util_getLuminance_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./util/getLuminance.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./stateManagement/toolColors.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./tools/cursors/index.js"),WwwcRegionTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(WwwcRegionTool,_BaseTool);function WwwcRegionTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,WwwcRegionTool);var defaultConfig={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_12__.wwwcRegionCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(WwwcRegionTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this._resetHandles();_this.postTouchStartCallback=_this._startOutliningRegion.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchDragCallback=_this._setHandlesAndUpdate.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.touchEndCallback=_this._applyStrategy.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.postMouseDownCallback=_this._startOutliningRegion.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseClickCallback=_this._startOutliningRegion.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseDragCallback=_this._setHandlesAndUpdate.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseMoveCallback=_this._setHandlesAndUpdate.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.mouseUpCallback=_this._applyStrategy.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(WwwcRegionTool,[{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail,element=eventData.element,color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_11__["default"].getColorIfActive({active:!0}),context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.getNewContext)(eventData.canvasContext.canvas);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.drawRect)(context,element,_this2.handles.start,_this2.handles.end,{color:color})})}},{key:"_startOutliningRegion",value:function _startOutliningRegion(evt){var consumeEvent=!0,element=evt.detail.element,image=evt.detail.currentPoints.image;if(_isEmptyObject(this.handles.start)){this.handles.start=image}else{this.handles.end=image;this._applyStrategy(evt)}_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element);return consumeEvent}},{key:"_setHandlesAndUpdate",value:function _setHandlesAndUpdate(evt){var element=evt.detail.element,image=evt.detail.currentPoints.image;this.handles.end=image;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}},{key:"_applyStrategy",value:function _applyStrategy(evt){if(_isEmptyObject(this.handles.start)||_isEmptyObject(this.handles.end)){return}evt.detail.handles=this.handles;_applyWWWCRegion(evt,this.configuration);this._resetHandles()}},{key:"_resetHandles",value:function _resetHandles(){this.handles={start:{},end:{}}}}]);return WwwcRegionTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_7__["default"]),_isEmptyObject=function _isEmptyObject(obj){return 0===Object.keys(obj).length&&obj.constructor===Object},_applyWWWCRegion=function _applyWWWCRegion(evt,config){var eventData=evt.detail,image=eventData.image,element=eventData.element,_evt$detail$handles=evt.detail.handles,startPoint=_evt$detail$handles.start,endPoint=_evt$detail$handles.end,left=_Mathmin(startPoint.x,endPoint.x),top=_Mathmin(startPoint.y,endPoint.y),width=_Mathabs(startPoint.x-endPoint.x),height=_Mathabs(startPoint.y-endPoint.y);left=Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_9__["default"])(left,0,image.width);top=Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_9__["default"])(top,0,image.height);width=_Mathfloor(_Mathmin(width,_Mathabs(image.width-left)));height=_Mathfloor(_Mathmin(height,_Mathabs(image.height-top)));var pixelLuminanceData=Object(_util_getLuminance_js__WEBPACK_IMPORTED_MODULE_10__["default"])(element,left,top,width,height),minMaxMean=_calculateMinMaxMean(pixelLuminanceData,image.minPixelValue,image.maxPixelValue),viewport=eventData.viewport;if(void 0===config.minWindowWidth){config.minWindowWidth=10}viewport.voi.windowWidth=_Mathmax(_Mathabs(minMaxMean.max-minMaxMean.min),config.minWindowWidth);viewport.voi.windowCenter=minMaxMean.mean;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.setViewport(element,viewport);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)},_calculateMinMaxMean=function _calculateMinMaxMean(pixelLuminance,globalMin,globalMax){var numPixels=pixelLuminance.length,min=globalMax,max=globalMin,sum=0;if(2>numPixels){return{min:min,max:max,mean:(globalMin+globalMax)/2}}for(var index=0,spv;index<numPixels;index++){spv=pixelLuminance[index];min=_Mathmin(min,spv);max=_Mathmax(max,spv);sum+=spv}return{min:min,max:max,mean:sum/numPixels}}},"./tools/WwwcTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return WwwcTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/cursors/index.js"),WwwcTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(WwwcTool,_BaseTool);function WwwcTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,WwwcTool);var defaultConfig={name:"Wwwc",strategies:{basicLevelingStrategy:basicLevelingStrategy},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_7__.wwwcCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(WwwcTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(WwwcTool,[{key:"mouseDragCallback",value:function mouseDragCallback(evt){this.applyActiveStrategy(evt);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(evt.detail.element,evt.detail.viewport)}},{key:"touchDragCallback",value:function touchDragCallback(evt){evt.stopImmediatePropagation();this.applyActiveStrategy(evt);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(evt.detail.element,evt.detail.viewport)}}]);return WwwcTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]);function basicLevelingStrategy(evt,_ref){var orientation=_ref.orientation,eventData=evt.detail,maxVOI=eventData.image.maxPixelValue*eventData.image.slope+eventData.image.intercept,minVOI=eventData.image.minPixelValue*eventData.image.slope+eventData.image.intercept,imageDynamicRange=maxVOI-minVOI,multiplier=imageDynamicRange/1024,deltaX=eventData.deltaPoints.page.x*multiplier,deltaY=eventData.deltaPoints.page.y*multiplier;if(0===orientation){eventData.viewport.voi.windowWidth+=deltaX;eventData.viewport.voi.windowCenter+=deltaY}else{eventData.viewport.voi.windowWidth+=deltaY;eventData.viewport.voi.windowCenter+=deltaX}}},"./tools/ZoomMouseWheelTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ZoomMouseWheelTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/zoom/index.js"),ZoomMouseWheelTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ZoomMouseWheelTool,_BaseTool);function ZoomMouseWheelTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ZoomMouseWheelTool);var defaultConfig={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ZoomMouseWheelTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ZoomMouseWheelTool,[{key:"mouseWheelCallback",value:function mouseWheelCallback(evt){var _evt$detail=evt.detail,element=_evt$detail.element,viewport=_evt$detail.viewport,spinY=_evt$detail.spinY,_this$configuration=this.configuration,invert=_this$configuration.invert,maxScale=_this$configuration.maxScale,minScale=_this$configuration.minScale,ticks=invert?spinY/4:-spinY/4,updatedViewport=Object(_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_7__.changeViewportScale)(viewport,ticks,{maxScale:maxScale,minScale:minScale});_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(element,updatedViewport)}}]);return ZoomMouseWheelTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/ZoomTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ZoomTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/clip.js"),_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./util/zoom/index.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/cursors/index.js"),correctShift=_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_8__["default"].correctShift,changeViewportScale=_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_8__["default"].changeViewportScale,ZoomTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ZoomTool,_BaseTool);function ZoomTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ZoomTool);var defaultConfig={name:"Zoom",strategies:{default:defaultStrategy,translate:translateStrategy,zoomToCenter:zoomToCenterStrategy},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_9__.zoomCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ZoomTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ZoomTool,[{key:"touchDragCallback",value:function touchDragCallback(evt){dragCallback.call(this,evt)}},{key:"mouseDragCallback",value:function mouseDragCallback(evt){dragCallback.call(this,evt)}}]);return ZoomTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),dragCallback=function dragCallback(evt){var deltaY=evt.detail.deltaPoints.page.y;if(!deltaY){return!1}this.applyActiveStrategy(evt,this.configuration);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(evt.detail.element,evt.detail.viewport)};function defaultStrategy(evt,_ref){var invert=_ref.invert,maxScale=_ref.maxScale,minScale=_ref.minScale,deltaY=evt.detail.deltaPoints.page.y,ticks=invert?-deltaY/100:deltaY/100,_evt$detail=evt.detail,element=_evt$detail.element,viewport=_evt$detail.viewport,_ref2=[evt.detail.startPoints.page.x,evt.detail.startPoints.page.y,evt.detail.startPoints.image.x,evt.detail.startPoints.image.y],startX=_ref2[0],startY=_ref2[1],imageX=_ref2[2],imageY=_ref2[3],updatedViewport=changeViewportScale(viewport,ticks,{maxScale:maxScale,minScale:minScale});_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(element,updatedViewport);var newCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pageToPixel(element,startX,startY),shift={x:imageX-newCoords.x,y:imageY-newCoords.y};shift=correctShift(shift,updatedViewport);viewport.translation.x-=shift.x;viewport.translation.y-=shift.y}function translateStrategy(evt,_ref3){var invert=_ref3.invert,preventZoomOutsideImage=_ref3.preventZoomOutsideImage,maxScale=_ref3.maxScale,minScale=_ref3.minScale,deltaY=evt.detail.deltaPoints.page.y,ticks=invert?-deltaY/100:deltaY/100,image=evt.detail.image,viewport=evt.detail.viewport,_ref4=[evt.detail.startPoints.image.x,evt.detail.startPoints.image.y],startX=_ref4[0],startY=_ref4[1],updatedViewport=changeViewportScale(viewport,ticks,{maxScale:maxScale,minScale:minScale}),shift={x:0,y:0},translateSpeed=8,outwardsMinScaleToTranslate=3,minTranslation=.01;if(0>ticks){if(updatedViewport.scale<outwardsMinScaleToTranslate){if(_Mathabs(updatedViewport.translation.x)<minTranslation){updatedViewport.translation.x=0}else{shift.x=updatedViewport.translation.x/translateSpeed}if(_Mathabs(updatedViewport.translation.y)<minTranslation){updatedViewport.translation.y=0}else{shift.y=updatedViewport.translation.y/translateSpeed}}}else{if(preventZoomOutsideImage){Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_7__.clipToBox)(evt.detail.startPoints.image,image)}var desiredTranslation={x:image.width/2-startX,y:image.height/2-startY};desiredTranslation=correctShift(desiredTranslation,updatedViewport);var distanceToDesired={x:updatedViewport.translation.x-desiredTranslation.x,y:updatedViewport.translation.y-desiredTranslation.y};if(_Mathabs(distanceToDesired.x)<minTranslation){updatedViewport.translation.x=desiredTranslation.x}else{shift.x=distanceToDesired.x/translateSpeed}if(_Mathabs(distanceToDesired.y)<minTranslation){updatedViewport.translation.y=desiredTranslation.y}else{shift.y=distanceToDesired.y/translateSpeed}}updatedViewport.translation.x-=shift.x;updatedViewport.translation.y-=shift.y}function zoomToCenterStrategy(evt,_ref5){var invert=_ref5.invert,maxScale=_ref5.maxScale,minScale=_ref5.minScale,deltaY=evt.detail.deltaPoints.page.y,ticks=invert?-deltaY/100:deltaY/100,viewport=evt.detail.viewport;changeViewportScale(viewport,ticks,{maxScale:maxScale,minScale:minScale})}},"./tools/ZoomTouchPinchTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ZoomTouchPinchTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseTool.js"),_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/zoom/index.js"),correctShift=_util_zoom_index_js__WEBPACK_IMPORTED_MODULE_7__["default"].correctShift,ZoomTouchPinchTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ZoomTouchPinchTool,_BaseTool);function ZoomTouchPinchTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ZoomTouchPinchTool);var defaultConfig={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ZoomTouchPinchTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ZoomTouchPinchTool,[{key:"touchPinchCallback",value:function touchPinchCallback(evt){var _evt$detail=evt.detail,element=_evt$detail.element,viewport=_evt$detail.viewport,scaleChange=_evt$detail.scaleChange,_ref=[evt.detail.startPoints.page.x,evt.detail.startPoints.page.y,evt.detail.startPoints.image.x,evt.detail.startPoints.image.y],pageStartX=_ref[0],pageStartY=_ref[1],imageStartX=_ref[2],imageStartY=_ref[3],_this$configuration=this.configuration,maxScale=_this$configuration.maxScale,minScale=_this$configuration.minScale;viewport.scale+=scaleChange*viewport.scale;if(maxScale&&viewport.scale>maxScale){viewport.scale=maxScale}else if(minScale&&viewport.scale<minScale){viewport.scale=minScale}_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(element,viewport);var newCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pageToPixel(element,pageStartX,pageStartY),shift={x:imageStartX-newCoords.x,y:imageStartY-newCoords.y};shift=correctShift(shift,viewport);viewport.translation.x-=shift.x;viewport.translation.y-=shift.y;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.setViewport(element,viewport)}}]);return ZoomTouchPinchTool}(_base_BaseTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/annotation/AngleTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return AngleTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./manipulators/index.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/index.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./drawing/drawTextBox.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./drawing/drawHandles.js"),_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/lineSegDistance.js"),_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/roundToDecimal.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./tools/cursors/index.js"),AngleTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(AngleTool,_BaseAnnotationTool);function AngleTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,AngleTool);var defaultConfig={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_17__.angleCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(AngleTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.preventNewMeasurement=!1;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(AngleTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){return{visible:!0,active:!0,color:void 0,handles:{start:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1},middle:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0},end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){if(!1===data.visible){return!1}return 25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__["default"])(element,data.handles.start,data.handles.middle,coords)||25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__["default"])(element,data.handles.middle,data.handles.end,coords)}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail,enabledElement=eventData.enabledElement,_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}for(var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_11__.getNewContext)(eventData.canvasContext.canvas),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolWidth(),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_11__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_11__.setShadow)(context,_this2.configuration);var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data),handleStartCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(eventData.element,data.handles.start),handleMiddleCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(eventData.element,data.handles.middle);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_11__.drawJoinedLines)(context,eventData.element,data.handles.start,[data.handles.middle,data.handles.end],{color:color});var handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_14__["default"])(context,eventData,data.handles,handleOptions);var columnPixelSpacing=eventData.image.columnPixelSpacing||1,rowPixelSpacing=eventData.image.rowPixelSpacing||1,sideA={x:(data.handles.middle.x-data.handles.start.x)*columnPixelSpacing,y:(data.handles.middle.y-data.handles.start.y)*rowPixelSpacing},sideB={x:(data.handles.end.x-data.handles.middle.x)*columnPixelSpacing,y:(data.handles.end.y-data.handles.middle.y)*rowPixelSpacing},sideC={x:(data.handles.end.x-data.handles.start.x)*columnPixelSpacing,y:(data.handles.end.y-data.handles.start.y)*rowPixelSpacing},sideALength=length(sideA),sideBLength=length(sideB),sideCLength=length(sideC),angle=_Mathacos((_Mathpow(sideALength,2)+_Mathpow(sideBLength,2)-_Mathpow(sideCLength,2))/(2*sideALength*sideBLength));angle*=180/_MathPI;data.rAngle=Object(_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_16__["default"])(angle,2);if(data.rAngle){var text=textBoxText(data,eventData.image.rowPixelSpacing,eventData.image.columnPixelSpacing),distance=15,textCoords;if(!data.handles.textBox.hasMoved){textCoords={x:handleMiddleCanvas.x,y:handleMiddleCanvas.y};var padding=5,textWidth=Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_13__.textBoxWidth)(context,text,padding);if(handleMiddleCanvas.x<handleStartCanvas.x){textCoords.x-=distance+textWidth+10}else{textCoords.x+=distance}var transform=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.internal.getTransform(enabledElement);transform.invert();var coords=transform.transformPoint(textCoords.x,textCoords.y);data.handles.textBox.x=coords.x;data.handles.textBox.y=coords.y}Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_12__["default"])(context,eventData.element,data.handles.textBox,text,data.handles,textBoxAnchorPoints,color,lineWidth,0,!0)}})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}function textBoxText(data,rowPixelSpacing,columnPixelSpacing){var suffix=!rowPixelSpacing||!columnPixelSpacing?" (isotropic)":"",str="00B0";return data.rAngle.toString()+_StringfromCharCode(parseInt(str,16))+suffix}function textBoxAnchorPoints(handles){return[handles.start,handles.middle,handles.end]}}},{key:"addNewMeasurement",value:function addNewMeasurement(evt,interactionType){var _this3=this;if(this.preventNewMeasurement){return}this.preventNewMeasurement=!0;evt.preventDefault();evt.stopPropagation();var eventData=evt.detail,measurementData=this.createNewMeasurement(eventData),element=evt.detail.element;Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.addToolState)(element,this.name,measurementData);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element);var doneMovingEndHandleOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){measurementData.active=!1;_this3.preventNewMeasurement=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element)}},this.options),doneMovingMiddleHandleOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){measurementData.active=!1;measurementData.handles.end.active=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_10__.moveNewHandle)(eventData,_this3.name,measurementData,measurementData.handles.end,doneMovingEndHandleOptions,interactionType)}},this.options);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_10__.moveNewHandle)(eventData,this.name,measurementData,measurementData.handles.middle,doneMovingMiddleHandleOptions,interactionType)}}]);return AngleTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]);function length(vector){return _Mathsqrt(_Mathpow(vector.x,2)+_Mathpow(vector.y,2))}},"./tools/annotation/ArrowAnnotateTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ArrowAnnotateTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/textStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./manipulators/index.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/pointInsideBoundingBox.js"),_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/lineSegDistance.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./stateManagement/toolState.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./drawing/index.js"),_drawing_drawArrow_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./drawing/drawArrow.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./drawing/drawHandles.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./drawing/drawTextBox.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./tools/cursors/index.js"),ArrowAnnotateTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ArrowAnnotateTool,_BaseAnnotationTool);function ArrowAnnotateTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ArrowAnnotateTool);var defaultConfig={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:getTextCallback,changeTextCallback:changeTextCallback,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_19__.arrowAnnotateCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ArrowAnnotateTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.preventNewMeasurement=!1;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ArrowAnnotateTool,[{key:"createNewMeasurement",value:function createNewMeasurement(evt){return{visible:!0,active:!0,color:void 0,handles:{start:{x:evt.detail.currentPoints.image.x,y:evt.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:evt.detail.currentPoints.image.x,y:evt.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){if(!1===data.visible){return!1}return 25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_12__["default"])(element,data.handles.start,data.handles.end,coords)}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,_evt$detail=evt.detail,element=_evt$detail.element,enabledElement=_evt$detail.enabledElement,_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__.getToolState)(element,this.name);if(!toolData){return}for(var canvas=evt.detail.canvasContext.canvas,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_15__.getNewContext)(canvas),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_7__["default"].getToolWidth(),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_15__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_15__.setShadow)(context,_this2.configuration);var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data),handleStartCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.start),handleEndCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.end);if(_this2.configuration.arrowFirst){Object(_drawing_drawArrow_js__WEBPACK_IMPORTED_MODULE_16__["default"])(context,handleEndCanvas,handleStartCanvas,color,lineWidth)}else{Object(_drawing_drawArrow_js__WEBPACK_IMPORTED_MODULE_16__["default"])(context,handleStartCanvas,handleEndCanvas,color,lineWidth)}var handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};if(_this2.configuration.drawHandles){Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_17__["default"])(context,evt.detail,data.handles,handleOptions)}var text=textBoxText(data);if(text&&""!==text){var padding=5,textWidth=Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_18__.textBoxWidth)(context,text,padding),textHeight=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize()+10,distance=_Mathmax(textWidth,textHeight)/2+5;if(handleEndCanvas.x<handleStartCanvas.x){distance=-distance}if(!data.handles.textBox.hasMoved){var textCoords;if(_this2.configuration.arrowFirst){textCoords={x:handleEndCanvas.x-textWidth/2+distance,y:handleEndCanvas.y-textHeight/2}}else{textCoords={x:handleStartCanvas.x-textWidth/2-distance,y:handleStartCanvas.y-textHeight/2}}var transform=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.internal.getTransform(enabledElement);transform.invert();var coords=transform.transformPoint(textCoords.x,textCoords.y);data.handles.textBox.x=coords.x;data.handles.textBox.y=coords.y}Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_14__["default"])(context,element,data.handles.textBox,text,data.handles,textBoxAnchorPoints,color,lineWidth,0,!1)}})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}function textBoxText(data){return data.text}function textBoxAnchorPoints(handles){var midpoint={x:(handles.start.x+handles.end.x)/2,y:(handles.start.y+handles.end.y)/2};return[handles.start,midpoint,handles.end]}}},{key:"addNewMeasurement",value:function addNewMeasurement(evt,interactionType){var _this3=this,element=evt.detail.element,measurementData=this.createNewMeasurement(evt);Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__.addToolState)(element,this.name,measurementData);_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element);var toolOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){if(void 0===measurementData.text){_this3.configuration.getTextCallback(function(text){if(text){measurementData.text=text}else{Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__.removeToolState)(element,_this3.name,measurementData)}measurementData.active=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element)})}_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element)}},this.options);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_10__.moveNewHandle)(evt.detail,this.name,measurementData,measurementData.handles.end,toolOptions,interactionType)}},{key:"doubleClickCallback",value:function doubleClickCallback(evt){if(!Array.isArray(this.options.mouseButtonMask)||!this.options.mouseButtonMask.includes(evt.detail.buttons)){return}return this._updateTextForNearbyAnnotation(evt)}},{key:"touchPressCallback",value:function touchPressCallback(evt){return this._updateTextForNearbyAnnotation(evt)}},{key:"_updateTextForNearbyAnnotation",value:function _updateTextForNearbyAnnotation(evt){var element=evt.detail.element,coords=evt.detail.currentPoints.canvas,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__.getToolState)(element,this.name);if(!toolState){return!1}for(var i=0,data;i<toolState.data.length;i++){data=toolState.data[i];if(this.pointNearTool(element,data,coords)||Object(_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_11__["default"])(data.handles.textBox,coords)){data.active=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element);this.configuration.changeTextCallback(data,evt.detail,this._doneChangingTextCallback.bind(this,element,data));evt.stopImmediatePropagation();evt.preventDefault();evt.stopPropagation();return!0}}}},{key:"_doneChangingTextCallback",value:function _doneChangingTextCallback(element,data,updatedText,deleteTool){if(!0===deleteTool){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_13__.removeToolState)(element,this.name,data)}else{data.text=updatedText}data.active=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element)}}]);return ArrowAnnotateTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]);function getTextCallback(doneChangingTextCallback){doneChangingTextCallback(prompt("Enter your annotation:"))}function changeTextCallback(data,eventData,doneChangingTextCallback){doneChangingTextCallback(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return BidirectionalTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_bidirectionalTool_createNewMeasurement_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),_bidirectionalTool_pointNearTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/annotation/bidirectionalTool/pointNearTool.js"),_bidirectionalTool_renderToolData_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/annotation/bidirectionalTool/renderToolData.js"),_bidirectionalTool_addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),_bidirectionalTool_mouseMoveCallback_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),_bidirectionalTool_handleSelectedCallback_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),_bidirectionalTool_handleSelectedMouseCallback_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),_bidirectionalTool_handleSelectedTouchCallback_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./stateManagement/toolColors.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./tools/cursors/index.js"),emptyLocationCallback=function emptyLocationCallback(measurementData,eventData,doneCallback){return doneCallback()},BidirectionalTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(BidirectionalTool,_BaseAnnotationTool);function BidirectionalTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,BidirectionalTool);var textBoxConfig="",shadowConfig="",defaultConfig={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:emptyLocationCallback,getMeasurementLocationCallback:emptyLocationCallback,textBox:textBoxConfig,shadow:shadowConfig,drawHandlesOnHover:!0,additionalData:[]},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__.bidirectionalCursor},mergedConfiguration=Object.assign(defaultConfig.configuration,configuration),initialConfiguration=Object.assign(defaultConfig,{configuration:mergedConfiguration});_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2___default()(BidirectionalTool).call(this,initialConfiguration));_this.createNewMeasurement=_bidirectionalTool_createNewMeasurement_js__WEBPACK_IMPORTED_MODULE_6__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.pointNearTool=_bidirectionalTool_pointNearTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.renderToolData=_bidirectionalTool_renderToolData_js__WEBPACK_IMPORTED_MODULE_8__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.addNewMeasurement=_bidirectionalTool_addNewMeasurement_js__WEBPACK_IMPORTED_MODULE_9__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this._moveCallback=_bidirectionalTool_mouseMoveCallback_js__WEBPACK_IMPORTED_MODULE_10__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.handleSelectedCallback=_bidirectionalTool_handleSelectedCallback_js__WEBPACK_IMPORTED_MODULE_11__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.handleSelectedMouseCallback=_bidirectionalTool_handleSelectedMouseCallback_js__WEBPACK_IMPORTED_MODULE_12__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));_this.handleSelectedTouchCallback=_bidirectionalTool_handleSelectedTouchCallback_js__WEBPACK_IMPORTED_MODULE_13__["default"].bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3___default()(_this));return _this}return BidirectionalTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_5__["default"])},"./tools/annotation/CobbAngleTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return CobbAngleTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/textStyle.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./stateManagement/toolColors.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./manipulators/index.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/index.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./drawing/drawHandles.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/lineSegDistance.js"),_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/roundToDecimal.js"),_events_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./events.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./tools/cursors/index.js"),CobbAngleTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(CobbAngleTool,_BaseAnnotationTool);function CobbAngleTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,CobbAngleTool);var defaultConfig={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_18__.cobbAngleCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(CobbAngleTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.hasIncomplete=!1;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(CobbAngleTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){this.hasIncomplete=!0;return{visible:!0,active:!0,color:void 0,complete:!1,value:"",handles:{start:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1},end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0},start2:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:eventData.currentPoints.image.x+1,y:eventData.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){if(!1===data.visible){return!1}if(this.hasIncomplete){return!1}return 25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__["default"])(element,data.handles.start,data.handles.end,coords)||25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_15__["default"])(element,data.handles.start2,data.handles.end2,coords)}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail,_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}for(var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.getNewContext)(eventData.canvasContext.canvas),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_9__["default"].getToolWidth(),font=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_7__["default"].getFont(),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.setShadow)(context,_this2.configuration);var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_10__["default"].getColorIfActive(data);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.drawLine)(context,eventData.element,data.handles.start,data.handles.end,{color:color});if(data.complete){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_12__.drawLine)(context,eventData.element,data.handles.start2,data.handles.end2,{color:color})}var handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_13__["default"])(context,eventData,data.handles,handleOptions);context.fillStyle=color;var text=data.value;if(!data.handles.textBox.hasMoved){var textCoords={x:(data.handles.start.x+data.handles.end.x)/2,y:(data.handles.start.y+data.handles.end.y)/2-10};context.font=font;data.handles.textBox.x=textCoords.x;data.handles.textBox.y=textCoords.y}Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_14__["default"])(context,eventData.element,data.handles.textBox,text,data.handles,textBoxAnchorPoints,color,lineWidth,0,!0)})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}function textBoxAnchorPoints(handles){return[handles.start,handles.start2,handles.end,handles.end2]}}},{key:"getIncomplete",value:function getIncomplete(target){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(target,this.name);if(void 0===toolData){return}for(var i=0;i<toolData.data.length;i++){if(!1===toolData.data[i].complete){return toolData.data[i]}}}},{key:"addNewMeasurement",value:function addNewMeasurement(evt,interactionType){evt.preventDefault();evt.stopPropagation();var eventData=evt.detail,measurementData,toMoveHandle,element=evt.detail.element,maybePending=this.getIncomplete(element);if(maybePending){measurementData=maybePending;measurementData.complete=!0;measurementData.handles.start2={x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1};measurementData.handles.end2={x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0};toMoveHandle=measurementData.handles.end2;this.hasIncomplete=!1}else{measurementData=this.createNewMeasurement(eventData);Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.addToolState)(element,this.name,measurementData);toMoveHandle=measurementData.handles.end}_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.updateImage(element);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_11__.moveNewHandle)(eventData,this.name,measurementData,toMoveHandle,this.options,interactionType)}},{key:"onMeasureModified",value:function onMeasureModified(ev){var image=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.getEnabledElement(ev.detail.element).image;if(ev.detail.toolName!==this.name){return}var data=ev.detail.measurementData;data.value=calculateValue(data,image);function calculateValue(data,image){var _Mathceil=Math.ceil,columnPixelSpacing=image.columnPixelSpacing||1,rowPixelSpacing=image.rowPixelSpacing||1,dx1=(_Mathceil(data.handles.start.x)-_Mathceil(data.handles.end.x))*columnPixelSpacing,dy1=(_Mathceil(data.handles.start.y)-_Mathceil(data.handles.end.y))*rowPixelSpacing,dx2=(_Mathceil(data.handles.start2.x)-_Mathceil(data.handles.end2.x))*columnPixelSpacing,dy2=(_Mathceil(data.handles.start2.y)-_Mathceil(data.handles.end2.y))*rowPixelSpacing,angle=_Mathacos(_Mathabs((dx1*dx2+dy1*dy2)/(_Mathsqrt(dx1*dx1+dy1*dy1)*_Mathsqrt(dx2*dx2+dy2*dy2))));angle*=180/_MathPI;var rAngle=Object(_util_roundToDecimal_js__WEBPACK_IMPORTED_MODULE_16__["default"])(angle,2);if(!Number.isNaN(data.rAngle)){return textBoxText(rAngle,image.rowPixelSpacing,image.columnPixelSpacing)}return""}function textBoxText(rAngle,rowPixelSpacing,columnPixelSpacing){var suffix=!rowPixelSpacing||!columnPixelSpacing?" (isotropic)":"",str="00B0";return rAngle.toString()+_StringfromCharCode(parseInt(str,16))+suffix}}},{key:"activeCallback",value:function activeCallback(element){this.onMeasureModified=this.onMeasureModified.bind(this);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_17__["default"].MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function passiveCallback(element){this.onMeasureModified=this.onMeasureModified.bind(this);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_17__["default"].MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function enabledCallback(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_17__["default"].MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function disabledCallback(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_17__["default"].MEASUREMENT_MODIFIED,this.onMeasureModified)}}]);return CobbAngleTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/annotation/EllipticalRoiTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return EllipticalRoiTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/index.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/calculateSUV.js"),_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/ellipse/index.js"),_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./util/numbersWithCommas.js"),_util_throttle_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./util/throttle.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./tools/cursors/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_16__.getLogger)("tools:annotation:EllipticalRoiTool"),EllipticalRoiTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(EllipticalRoiTool,_BaseAnnotationTool);function EllipticalRoiTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,EllipticalRoiTool);var defaultConfig={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__.ellipticalRoiCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(EllipticalRoiTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(EllipticalRoiTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var goodEventData=eventData&&eventData.currentPoints&&eventData.currentPoints.image;if(!goodEventData){logger.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1},end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords,interactionType){var hasStartAndEndHandles=data&&data.handles&&data.handles.start&&data.handles.end,validParameters=hasStartAndEndHandles;if(!validParameters){logger.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"))}if(!validParameters||!1===data.visible){return!1}var distance="mouse"===interactionType?15:25,startCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.start),endCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.end),minorEllipse={left:_Mathmin(startCanvas.x,endCanvas.x)+distance/2,top:_Mathmin(startCanvas.y,endCanvas.y)+distance/2,width:_Mathabs(startCanvas.x-endCanvas.x)-distance,height:_Mathabs(startCanvas.y-endCanvas.y)-distance},majorEllipse={left:_Mathmin(startCanvas.x,endCanvas.x)-distance/2,top:_Mathmin(startCanvas.y,endCanvas.y)-distance/2,width:_Mathabs(startCanvas.x-endCanvas.x)+distance,height:_Mathabs(startCanvas.y-endCanvas.y)+distance},pointInMinorEllipse=Object(_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_12__.pointInEllipse)(minorEllipse,coords),pointInMajorEllipse=Object(_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_12__.pointInEllipse)(majorEllipse,coords);if(pointInMajorEllipse&&!pointInMinorEllipse){return!0}return!1}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}var eventData=evt.detail,image=eventData.image,element=eventData.element,lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolWidth(),_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.getNewContext)(eventData.canvasContext.canvas),seriesModule=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("generalSeriesModule",image.imageId)||{},imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId),modality=seriesModule.modality,hasPixelSpacing=imagePlane&&imagePlane.rowPixelSpacing&&imagePlane.columnPixelSpacing;imagePlane=imagePlane||{};var pixelSpacing={rowPixelSpacing:imagePlane.rowPixelSpacing||1,columnPixelSpacing:imagePlane.columnPixelSpacing||1};Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.draw)(context,function(context){for(var i=0,data;i<toolData.data.length;i++){data=toolData.data[i];if(!1===data.visible){continue}var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data),handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.setShadow)(context,_this2.configuration);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawEllipse)(context,element,data.handles.start,data.handles.end,{color:color});Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawHandles)(context,eventData,data.handles,handleOptions);if(!0===data.invalidated){if(data.cachedStats){_throttledUpdateCachedStats(image,element,data,modality,pixelSpacing)}else{_updateCachedStats(image,element,data,modality,pixelSpacing)}}if(!data.handles.textBox.hasMoved){data.handles.textBox.x=_Mathmax(data.handles.start.x,data.handles.end.x);data.handles.textBox.y=(data.handles.start.y+data.handles.end.y)/2}var textBoxAnchorPoints=function textBoxAnchorPoints(handles){return _findTextBoxAnchorPoints(handles.start,handles.end)},textBoxContent=_createTextBoxContent(context,image.color,data.cachedStats,modality,hasPixelSpacing,_this2.configuration);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawLinkedTextBox)(context,element,data.handles.textBox,textBoxContent,data.handles,textBoxAnchorPoints,color,lineWidth,0,!0)}})}}]);return EllipticalRoiTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),_throttledUpdateCachedStats=Object(_util_throttle_js__WEBPACK_IMPORTED_MODULE_14__["default"])(_updateCachedStats,110);function _updateCachedStats(image,element,data,modality,pixelSpacing){var stats=_calculateStats(image,element,data.handles,modality,pixelSpacing);data.cachedStats=stats;data.invalidated=!1}function _findTextBoxAnchorPoints(startHandle,endHandle){var _getEllipseImageCoord=_getEllipseImageCoordinates(startHandle,endHandle),left=_getEllipseImageCoord.left,top=_getEllipseImageCoord.top,width=_getEllipseImageCoord.width,height=_getEllipseImageCoord.height;return[{x:left+width/2,y:top},{x:left,y:top+height/2},{x:left+width/2,y:top+height},{x:left+width,y:top+height/2}]}function _createTextBoxContent(context,isColorImage){var _ref=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},area=_ref.area,mean=_ref.mean,stdDev=_ref.stdDev,min=_ref.min,max=_ref.max,meanStdDevSUV=_ref.meanStdDevSUV,modality=3<arguments.length?arguments[3]:void 0,hasPixelSpacing=4<arguments.length?arguments[4]:void 0,options=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},showMinMax=options.showMinMax||!1,showHounsfieldUnits=!1!==options.showHounsfieldUnits,textLines=[],otherLines=[];if(!isColorImage){var hasStandardUptakeValues=meanStdDevSUV&&0!==meanStdDevSUV.mean,suffix="CT"===modality&&showHounsfieldUnits?" HU":"",meanString="Mean: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__["default"])(mean.toFixed(2))).concat(suffix),stdDevString="Std Dev: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__["default"])(stdDev.toFixed(2))).concat(suffix);if(hasStandardUptakeValues){var SUVtext=" SUV: ",meanSuvString="".concat(SUVtext).concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__["default"])(meanStdDevSUV.mean.toFixed(2))),stdDevSuvString="".concat(SUVtext).concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__["default"])(meanStdDevSUV.stdDev.toFixed(2))),targetStringLength=_Mathfloor(context.measureText("".concat(stdDevString,"     ")).width);while(context.measureText(meanString).width<targetStringLength){meanString+=" "}otherLines.push("".concat(meanString).concat(meanSuvString));otherLines.push("".concat(stdDevString,"     ").concat(stdDevSuvString))}else{otherLines.push("".concat(meanString,"     ").concat(stdDevString))}if(showMinMax){var minString="Min: ".concat(min).concat(suffix),maxString="Max: ".concat(max).concat(suffix),_targetStringLength=hasStandardUptakeValues?_Mathfloor(context.measureText("".concat(stdDevString,"     ")).width):_Mathfloor(context.measureText("".concat(meanString,"     ")).width);while(context.measureText(minString).width<_targetStringLength){minString+=" "}otherLines.push("".concat(minString).concat(maxString))}}textLines.push(_formatArea(area,hasPixelSpacing));otherLines.forEach(function(x){return textLines.push(x)});return textLines}function _formatArea(area,hasPixelSpacing){var suffix=hasPixelSpacing?" mm".concat("\xB2"):" px".concat("\xB2");return"Area: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_13__["default"])(area.toFixed(2))).concat(suffix)}function _calculateStats(image,element,handles,modality,pixelSpacing){var ellipseCoordinates=_getEllipseImageCoordinates(handles.start,handles.end),pixels=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.getPixels(element,ellipseCoordinates.left,ellipseCoordinates.top,ellipseCoordinates.width,ellipseCoordinates.height),ellipseMeanStdDev=Object(_util_ellipse_index_js__WEBPACK_IMPORTED_MODULE_12__.calculateEllipseStatistics)(pixels,ellipseCoordinates),meanStdDevSUV;if("PT"===modality){meanStdDevSUV={mean:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,ellipseMeanStdDev.mean,!0)||0,stdDev:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,ellipseMeanStdDev.stdDev,!0)||0}}var area=_MathPI*(ellipseCoordinates.width*(pixelSpacing.columnPixelSpacing||1)/2)*(ellipseCoordinates.height*(pixelSpacing.rowPixelSpacing||1)/2);return{area:area||0,count:ellipseMeanStdDev.count||0,mean:ellipseMeanStdDev.mean||0,variance:ellipseMeanStdDev.variance||0,stdDev:ellipseMeanStdDev.stdDev||0,min:ellipseMeanStdDev.min||0,max:ellipseMeanStdDev.max||0,meanStdDevSUV:meanStdDevSUV}}function _getEllipseImageCoordinates(startHandle,endHandle){return{left:_Mathround(_Mathmin(startHandle.x,endHandle.x)),top:_Mathround(_Mathmin(startHandle.y,endHandle.y)),width:_Mathround(_Mathabs(startHandle.x-endHandle.x)),height:_Mathround(_Mathabs(startHandle.y-endHandle.y))}}},"./tools/annotation/FreehandMouseTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return FreehandMouseTool});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__),_events_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./stateManagement/toolColors.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./store/index.js"),_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./util/findAndMoveHelpers.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/pointInsideBoundingBox.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/calculateSUV.js"),_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./util/numbersWithCommas.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./drawing/index.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./drawing/drawHandles.js"),_util_clip_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./util/clip.js"),_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./store/setToolCursor.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("./tools/cursors/index.js"),_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./util/freehand/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_25__.getLogger)("tools:annotation:FreehandMouseTool"),insertOrDelete=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__["default"].insertOrDelete,freehandArea=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__["default"].freehandArea,calculateFreehandStatistics=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__["default"].calculateFreehandStatistics,freehandIntersect=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__["default"].freehandIntersect,FreehandHandleData=_util_freehand_index_js__WEBPACK_IMPORTED_MODULE_24__["default"].FreehandHandleData,FreehandMouseTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default()(FreehandMouseTool,_BaseAnnotationTool);function FreehandMouseTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,FreehandMouseTool);var defaultConfig={name:"FreehandMouse",supportedInteractionTypes:["Mouse","Touch"],configuration:defaultFreehandConfiguration(),svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_23__.freehandMouseCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(FreehandMouseTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.isMultiPartTool=!0;_this._drawing=!1;_this._dragging=!1;_this._modifying=!1;_this._drawingMouseDownCallback=_this._drawingMouseDownCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingMouseMoveCallback=_this._drawingMouseMoveCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingMouseDragCallback=_this._drawingMouseDragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingMouseUpCallback=_this._drawingMouseUpCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingMouseDoubleClickCallback=_this._drawingMouseDoubleClickCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._editMouseUpCallback=_this._editMouseUpCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._editMouseDragCallback=_this._editMouseDragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingTouchStartCallback=_this._drawingTouchStartCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingTouchDragCallback=_this._drawingTouchDragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._drawingDoubleTapClickCallback=_this._drawingDoubleTapClickCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));_this._editTouchDragCallback=_this._editTouchDragCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(FreehandMouseTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var goodEventData=eventData&&eventData.currentPoints&&eventData.currentPoints.image;if(!goodEventData){logger.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var measurementData={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};measurementData.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0};return measurementData}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){var validParameters=data&&data.handles&&data.handles.points;if(!validParameters){throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"))}if(!validParameters||!1===data.visible){return!1}var isPointNearTool=this._pointNearHandle(element,data,coords);if(void 0!==isPointNearTool){return!0}return!1}},{key:"distanceFromPoint",value:function distanceFromPoint(element,data,coords){for(var distance=1/0,i=0,distanceI;i<data.handles.points.length;i++){distanceI=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstoneMath.point.distance(data.handles.points[i],coords);distance=_Mathmin(distance,distanceI)}if(distance===1/0){return-1}return distance}},{key:"distanceFromPointCanvas",value:function distanceFromPointCanvas(element,data,coords){var distance=1/0;if(!data){return-1}for(var canvasCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.pixelToCanvas(element,coords),points=data.handles.points,i=0;i<points.length;i++){var handleCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.pixelToCanvas(element,points[i]),distanceI=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstoneMath.point.distance(handleCanvas,canvasCoords);distance=_Mathmin(distance,distanceI)}if(distance===1/0){return-1}return distance}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(evt.currentTarget,this.name);if(!toolState){return}for(var image=eventData.image,element=eventData.element,config=this.configuration,seriesModule=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.metaData.get("generalSeriesModule",image.imageId),modality=seriesModule?seriesModule.modality:null,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_18__.getNewContext)(eventData.canvasContext.canvas),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_11__["default"].getToolWidth(),_loop=function _loop(i){var data=toolState.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_18__.draw)(context,function(context){var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_12__["default"].getColorIfActive(data),fillColor;if(data.active){if(data.handles.invalidHandlePlacement){color=config.invalidColor;fillColor=config.invalidColor}else{color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_12__["default"].getColorIfActive(data);fillColor=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_12__["default"].getFillColor()}}else{fillColor=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_12__["default"].getToolColor()}if(data.handles.points.length){for(var j=0;j<data.handles.points.length;j++){var lines=_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(data.handles.points[j].lines),points=data.handles.points;if(j===points.length-1&&!data.polyBoundingBox){lines.push(config.mouseLocation.handles.start)}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_18__.drawJoinedLines)(context,eventData.element,data.handles.points[j],lines,{color:color})}}var options={color:color,fill:fillColor};if(config.alwaysShowHandles||data.active&&data.polyBoundingBox){options.handleRadius=config.activeHandleRadius;Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_20__["default"])(context,eventData,data.handles.points,options)}if(data.canComplete){options.handleRadius=config.completeHandleRadius;var handle=data.handles.points[0];Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_20__["default"])(context,eventData,[handle],options)}if(data.active&&!data.polyBoundingBox){options.handleRadius=config.activeHandleRadius;Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_20__["default"])(context,eventData,config.mouseLocation.handles,options);var firstHandle=data.handles.points[0];Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_20__["default"])(context,eventData,[firstHandle],options)}var area,meanStdDev,meanStdDevSUV;if(!1===data.invalidated){meanStdDev=data.meanStdDev;meanStdDevSUV=data.meanStdDevSUV;area=data.area}else if(!data.active){for(var _points=data.handles.points,bounds={left:_points[0].x,right:_points[0].x,bottom:_points[0].y,top:_points[0].x},_i=0;_i<_points.length;_i++){bounds.left=_Mathmin(bounds.left,_points[_i].x);bounds.right=_Mathmax(bounds.right,_points[_i].x);bounds.bottom=_Mathmin(bounds.bottom,_points[_i].y);bounds.top=_Mathmax(bounds.top,_points[_i].y)}var polyBoundingBox={left:bounds.left,top:bounds.bottom,width:_Mathabs(bounds.right-bounds.left),height:_Mathabs(bounds.top-bounds.bottom)};data.polyBoundingBox=polyBoundingBox;if(!image.color){var pixels=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.getPixels(element,polyBoundingBox.left,polyBoundingBox.top,polyBoundingBox.width,polyBoundingBox.height);meanStdDev=calculateFreehandStatistics.call(_this2,pixels,polyBoundingBox,data.handles.points);if("PT"===modality){meanStdDevSUV={mean:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_16__["default"])(image,(meanStdDev.mean-image.intercept)/image.slope),stdDev:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_16__["default"])(image,(meanStdDev.stdDev-image.intercept)/image.slope)}}if(meanStdDev&&!isNaN(meanStdDev.mean)){data.meanStdDev=meanStdDev;data.meanStdDevSUV=meanStdDevSUV}}var columnPixelSpacing=image.columnPixelSpacing||1,rowPixelSpacing=image.rowPixelSpacing||1,scaling=columnPixelSpacing*rowPixelSpacing;data.points_name=prompt("Type here");area=freehandArea(data.handles.points,scaling);if(!isNaN(area)){data.area=area}data.invalidated=!1}if(data.polyBoundingBox&&!data.handles.textBox.freehand){if(!data.handles.textBox.hasMoved){data.handles.textBox.x=data.polyBoundingBox.left+data.polyBoundingBox.width;data.handles.textBox.y=data.polyBoundingBox.top+data.polyBoundingBox.height/2}var text=textBoxText.call(_this2,data);Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_19__["default"])(context,element,data.handles.textBox,text,data.handles.points,textBoxAnchorPoints,color,lineWidth,0,!0)}})},i=0,_ret;i<toolState.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}function textBoxText(data){var textLines=[],areaText=data.points_name;textLines.push(areaText);return textLines}function textBoxAnchorPoints(handles){return handles}}},{key:"addNewMeasurement",value:function addNewMeasurement(evt){var eventData=evt.detail;this._startDrawing(evt);this._addPoint(eventData);preventPropagation(evt)}},{key:"preMouseDownCallback",value:function preMouseDownCallback(evt){var eventData=evt.detail,nearby=this._pointNearHandleAllTools(eventData);if(eventData.event.ctrlKey){if(void 0!==nearby&&nearby.handleNearby.hasBoundingBox){}else{insertOrDelete.call(this,evt,nearby)}preventPropagation(evt);return!0}return!1}},{key:"handleSelectedCallback",value:function handleSelectedCallback(evt,toolData,handle){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse",eventData=evt.detail,element=eventData.element,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name);if(handle.hasBoundingBox){Object(_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_14__.moveHandleNearImagePoint)(evt,this,toolData,handle,interactionType);return}var config=this.configuration;config.dragOrigin={x:handle.x,y:handle.y};for(var toolIndex=0,points;toolIndex<toolState.data.length;toolIndex++){points=toolState.data[toolIndex].handles.points;for(var p=0;p<points.length;p++){if(points[p]===handle){config.currentHandle=p;config.currentTool=toolIndex}}}this._modifying=!0;this._activateModify(element);preventPropagation(evt)}},{key:"_drawingMouseMoveCallback",value:function _drawingMouseMoveCallback(evt){var eventData=evt.detail,element=eventData.element,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),config=this.configuration,currentTool=config.currentTool,data=toolState.data[currentTool],coords=eventData.currentPoints.canvas;this._getMouseLocation(eventData);this._checkInvalidHandleLocation(data,eventData);var handleNearby=this._pointNearHandle(element,data,coords),points=data.handles.points;if(void 0!==handleNearby&&!handleNearby.hasBoundingBox&&handleNearby<points.length-1){config.mouseLocation.handles.start.x=points[handleNearby].x;config.mouseLocation.handles.start.y=points[handleNearby].y}_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element)}},{key:"_drawingMouseDragCallback",value:function _drawingMouseDragCallback(evt){if(!this.options.mouseButtonMask.includes(evt.detail.buttons)){return}this._drawingDrag(evt)}},{key:"_drawingTouchDragCallback",value:function _drawingTouchDragCallback(evt){this._drawingDrag(evt)}},{key:"_drawingDrag",value:function _drawingDrag(evt){var eventData=evt.detail,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),config=this.configuration,currentTool=config.currentTool,data=toolState.data[currentTool];this._getMouseLocation(eventData);this._checkInvalidHandleLocation(data,eventData);this._addPointPencilMode(eventData,data.handles.points);this._dragging=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element)}},{key:"_drawingMouseUpCallback",value:function _drawingMouseUpCallback(evt){var eventData=evt.detail;if(!this._dragging){return}this._dragging=!1;var element=eventData.element,config=this.configuration,currentTool=config.currentTool,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),data=toolState.data[currentTool];if(!freehandIntersect.end(data.handles.points)&&data.canComplete){var lastHandlePlaced=config.currentHandle;this._endDrawing(element,lastHandlePlaced)}preventPropagation(evt);return}},{key:"_drawingMouseDownCallback",value:function _drawingMouseDownCallback(evt){var eventData=evt.detail;if(!this.options.mouseButtonMask.includes(eventData.buttons)){return}var element=eventData.element,coords=eventData.currentPoints.canvas,config=this.configuration,currentTool=config.currentTool,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),data=toolState.data[currentTool],handleNearby=this._pointNearHandle(element,data,coords);if(!freehandIntersect.end(data.handles.points)&&data.canComplete){var lastHandlePlaced=config.currentHandle;this._endDrawing(element,lastHandlePlaced)}else if(void 0===handleNearby){this._addPoint(eventData)}preventPropagation(evt);return}},{key:"_drawingTouchStartCallback",value:function _drawingTouchStartCallback(evt){var eventData=evt.detail,element=eventData.element,coords=eventData.currentPoints.canvas,config=this.configuration,currentTool=config.currentTool,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),data=toolState.data[currentTool],handleNearby=this._pointNearHandle(element,data,coords);if(!freehandIntersect.end(data.handles.points)&&data.canComplete){var lastHandlePlaced=config.currentHandle;this._endDrawing(element,lastHandlePlaced)}else if(void 0===handleNearby){this._addPoint(eventData)}preventPropagation(evt);return}},{key:"completeDrawing",value:function completeDrawing(element){if(!this._drawing){return}var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(element,this.name),config=this.configuration,data=toolState.data[config.currentTool];if(!freehandIntersect.end(data.handles.points)&&2<=data.handles.points.length){var lastHandlePlaced=config.currentHandle;data.polyBoundingBox={};this._endDrawing(element,lastHandlePlaced)}}},{key:"_drawingMouseDoubleClickCallback",value:function _drawingMouseDoubleClickCallback(evt){var eventData=evt.detail;this.completeDrawing(eventData.element);preventPropagation(evt)}},{key:"_drawingDoubleTapClickCallback",value:function _drawingDoubleTapClickCallback(evt){var eventData=evt.detail;this.completeDrawing(eventData.element);preventPropagation(evt)}},{key:"_editMouseDragCallback",value:function _editMouseDragCallback(evt){var eventData=evt.detail;if(!this.options.mouseButtonMask.includes(eventData.buttons)){return}var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),config=this.configuration,data=toolState.data[config.currentTool],currentHandle=config.currentHandle,points=data.handles.points,handleIndex=-1;this._getMouseLocation(eventData);data.handles.invalidHandlePlacement=freehandIntersect.modify(points,currentHandle);data.active=!0;data.highlight=!0;points[currentHandle].x=config.mouseLocation.handles.start.x;points[currentHandle].y=config.mouseLocation.handles.start.y;handleIndex=this._getPrevHandleIndex(currentHandle,points);if(0<=currentHandle){var lastLineIndex=points[handleIndex].lines.length-1,lastLine=points[handleIndex].lines[lastLineIndex];lastLine.x=config.mouseLocation.handles.start.x;lastLine.y=config.mouseLocation.handles.start.y}_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element)}},{key:"_editTouchDragCallback",value:function _editTouchDragCallback(evt){var eventData=evt.detail,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),config=this.configuration,data=toolState.data[config.currentTool],currentHandle=config.currentHandle,points=data.handles.points,handleIndex=-1;this._getMouseLocation(eventData);data.handles.invalidHandlePlacement=freehandIntersect.modify(points,currentHandle);data.active=!0;data.highlight=!0;points[currentHandle].x=config.mouseLocation.handles.start.x;points[currentHandle].y=config.mouseLocation.handles.start.y;handleIndex=this._getPrevHandleIndex(currentHandle,points);if(0<=currentHandle){var lastLineIndex=points[handleIndex].lines.length-1,lastLine=points[handleIndex].lines[lastLineIndex];lastLine.x=config.mouseLocation.handles.start.x;lastLine.y=config.mouseLocation.handles.start.y}_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element)}},{key:"_getPrevHandleIndex",value:function _getPrevHandleIndex(currentHandle,points){if(0===currentHandle){return points.length-1}return currentHandle-1}},{key:"_editMouseUpCallback",value:function _editMouseUpCallback(evt){var eventData=evt.detail,element=eventData.element,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name);this._deactivateModify(element);this._dropHandle(eventData,toolState);this._endDrawing(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element)}},{key:"_dropHandle",value:function _dropHandle(eventData,toolState){var config=this.configuration,currentTool=config.currentTool,handles=toolState.data[currentTool].handles,points=handles.points;if(handles.invalidHandlePlacement){var currentHandle=config.currentHandle,currentHandleData=points[currentHandle],previousHandleData;if(0===currentHandle){var lastHandleID=points.length-1;previousHandleData=points[lastHandleID]}else{previousHandleData=points[currentHandle-1]}currentHandleData.x=config.dragOrigin.x;currentHandleData.y=config.dragOrigin.y;previousHandleData.lines[0]=currentHandleData;handles.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function _startDrawing(evt){var eventData=evt.detail,measurementData=this.createNewMeasurement(eventData),element=eventData.element,config=this.configuration;this._referencedElement=element;var interactionType;if(evt.type===_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DOWN_ACTIVATE){interactionType="Mouse"}else if(evt.type===_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_START_ACTIVE){interactionType="Touch"}this._activateDraw(element,interactionType);this._getMouseLocation(eventData);Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.addToolState)(eventData.element,this.name,measurementData);var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name);config.currentTool=toolState.data.length-1;this._activeDrawingToolReference=toolState.data[config.currentTool]}},{key:"_addPoint",value:function _addPoint(eventData){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(eventData.element,this.name),config=this.configuration,data=toolState.data[config.currentTool];if(data.handles.invalidHandlePlacement){return}var newHandleData=new FreehandHandleData(eventData.currentPoints.image);if(data.handles.points.length){data.handles.points[config.currentHandle-1].lines.push(eventData.currentPoints.image)}data.handles.points.push(newHandleData);config.currentHandle+=1;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(eventData.element);this.fireModifiedEvent(eventData.element,data)}},{key:"_addPointPencilMode",value:function _addPointPencilMode(eventData,points){var _this3=this,config=this.configuration,element=eventData.element,mousePoint=config.mouseLocation.handles.start,handleFurtherThanMinimumSpacing=function handleFurtherThanMinimumSpacing(handle){return _this3._isDistanceLargerThanSpacing(element,handle,mousePoint)};if(points.every(handleFurtherThanMinimumSpacing)){this._addPoint(eventData)}}},{key:"_endDrawing",value:function _endDrawing(element,handleNearby){var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(element,this.name),config=this.configuration,data=toolState.data[config.currentTool];data.active=!1;data.highlight=!1;data.handles.invalidHandlePlacement=!1;if(void 0!==handleNearby){var points=data.handles.points;points[config.currentHandle-1].lines.push(points[0])}if(this._modifying){this._modifying=!1;data.invalidated=!0}config.currentHandle=0;config.currentTool=-1;data.canComplete=!1;if(this._drawing){this._deactivateDraw(element)}_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element);this.fireModifiedEvent(element,data)}},{key:"_pointNearHandle",value:function _pointNearHandle(element,data,coords){if(void 0===data.handles||void 0===data.handles.points){return}if(!1===data.visible){return}for(var i=0,handleCanvas;i<data.handles.points.length;i++){handleCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.pixelToCanvas(element,data.handles.points[i]);if(6>_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstoneMath.point.distance(handleCanvas,coords)){return i}}if(data.handles.textBox){if(Object(_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_15__["default"])(data.handles.textBox,coords)){return data.handles.textBox}}}},{key:"_pointNearHandleAllTools",value:function _pointNearHandleAllTools(eventData){var element=eventData.element,coords=eventData.currentPoints.canvas,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(element,this.name);if(!toolState){return}for(var handleNearby,toolIndex=0;toolIndex<toolState.data.length;toolIndex++){handleNearby=this._pointNearHandle(element,toolState.data[toolIndex],coords);if(void 0!==handleNearby){return{handleNearby:handleNearby,toolIndex:toolIndex}}}}},{key:"_getMouseLocation",value:function _getMouseLocation(eventData){var config=this.configuration;config.mouseLocation.handles.start.x=eventData.currentPoints.image.x;config.mouseLocation.handles.start.y=eventData.currentPoints.image.y;Object(_util_clip_js__WEBPACK_IMPORTED_MODULE_21__.clipToBox)(config.mouseLocation.handles.start,eventData.image)}},{key:"_checkInvalidHandleLocation",value:function _checkInvalidHandleLocation(data,eventData){if(2>data.handles.points.length){return!0}var invalidHandlePlacement;if(this._dragging){invalidHandlePlacement=this._checkHandlesPencilMode(data,eventData)}else{invalidHandlePlacement=this._checkHandlesPolygonMode(data,eventData)}data.handles.invalidHandlePlacement=invalidHandlePlacement}},{key:"_checkHandlesPolygonMode",value:function _checkHandlesPolygonMode(data,eventData){var config=this.configuration,element=eventData.element,mousePoint=config.mouseLocation.handles.start,points=data.handles.points,invalidHandlePlacement=!1;data.canComplete=!1;var mouseAtOriginHandle=this._isDistanceSmallerThanCompleteSpacingCanvas(element,points[0],mousePoint);if(mouseAtOriginHandle&&!freehandIntersect.end(points)&&2<points.length){data.canComplete=!0;invalidHandlePlacement=!1}else{invalidHandlePlacement=freehandIntersect.newHandle(mousePoint,points)}return invalidHandlePlacement}},{key:"_checkHandlesPencilMode",value:function _checkHandlesPencilMode(data,eventData){var config=this.configuration,mousePoint=config.mouseLocation.handles.start,points=data.handles.points,invalidHandlePlacement=freehandIntersect.newHandle(mousePoint,points);if(!1===invalidHandlePlacement){invalidHandlePlacement=this._invalidHandlePencilMode(data,eventData)}return invalidHandlePlacement}},{key:"_invalidHandlePencilMode",value:function _invalidHandlePencilMode(data,eventData){var config=this.configuration,element=eventData.element,mousePoint=config.mouseLocation.handles.start,points=data.handles.points,mouseAtOriginHandle=this._isDistanceSmallerThanCompleteSpacingCanvas(element,points[0],mousePoint);if(mouseAtOriginHandle){data.canComplete=!0;return!1}data.canComplete=!1;for(var i=1;i<points.length-1;i++){if(this._isDistanceSmallerThanSpacing(element,points[i],mousePoint)){return!0}}return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function _isDistanceSmallerThanCompleteSpacingCanvas(element,p1,p2){var p1Canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.pixelToCanvas(element,p1),p2Canvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.pixelToCanvas(element,p2),completeHandleRadius;if("Mouse"===this._drawingInteractionType){completeHandleRadius=this.configuration.completeHandleRadius}else if("Touch"===this._drawingInteractionType){completeHandleRadius=this.configuration.completeHandleRadiusTouch}return this._compareDistanceToSpacing(element,p1Canvas,p2Canvas,"<",completeHandleRadius)}},{key:"_isDistanceSmallerThanSpacing",value:function _isDistanceSmallerThanSpacing(element,p1,p2){return this._compareDistanceToSpacing(element,p1,p2,"<")}},{key:"_isDistanceLargerThanSpacing",value:function _isDistanceLargerThanSpacing(element,p1,p2){return this._compareDistanceToSpacing(element,p1,p2,">")}},{key:"_compareDistanceToSpacing",value:function _compareDistanceToSpacing(element,p1,p2){var comparison=3<arguments.length&&void 0!==arguments[3]?arguments[3]:">",spacing=4<arguments.length&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;if(">"===comparison){return _externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstoneMath.point.distance(p1,p2)>spacing}return _externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstoneMath.point.distance(p1,p2)<spacing}},{key:"_activateDraw",value:function _activateDraw(element){var interactionType=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0;this._drawingInteractionType=interactionType;_store_index_js__WEBPACK_IMPORTED_MODULE_13__.state.isMultiPartToolActive=!0;Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_22__.hideToolCursor)(this.element);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DOWN,this._drawingMouseDownCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_MOVE,this._drawingMouseMoveCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DRAG,this._drawingMouseDragCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._drawingMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_START,this._drawingMouseMoveCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_START,this._drawingTouchStartCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_DRAG,this._drawingTouchDragCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_END,this._drawingMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].DOUBLE_TAP,this._drawingDoubleTapClickCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"_deactivateDraw",value:function _deactivateDraw(element){this._drawing=!1;_store_index_js__WEBPACK_IMPORTED_MODULE_13__.state.isMultiPartToolActive=!1;this._activeDrawingToolReference=null;this._drawingInteractionType=null;Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_22__.setToolCursor)(this.element,this.svgCursor);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DOWN,this._drawingMouseDownCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_MOVE,this._drawingMouseMoveCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DRAG,this._drawingMouseDragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._drawingMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_START,this._drawingTouchStartCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_DRAG,this._drawingTouchDragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_START,this._drawingMouseMoveCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_END,this._drawingMouseUpCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"_activateModify",value:function _activateModify(element){_store_index_js__WEBPACK_IMPORTED_MODULE_13__.state.isToolLocked=!0;element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._editMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DRAG,this._editMouseDragCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_CLICK,this._editMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_END,this._editMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_DRAG,this._editTouchDragCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"_deactivateModify",value:function _deactivateModify(element){_store_index_js__WEBPACK_IMPORTED_MODULE_13__.state.isToolLocked=!1;element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._editMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_DRAG,this._editMouseDragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_CLICK,this._editMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_END,this._editMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].TOUCH_DRAG,this._editTouchDragCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"passiveCallback",value:function passiveCallback(element){this._closeToolIfDrawing(element)}},{key:"enabledCallback",value:function enabledCallback(element){this._closeToolIfDrawing(element)}},{key:"disabledCallback",value:function disabledCallback(element){this._closeToolIfDrawing(element)}},{key:"_closeToolIfDrawing",value:function _closeToolIfDrawing(element){if(this._drawing){var config=this.configuration,lastHandlePlaced=config.currentHandle;this._endDrawing(element,lastHandlePlaced);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}}},{key:"fireModifiedEvent",value:function fireModifiedEvent(element,data){_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.triggerEvent(element,_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MEASUREMENT_MODIFIED,data)}},{key:"cancelDrawing",value:function cancelDrawing(element){if(!this._drawing){return}var toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.getToolState)(element,this.name),config=this.configuration,data=toolState.data[config.currentTool];data.active=!1;data.highlight=!1;data.handles.invalidHandlePlacement=!1;config.currentHandle=0;config.currentTool=-1;data.canComplete=!1;Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_10__.removeToolState)(element,this.name,data);this._deactivateDraw(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"newImageCallback",value:function newImageCallback(evt){var config=this.configuration;if(!(this._drawing&&this._activeDrawingToolReference)){return}var element=evt.detail.element,data=this._activeDrawingToolReference;data.active=!1;data.highlight=!1;data.handles.invalidHandlePlacement=!1;var points=data.handles.points;points[config.currentHandle-1].lines.push(points[0]);config.currentHandle=0;config.currentTool=-1;data.canComplete=!1;this._deactivateDraw(element);_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(element)}},{key:"spacing",get:function get(){return this.configuration.spacing},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehand spacing to a value other than a number.")}this.configuration.spacing=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function get(){return this.configuration.activeHandleRadius},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.")}this.configuration.activeHandleRadius=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function get(){return this.configuration.completeHandleRadius},set:function set(value){if("number"!==typeof value){throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.")}this.configuration.completeHandleRadius=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function get(){return this.configuration.alwaysShowHandles},set:function set(value){if("boolean"!==typeof value){throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.")}this.configuration.alwaysShowHandles=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function get(){return this.configuration.invalidColor},set:function set(value){this.configuration.invalidColor=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_8__["default"].cornerstone.updateImage(this.element)}}]);return FreehandMouseTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_9__["default"]);function defaultFreehandConfiguration(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1}}function preventPropagation(evt){evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault()}},"./tools/annotation/LengthTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return LengthTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/index.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/drawLinkedTextBox.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/drawHandles.js"),_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./util/lineSegDistance.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/cursors/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_15__.getLogger)("tools:annotation:LengthTool"),LengthTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(LengthTool,_BaseAnnotationTool);function LengthTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,LengthTool);var defaultConfig={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__.lengthCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(LengthTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(LengthTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var goodEventData=eventData&&eventData.currentPoints&&eventData.currentPoints.image;if(!goodEventData){logger.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var _eventData$currentPoi=eventData.currentPoints.image,x=_eventData$currentPoi.x,y=_eventData$currentPoi.y;return{visible:!0,active:!0,color:void 0,handles:{start:{x:x,y:y,highlight:!0,active:!1},end:{x:x,y:y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){var hasStartAndEndHandles=data&&data.handles&&data.handles.start&&data.handles.end,validParameters=hasStartAndEndHandles;if(!validParameters){logger.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!1}if(!1===data.visible){return!1}return 25>Object(_util_lineSegDistance_js__WEBPACK_IMPORTED_MODULE_13__["default"])(element,data.handles.start,data.handles.end,coords)}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,eventData=evt.detail,_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.getNewContext)(eventData.canvasContext.canvas),image=eventData.image,element=eventData.element,lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolWidth(),imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId),rowPixelSpacing,colPixelSpacing;if(imagePlane){rowPixelSpacing=imagePlane.rowPixelSpacing||imagePlane.rowImagePixelSpacing;colPixelSpacing=imagePlane.columnPixelSpacing||imagePlane.colImagePixelSpacing}else{rowPixelSpacing=image.rowPixelSpacing;colPixelSpacing=image.columnPixelSpacing}for(var _loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.setShadow)(context,_this2.configuration);var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawLine)(context,element,data.handles.start,data.handles.end,{color:color});var handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__["default"])(context,eventData,data.handles,handleOptions);var dx=(data.handles.end.x-data.handles.start.x)*(colPixelSpacing||1),dy=(data.handles.end.y-data.handles.start.y)*(rowPixelSpacing||1),length=_Mathsqrt(dx*dx+dy*dy);data.length=length;if(!data.handles.textBox.hasMoved){var coords={x:_Mathmax(data.handles.start.x,data.handles.end.x)};if(coords.x===data.handles.start.x){coords.y=data.handles.start.y}else{coords.y=data.handles.end.y}data.handles.textBox.x=coords.x;data.handles.textBox.y=coords.y}var xOffset=10,text=textBoxText(data,rowPixelSpacing,colPixelSpacing);Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"])(context,element,data.handles.textBox,text,data.handles,textBoxAnchorPoints,color,lineWidth,xOffset,!0)})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}function textBoxText(data,rowPixelSpacing,colPixelSpacing){var suffix=" mm";if(!rowPixelSpacing||!colPixelSpacing){suffix=" pixels"}return"".concat(data.length.toFixed(2)).concat(suffix)}function textBoxAnchorPoints(handles){var midpoint={x:(handles.start.x+handles.end.x)/2,y:(handles.start.y+handles.end.y)/2};return[handles.start,midpoint,handles.end]}}}]);return LengthTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/annotation/ProbeTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ProbeTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/textStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/index.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/drawTextBox.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./drawing/drawHandles.js"),_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./util/getRGBPixels.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./util/calculateSUV.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./tools/cursors/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_16__.getLogger)("tools:annotation:ProbeTool"),ProbeTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(ProbeTool,_BaseAnnotationTool);function ProbeTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ProbeTool);var defaultConfig={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_15__.probeCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(ProbeTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(ProbeTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var goodEventData=eventData&&eventData.currentPoints&&eventData.currentPoints.image;if(!goodEventData){logger.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,handles:{end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){var hasEndHandle=data&&data.handles&&data.handles.end,validParameters=hasEndHandle;if(!validParameters){logger.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"))}if(!validParameters||!1===data.visible){return!1}var probeCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.end);return 5>_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstoneMath.point.distance(probeCoords,coords)}},{key:"renderToolData",value:function renderToolData(evt){var eventData=evt.detail,handleRadius=this.configuration.handleRadius,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}for(var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.getNewContext)(eventData.canvasContext.canvas),image=eventData.image,fontHeight=_stateManagement_textStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getFontSize(),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.draw)(context,function(context){var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data);Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_12__["default"])(context,eventData,data.handles,{handleRadius:handleRadius,color:color});var x=_Mathround(data.handles.end.x),y=_Mathround(data.handles.end.y),storedPixels,text,str;if(0<=x&&0<=y&&x<image.columns&&y<image.rows){text="".concat(x,", ").concat(y);if(image.color){storedPixels=Object(_util_getRGBPixels_js__WEBPACK_IMPORTED_MODULE_13__["default"])(eventData.element,x,y,1,1);str="R: ".concat(storedPixels[0]," G: ").concat(storedPixels[1]," B: ").concat(storedPixels[2])}else{storedPixels=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.getStoredPixels(eventData.element,x,y,1,1);var sp=storedPixels[0],mo=sp*image.slope+image.intercept,suv=Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_14__["default"])(image,sp);str="SP: ".concat(sp," MO: ").concat(parseFloat(mo.toFixed(3)));if(suv){str+=" SUV: ".concat(parseFloat(suv.toFixed(3)))}}var coords={x:data.handles.end.x+3,y:data.handles.end.y-3},textCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(eventData.element,coords);Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"])(context,str,textCoords.x,textCoords.y+fontHeight+5,color);Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"])(context,text,textCoords.x,textCoords.y,color)}})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}}}]);return ProbeTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"])},"./tools/annotation/RectangleRoiTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return RectangleRoiTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_externalModules_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./externalModules.js"),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/index.js"),_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./util/calculateSUV.js"),_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./util/numbersWithCommas.js"),_util_throttle_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./util/throttle.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/cursors/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_15__.getLogger)("tools:annotation:RectangleRoiTool"),RectangleRoiTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(RectangleRoiTool,_BaseAnnotationTool);function RectangleRoiTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,RectangleRoiTool);var defaultConfig={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_14__.rectangleRoiCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(RectangleRoiTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(RectangleRoiTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var goodEventData=eventData&&eventData.currentPoints&&eventData.currentPoints.image;if(!goodEventData){logger.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!1},end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function pointNearTool(element,data,coords,interactionType){var hasStartAndEndHandles=data&&data.handles&&data.handles.start&&data.handles.end,validParameters=hasStartAndEndHandles;if(!validParameters){logger.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"))}if(!validParameters||!1===data.visible){return!1}var distance="mouse"===interactionType?15:25,startCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.start),endCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.pixelToCanvas(element,data.handles.end),rect={left:_Mathmin(startCanvas.x,endCanvas.x),top:_Mathmin(startCanvas.y,endCanvas.y),width:_Mathabs(startCanvas.x-endCanvas.x),height:_Mathabs(startCanvas.y-endCanvas.y)},distanceToPoint=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstoneMath.rect.distanceToPoint(rect,coords);return distanceToPoint<distance}},{key:"renderToolData",value:function renderToolData(evt){var _this2=this,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}var eventData=evt.detail,image=eventData.image,element=eventData.element,lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_8__["default"].getToolWidth(),_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.getNewContext)(eventData.canvasContext.canvas),seriesModule=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("generalSeriesModule",image.imageId)||{},imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId),modality=seriesModule.modality,hasPixelSpacing=imagePlane&&imagePlane.rowPixelSpacing&&imagePlane.columnPixelSpacing;imagePlane=imagePlane||{};var pixelSpacing={rowPixelSpacing:imagePlane.rowPixelSpacing||1,columnPixelSpacing:imagePlane.columnPixelSpacing||1};Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.draw)(context,function(context){for(var i=0,data;i<toolData.data.length;i++){data=toolData.data[i];if(!1===data.visible){continue}var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data),handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.setShadow)(context,_this2.configuration);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawRect)(context,element,data.handles.start,data.handles.end,{color:color});Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawHandles)(context,eventData,data.handles,handleOptions);if(!0===data.invalidated){if(data.cachedStats){_throttledUpdateCachedStats(image,element,data,modality,pixelSpacing)}else{_updateCachedStats(image,element,data,modality,pixelSpacing)}}if(!data.handles.textBox.hasMoved){data.handles.textBox.x=_Mathmax(data.handles.start.x,data.handles.end.x);data.handles.textBox.y=(data.handles.start.y+data.handles.end.y)/2}var textBoxAnchorPoints=function textBoxAnchorPoints(handles){return _findTextBoxAnchorPoints(handles.start,handles.end)},textBoxContent=_createTextBoxContent(context,image.color,data.cachedStats,modality,hasPixelSpacing,_this2.configuration);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.drawLinkedTextBox)(context,element,data.handles.textBox,textBoxContent,data.handles,textBoxAnchorPoints,color,lineWidth,0,!0)}})}}]);return RectangleRoiTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),_throttledUpdateCachedStats=Object(_util_throttle_js__WEBPACK_IMPORTED_MODULE_13__["default"])(_updateCachedStats,110);function _updateCachedStats(image,element,data,modality,pixelSpacing){var stats=_calculateStats(image,element,data.handles,modality,pixelSpacing);data.cachedStats=stats;data.invalidated=!1}function _getRectangleImageCoordinates(startHandle,endHandle){return{left:_Mathmin(startHandle.x,endHandle.x),top:_Mathmin(startHandle.y,endHandle.y),width:_Mathabs(startHandle.x-endHandle.x),height:_Mathabs(startHandle.y-endHandle.y)}}function _calculateStats(image,element,handles,modality,pixelSpacing){var roiCoordinates=_getRectangleImageCoordinates(handles.start,handles.end),pixels=_externalModules_js__WEBPACK_IMPORTED_MODULE_5__["default"].cornerstone.getPixels(element,roiCoordinates.left,roiCoordinates.top,roiCoordinates.width,roiCoordinates.height),roiMeanStdDev=_calculateRectangleStats(pixels,roiCoordinates),meanStdDevSUV;if("PT"===modality){meanStdDevSUV={mean:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,roiMeanStdDev.mean,!0)||0,stdDev:Object(_util_calculateSUV_js__WEBPACK_IMPORTED_MODULE_11__["default"])(image,roiMeanStdDev.stdDev,!0)||0}}var area=roiCoordinates.width*(pixelSpacing.columnPixelSpacing||1)*(roiCoordinates.height*(pixelSpacing.rowPixelSpacing||1));return{area:area||0,count:roiMeanStdDev.count||0,mean:roiMeanStdDev.mean||0,variance:roiMeanStdDev.variance||0,stdDev:roiMeanStdDev.stdDev||0,min:roiMeanStdDev.min||0,max:roiMeanStdDev.max||0,meanStdDevSUV:meanStdDevSUV}}function _calculateRectangleStats(sp,rectangle){for(var sum=0,sumSquared=0,count=0,index=0,min=sp?sp[0]:null,max=sp?sp[0]:null,y=rectangle.top;y<rectangle.top+rectangle.height;y++){for(var x=rectangle.left;x<rectangle.left+rectangle.width;x++){sum+=sp[index];sumSquared+=sp[index]*sp[index];min=_Mathmin(min,sp[index]);max=_Mathmax(max,sp[index]);count++;index++}}if(0===count){return{count:count,mean:0,variance:0,stdDev:0,min:0,max:0}}var mean=sum/count,variance=sumSquared/count-mean*mean;return{count:count,mean:mean,variance:variance,stdDev:_Mathsqrt(variance),min:min,max:max}}function _findTextBoxAnchorPoints(startHandle,endHandle){var _getRectangleImageCoo=_getRectangleImageCoordinates(startHandle,endHandle),left=_getRectangleImageCoo.left,top=_getRectangleImageCoo.top,width=_getRectangleImageCoo.width,height=_getRectangleImageCoo.height;return[{x:left+width/2,y:top},{x:left,y:top+height/2},{x:left+width/2,y:top+height},{x:left+width,y:top+height/2}]}function _formatArea(area,hasPixelSpacing){var suffix=hasPixelSpacing?" mm".concat("\xB2"):" px".concat("\xB2");return"Area: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__["default"])(area.toFixed(2))).concat(suffix)}function _createTextBoxContent(context,isColorImage,_ref,modality,hasPixelSpacing){var area=_ref.area,mean=_ref.mean,stdDev=_ref.stdDev,min=_ref.min,max=_ref.max,meanStdDevSUV=_ref.meanStdDevSUV,options=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},showMinMax=options.showMinMax||!1,showHounsfieldUnits=!1!==options.showHounsfieldUnits,textLines=[],otherLines=[];if(!isColorImage){var hasStandardUptakeValues=meanStdDevSUV&&0!==meanStdDevSUV.mean,suffix="CT"===modality&&showHounsfieldUnits?" HU":"",meanString="Mean: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__["default"])(mean.toFixed(2))).concat(suffix),stdDevString="Std Dev: ".concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__["default"])(stdDev.toFixed(2))).concat(suffix);if(hasStandardUptakeValues){var SUVtext=" SUV: ",meanSuvString="".concat(SUVtext).concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__["default"])(meanStdDevSUV.mean.toFixed(2))),stdDevSuvString="".concat(SUVtext).concat(Object(_util_numbersWithCommas_js__WEBPACK_IMPORTED_MODULE_12__["default"])(meanStdDevSUV.stdDev.toFixed(2))),targetStringLength=_Mathfloor(context.measureText("".concat(stdDevString,"     ")).width);while(context.measureText(meanString).width<targetStringLength){meanString+=" "}otherLines.push("".concat(meanString).concat(meanSuvString));otherLines.push("".concat(stdDevString,"     ").concat(stdDevSuvString))}else{otherLines.push("".concat(meanString,"     ").concat(stdDevString))}if(showMinMax){var minString="Min: ".concat(min).concat(suffix),maxString="Max: ".concat(max).concat(suffix),_targetStringLength=hasStandardUptakeValues?_Mathfloor(context.measureText("".concat(stdDevString,"     ")).width):_Mathfloor(context.measureText("".concat(meanString,"     ")).width);while(context.measureText(minString).width<_targetStringLength){minString+=" "}otherLines.push("".concat(minString).concat(maxString))}}textLines.push(_formatArea(area,hasPixelSpacing));otherLines.forEach(function(x){return textLines.push(x)});return textLines}},"./tools/annotation/TextMarkerTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return TextMarkerTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/base/BaseAnnotationTool.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./externalModules.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./util/pointInsideBoundingBox.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./stateManagement/toolColors.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./drawing/index.js"),_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./drawing/drawTextBox.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./stateManagement/toolState.js"),_cursors_index_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./tools/cursors/index.js"),TextMarkerTool=function(_BaseAnnotationTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(TextMarkerTool,_BaseAnnotationTool);function TextMarkerTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,TextMarkerTool);var defaultConfig={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:changeTextCallback},svgCursor:_cursors_index_js__WEBPACK_IMPORTED_MODULE_13__.textMarkerCursor},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(TextMarkerTool).call(this,initialConfiguration));_this.initialConfiguration=initialConfiguration;_this.touchPressCallback=_this._changeText.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.doubleClickCallback=_this._changeText.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(TextMarkerTool,[{key:"createNewMeasurement",value:function createNewMeasurement(eventData){var config=this.configuration;if(!config.current){return}var measurementData={visible:!0,active:!0,text:config.current,color:void 0,handles:{end:{x:eventData.currentPoints.image.x,y:eventData.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},imageRect={left:0,top:0,width:eventData.image.width,height:eventData.image.height};if(!_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.point.insideRect(measurementData.handles.end,imageRect)){return}var currentIndex=config.markers.indexOf(config.current),increment=config.ascending?1:-1;currentIndex+=increment;if(currentIndex>=config.markers.length){currentIndex=config.loop?0:-1}else if(0>currentIndex){currentIndex=config.loop?config.markers.length:-1}config.current=config.markers[currentIndex];return measurementData}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){if(!1===data.visible){return!1}if(!data.handles.end.boundingBox){return}var distanceToPoint=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstoneMath.rect.distanceToPoint(data.handles.end.boundingBox,coords),insideBoundingBox=Object(_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_8__["default"])(data.handles.end,coords);return 10>distanceToPoint||insideBoundingBox}},{key:"renderToolData",value:function renderToolData(evt){var eventData=evt.detail,config=this.configuration,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_12__.getToolState)(eventData.element,this.name);if(!toolData){return}for(var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.getNewContext)(eventData.canvasContext.canvas),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_9__["default"].getColorIfActive(data);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_10__.setShadow)(context,config);var textCoords=_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.pixelToCanvas(eventData.element,data.handles.end),options={centering:{x:!0,y:!0}};data.handles.end.boundingBox=Object(_drawing_drawTextBox_js__WEBPACK_IMPORTED_MODULE_11__["default"])(context,data.text,textCoords.x,textCoords.y-10,color,options)})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}}},{key:"_changeText",value:function _changeText(evt){var eventData=evt.detail,element=eventData.element,currentPoints=eventData.currentPoints,data;function doneChangingTextCallback(data,updatedText,deleteTool){if(!0===deleteTool){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_12__.removeToolState)(element,this.name,data)}else{data.text=updatedText}data.active=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(element)}var config=this.configuration,coords=currentPoints.canvas,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_12__.getToolState)(element,this.name);if(!toolData){return}for(var i=0;i<toolData.data.length;i++){data=toolData.data[i];if(this.pointNearTool(element,data,coords)){data.active=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_7__["default"].cornerstone.updateImage(element);config.changeTextCallback(data,eventData,doneChangingTextCallback);evt.stopImmediatePropagation();evt.preventDefault();evt.stopPropagation();return}}}}]);return TextMarkerTool}(_base_BaseAnnotationTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]),changeTextCallback=function changeTextCallback(data,eventData,doneChangingTextCallback){doneChangingTextCallback(data,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_events_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./events.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/index.js"),_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./stateManagement/toolState.js");__webpack_exports__["default"]=function(evt,interactionType){var _this=this,eventData=evt.detail,element=eventData.element,image=eventData.image,config=this.configuration;if(checkPixelSpacing(image)){return}var measurementData=this.createNewMeasurement(eventData),doneCallback=function doneCallback(){measurementData.active=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element)};Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.addToolState)(element,this.name,measurementData);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var timestamp=new Date().getTime(),_measurementData$hand=measurementData.handles,end=_measurementData$hand.end,perpendicularStart=_measurementData$hand.perpendicularStart;Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__.moveNewHandle)(eventData,this.name,measurementData,end,{doneMovingCallback:function doneMovingCallback(){var handles=measurementData.handles,longestDiameter=measurementData.longestDiameter,shortestDiameter=measurementData.shortestDiameter,hasHandlesOutside=Object(_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData,handles),longestDiameterSize=parseFloat(longestDiameter)||0,shortestDiameterSize=parseFloat(shortestDiameter)||0,isTooSmal=1>longestDiameterSize||1>shortestDiameterSize,isTooFast=150>new Date().getTime()-timestamp;if(hasHandlesOutside||isTooSmal||isTooFast){measurementData.cancelled=!0;Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_5__.removeToolState)(element,_this.name,measurementData)}else{config.getMeasurementLocationCallback(measurementData,eventData,doneCallback)}perpendicularStart.locked=!1;_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var modifiedEventData={toolType:_this.name,element:element,measurementData:measurementData};Object(_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__["default"])(eventData,measurementData);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.triggerEvent(element,_events_js__WEBPACK_IMPORTED_MODULE_1__["default"].MEASUREMENT_MODIFIED,modifiedEventData)}},interactionType)};var checkPixelSpacing=function checkPixelSpacing(image){var imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId),rowPixelSpacing=image.rowPixelSpacing,colPixelSpacing=image.columnPixelSpacing;if(imagePlane){rowPixelSpacing=imagePlane.rowPixelSpacing||imagePlane.rowImagePixelSpacing;colPixelSpacing=imagePlane.columnPixelSpacing||imagePlane.colImagePixelSpacing}return!rowPixelSpacing||!colPixelSpacing}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var getHandle=function getHandle(x,y,index){var extraAttributes=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:x,y:y,index:index,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},extraAttributes)};__webpack_exports__["default"]=function(mouseEventData){var _mouseEventData$curre=mouseEventData.currentPoints.image,x=_mouseEventData$curre.x,y=_mouseEventData$curre.y,measurementData={toolType:this.name,isCreating:!0,visible:!0,active:!0,handles:{start:getHandle(x,y,0),end:getHandle(x,y,1,{active:!0}),perpendicularStart:getHandle(x,y,2,{locked:!0}),perpendicularEnd:getHandle(x,y,3),textBox:getHandle(x-50,y-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0};return measurementData}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(evt,toolData,handle){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse";if("touch"===interactionType){this.handleSelectedTouchCallback(evt)}else{this.handleSelectedMouseCallback(evt)}}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/index.js"),_events_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./events.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./manipulators/getHandleNearImagePoint.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./manipulators/index.js"),_moveHandle_moveHandle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),_invertHandles_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/annotation/bidirectionalTool/invertHandles.js"),_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./store/setToolCursor.js");__webpack_exports__["default"]=function(evt){var _this=this,eventData=evt.detail,element=eventData.element,data,distanceThreshold=_store_index_js__WEBPACK_IMPORTED_MODULE_2__.state.clickProximity,handleDoneMove=function handleDoneMove(handle){data.invalidated=!0;if(Object(_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_5__["default"])(eventData,data.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__.removeToolState)(element,_this.name,data)}if(handle){handle.moving=!1;handle.selected=!0}Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_10__.setToolCursor)(_this.element,_this.svgCursor);_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].MOUSE_MOVE,_this._moveCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_START,_this._moveCallback)},coords=eventData.startPoints.canvas,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}for(var _loop=function _loop(i){data=toolData.data[i];var handleParams=[element,data.handles,coords,distanceThreshold],handle=_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__["default"].apply(void 0,handleParams);if(handle){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].MOUSE_MOVE,_this._moveCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_START,_this._moveCallback);data.active=!0;unselectAllHandles(data.handles);handle.moving=!0;handle=Object(_invertHandles_js__WEBPACK_IMPORTED_MODULE_9__["default"])(eventData,data,handle);if(!handle.hasBoundingBox){Object(_store_setToolCursor_js__WEBPACK_IMPORTED_MODULE_10__.hideToolCursor)(_this.element)}Object(_moveHandle_moveHandle_js__WEBPACK_IMPORTED_MODULE_8__["default"])(eventData,_this.name,data,handle,function(){return handleDoneMove(handle)});preventPropagation(evt);return{v:!0}}},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(_ret))return _ret.v}for(var getDoneMovingCallback=function getDoneMovingCallback(handles){return function(){setHandlesMovingState(handles,!1);handleDoneMove()}},i=0;i<toolData.data.length;i++){data=toolData.data[i];if(this.pointNearTool(element,data,coords,"mouse")){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].MOUSE_MOVE,this._moveCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_START,this._moveCallback);data.active=!0;unselectAllHandles(data.handles);setHandlesMovingState(data.handles,!0);var doneMovingCallback=getDoneMovingCallback(data.handles);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__.moveAllHandles)(eventData,this.name,data,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:doneMovingCallback},"mouse");preventPropagation(evt);return!0}}};var unselectAllHandles=function unselectAllHandles(handles){var imageNeedsUpdate=!1;Object.keys(handles).forEach(function(handleKey){if("textBox"===handleKey){return}handles[handleKey].selected=!1;imageNeedsUpdate=handles[handleKey].active||imageNeedsUpdate;handles[handleKey].active=!1});return imageNeedsUpdate},setHandlesMovingState=function setHandlesMovingState(handles,state){Object.keys(handles).forEach(function(handleKey){if("textBox"===handleKey){return}handles[handleKey].moving=state})},preventPropagation=function preventPropagation(evt){evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./store/index.js"),_events_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./events.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./manipulators/anyHandlesOutsideImage.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./manipulators/getHandleNearImagePoint.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./manipulators/index.js"),_moveHandle_touchMoveHandle_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");__webpack_exports__["default"]=function(evt){var _this=this,eventData=evt.detail,element=eventData.element,data,distanceThreshold=_store_index_js__WEBPACK_IMPORTED_MODULE_2__.state.touchProximity,handleDoneMove=function handleDoneMove(handle){data.invalidated=!0;if(Object(_manipulators_anyHandlesOutsideImage_js__WEBPACK_IMPORTED_MODULE_5__["default"])(eventData,data.handles)){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__.removeToolState)(element,_this.name,data)}if(handle){handle.moving=!1;handle.selected=!0}_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.updateImage(element);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_DRAG,_this._moveCallback)},coords=eventData.startPoints.canvas,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_4__.getToolState)(evt.currentTarget,this.name);if(!toolData){return}for(var _loop=function _loop(i){data=toolData.data[i];var handleParams=[element,data.handles,coords,distanceThreshold],handle=_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_6__["default"].apply(void 0,handleParams);if(handle){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_DRAG,_this._moveCallback);data.active=!0;unselectAllHandles(data.handles);handle.moving=!0;Object(_moveHandle_touchMoveHandle_js__WEBPACK_IMPORTED_MODULE_8__["default"])(eventData,_this.name,data,handle,function(){return handleDoneMove(handle)});preventPropagation(evt);return{v:!0}}},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(_ret))return _ret.v}for(var getDoneMovingCallback=function getDoneMovingCallback(handles){return function(){setHandlesMovingState(handles,!1);handleDoneMove()}},i=0;i<toolData.data.length;i++){data=toolData.data[i];if(this.pointNearTool(element,data,coords,"touch")){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_3__["default"].TOUCH_DRAG,this._moveCallback);data.active=!0;unselectAllHandles(data.handles);setHandlesMovingState(data.handles,!0);var doneMovingCallback=getDoneMovingCallback(data.handles);Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_7__.moveAllHandles)(eventData,this.name,data,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,doneMovingCallback:doneMovingCallback},"touch");preventPropagation(evt);return!0}}};var unselectAllHandles=function unselectAllHandles(handles){var imageNeedsUpdate=!1;Object.keys(handles).forEach(function(handleKey){if("textBox"===handleKey){return}handles[handleKey].selected=!1;imageNeedsUpdate=handles[handleKey].active||imageNeedsUpdate;handles[handleKey].active=!1});return imageNeedsUpdate},setHandlesMovingState=function setHandlesMovingState(handles,state){Object.keys(handles).forEach(function(handleKey){if("textBox"===handleKey){return}handles[handleKey].moving=state})},preventPropagation=function preventPropagation(evt){evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return invertHandles});var swapAttribute=function swapAttribute(a,b,attribute){var originalA=a[attribute],originalB=b[attribute];a[attribute]=originalB;b[attribute]=originalA},swapHandles=function swapHandles(a,b){swapAttribute(a,b,"x");swapAttribute(a,b,"y");swapAttribute(a,b,"moving");swapAttribute(a,b,"hover");swapAttribute(a,b,"active");swapAttribute(a,b,"selected")};function invertHandles(eventData,measurementData,handle){var _eventData$image=eventData.image,rowPixelSpacing=_eventData$image.rowPixelSpacing,columnPixelSpacing=_eventData$image.columnPixelSpacing,handles=measurementData.handles,start=handles.start,end=handles.end,perpendicularStart=handles.perpendicularStart,perpendicularEnd=handles.perpendicularEnd,dx=(start.x-end.x)*(columnPixelSpacing||1),dy=(start.y-end.y)*(rowPixelSpacing||1),length=_Mathsqrt(dx*dx+dy*dy),wx=(perpendicularStart.x-perpendicularEnd.x)*(columnPixelSpacing||1),wy=(perpendicularStart.y-perpendicularEnd.y)*(rowPixelSpacing||1),width=_Mathsqrt(wx*wx+wy*wy)||0;if(width>length){swapHandles(start,end);swapHandles(start,perpendicularStart);swapHandles(end,perpendicularEnd);return Object.values(handles).find(function(h){return!0===h.moving})}return handle}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_stateManagement_toolCoordinates_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolCoordinates.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/getHandleNearImagePoint.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./stateManagement/toolState.js"),handleActivator=function handleActivator(element,handles,canvasPoint){var distanceThreshold=3<arguments.length&&void 0!==arguments[3]?arguments[3]:6,nearbyHandle=Object(_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_2__["default"])(element,handles,canvasPoint,distanceThreshold),handleActivatorChanged=!1;Object.keys(handles).forEach(function(handleKey){if("textBox"===handleKey){return}var handle=handles[handleKey],newActiveState=handle===nearbyHandle;if(handle.active!==newActiveState){handleActivatorChanged=!0}handle.active=newActiveState});return handleActivatorChanged};__webpack_exports__["default"]=function(event){var _this=this,eventData=event.detail,element=eventData.element;_stateManagement_toolCoordinates_js__WEBPACK_IMPORTED_MODULE_1__["default"].setCoords(eventData);var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_3__.getToolState)(element,this.name);if(!toolData){return}for(var imageNeedsUpdate=!1,_loop=function _loop(i){var coords=eventData.currentPoints.canvas,data=toolData.data[i],handleActivatorChanged=handleActivator(element,data.handles,coords);Object.keys(data.handles).forEach(function(handleKey){if("textBox"===handleKey){return}var handle=data.handles[handleKey];handle.hover=handle.active});if(handleActivatorChanged){imageNeedsUpdate=!0}var nearTool=_this.pointNearTool(element,data,coords,"mouse"),nearToolAndInactive=nearTool&&!data.active,notNearToolAndActive=!nearTool&&data.active;if(nearToolAndInactive||notNearToolAndActive){data.active=!data.active;imageNeedsUpdate=!0}},i=0;i<toolData.data.length;i++){_loop(i)}if(!0===imageNeedsUpdate){_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element)}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/index.js"),_events_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./events.js"),_setHandlesPosition_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js");__webpack_exports__["default"]=function(mouseEventData,toolType,data,handle,doneMovingCallback,preventHandleOutsideImage){var element=mouseEventData.element,distanceFromTool={x:handle.x-mouseEventData.currentPoints.image.x,y:handle.y-mouseEventData.currentPoints.image.y},_dragCallback=function _dragCallback(event){var eventData=event.detail;handle.hasMoved=!0;if(void 0===handle.index||null===handle.index){handle.x=eventData.currentPoints.image.x+distanceFromTool.x;handle.y=eventData.currentPoints.image.y+distanceFromTool.y}else{Object(_setHandlesPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"])(handle,eventData,data,distanceFromTool)}if(preventHandleOutsideImage){handle.x=_Mathmax(handle.x,0);handle.x=_Mathmin(handle.x,eventData.image.width);handle.y=_Mathmax(handle.y,0);handle.y=_Mathmin(handle.y,eventData.image.height)}_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var modifiedEventData={toolType:toolType,element:element,measurementData:data};Object(_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__["default"])(mouseEventData,data);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.triggerEvent(element,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MEASUREMENT_MODIFIED,modifiedEventData)};handle.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked=!0;element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_DRAG,_dragCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG,_dragCallback);var currentImage=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getImage(element),imageRenderedHandler=function imageRenderedHandler(){var newImage=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getImage(element);if(newImage.imageId!==currentImage.imageId){interactionEndCallback()}};element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.IMAGE_RENDERED,imageRenderedHandler);var interactionEndCallback=function interactionEndCallback(){handle.active=!1;_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked=!1;element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.EVENTS.IMAGE_RENDERED,imageRenderedHandler);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_DRAG,_dragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_UP,interactionEndCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_CLICK,interactionEndCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG,_dragCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG_END,interactionEndCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TAP,interactionEndCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);if("function"===typeof doneMovingCallback){doneMovingCallback()}};element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_UP,interactionEndCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MOUSE_CLICK,interactionEndCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG_END,interactionEndCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TAP,interactionEndCallback)}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(proposedPoint,data){var distance=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance,_data$handles=data.handles,start=_data$handles.start,end=_data$handles.end,perpendicularStart=_data$handles.perpendicularStart,perpendicularEnd=_data$handles.perpendicularEnd,longLine={start:{x:start.x,y:start.y},end:{x:end.x,y:end.y}},perpendicularLine={start:{x:perpendicularStart.x,y:perpendicularStart.y},end:{x:perpendicularEnd.x,y:perpendicularEnd.y}},intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine),distanceFromPerpendicularP1=distance(perpendicularStart,intersection),distanceFromPerpendicularP2=distance(perpendicularEnd,intersection),distanceToLineP2=distance(end,intersection),newLineLength=distance(end,proposedPoint);if(newLineLength<=distanceToLineP2){return!1}var dx=(end.x-proposedPoint.x)/newLineLength,dy=(end.y-proposedPoint.y)/newLineLength,k=distanceToLineP2/newLineLength,newIntersection={x:end.x+(proposedPoint.x-end.x)*k,y:end.y+(proposedPoint.y-end.y)*k};perpendicularStart.x=newIntersection.x-distanceFromPerpendicularP1*dy;perpendicularStart.y=newIntersection.y+distanceFromPerpendicularP1*dx;perpendicularEnd.x=newIntersection.x+distanceFromPerpendicularP2*dy;perpendicularEnd.y=newIntersection.y-distanceFromPerpendicularP2*dx;return!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(proposedPoint,data){var distance=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance,_data$handles=data.handles,start=_data$handles.start,end=_data$handles.end,perpendicularStart=_data$handles.perpendicularStart,perpendicularEnd=_data$handles.perpendicularEnd,longLine={start:{x:start.x,y:start.y},end:{x:end.x,y:end.y}},perpendicularLine={start:{x:perpendicularStart.x,y:perpendicularStart.y},end:{x:perpendicularEnd.x,y:perpendicularEnd.y}},intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine),distanceFromPerpendicularP1=distance(perpendicularStart,intersection),distanceFromPerpendicularP2=distance(perpendicularEnd,intersection),distanceToLineP2=distance(start,intersection),newLineLength=distance(start,proposedPoint);if(newLineLength<=distanceToLineP2){return!1}var dx=(start.x-proposedPoint.x)/newLineLength,dy=(start.y-proposedPoint.y)/newLineLength,k=distanceToLineP2/newLineLength,newIntersection={x:start.x+(proposedPoint.x-start.x)*k,y:start.y+(proposedPoint.y-start.y)*k};perpendicularStart.x=newIntersection.x+distanceFromPerpendicularP1*dy;perpendicularStart.y=newIntersection.y-distanceFromPerpendicularP1*dx;perpendicularEnd.x=newIntersection.x-distanceFromPerpendicularP2*dy;perpendicularEnd.y=newIntersection.y+distanceFromPerpendicularP2*dx;return!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(movedPoint,data){var distance=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance,_data$handles=data.handles,start=_data$handles.start,end=_data$handles.end,perpendicularStart=_data$handles.perpendicularStart,perpendicularEnd=_data$handles.perpendicularEnd,fudgeFactor=1,fixedPoint=perpendicularEnd,distanceFromFixed=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.distanceToPoint(data.handles,fixedPoint),distanceFromMoved=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.distanceToPoint(data.handles,movedPoint),distanceBetweenPoints=distance(fixedPoint,movedPoint),total=distanceFromFixed+distanceFromMoved;if(distanceBetweenPoints<=distanceFromFixed){return!1}var length=distance(start,end);if(0===length){return!1}var dx=(start.x-end.x)/length,dy=(start.y-end.y)/length,adjustedLineP1={x:start.x-fudgeFactor*dx,y:start.y-fudgeFactor*dy},adjustedLineP2={x:end.x+fudgeFactor*dx,y:end.y+fudgeFactor*dy};perpendicularStart.x=movedPoint.x;perpendicularStart.y=movedPoint.y;perpendicularEnd.x=movedPoint.x-total*dy;perpendicularEnd.y=movedPoint.y+total*dx;var longLine={start:{x:start.x,y:start.y},end:{x:end.x,y:end.y}},perpendicularLine={start:{x:perpendicularStart.x,y:perpendicularStart.y},end:{x:perpendicularEnd.x,y:perpendicularEnd.y}},intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);if(!intersection){if(distance(movedPoint,start)>distance(movedPoint,end)){perpendicularStart.x=adjustedLineP2.x+distanceFromMoved*dy;perpendicularStart.y=adjustedLineP2.y-distanceFromMoved*dx;perpendicularEnd.x=perpendicularStart.x-total*dy;perpendicularEnd.y=perpendicularStart.y+total*dx}else{perpendicularStart.x=adjustedLineP1.x+distanceFromMoved*dy;perpendicularStart.y=adjustedLineP1.y-distanceFromMoved*dx;perpendicularEnd.x=perpendicularStart.x-total*dy;perpendicularEnd.y=perpendicularStart.y+total*dx}}return!0}},"./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(movedPoint,data){var distance=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance,_data$handles=data.handles,start=_data$handles.start,end=_data$handles.end,perpendicularStart=_data$handles.perpendicularStart,perpendicularEnd=_data$handles.perpendicularEnd,fudgeFactor=1,fixedPoint=perpendicularStart,distanceFromFixed=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.distanceToPoint(data.handles,fixedPoint),distanceFromMoved=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.distanceToPoint(data.handles,movedPoint),distanceBetweenPoints=distance(fixedPoint,movedPoint),total=distanceFromFixed+distanceFromMoved;if(distanceBetweenPoints<=distanceFromFixed){return!1}var length=distance(start,end),dx=(start.x-end.x)/length,dy=(start.y-end.y)/length,adjustedLineP1={x:start.x-fudgeFactor*dx,y:start.y-fudgeFactor*dy},adjustedLineP2={x:end.x+fudgeFactor*dx,y:end.y+fudgeFactor*dy};perpendicularStart.x=movedPoint.x+total*dy;perpendicularStart.y=movedPoint.y-total*dx;perpendicularEnd.x=movedPoint.x;perpendicularEnd.y=movedPoint.y;perpendicularEnd.locked=!1;perpendicularStart.locked=!1;var longLine={start:{x:start.x,y:start.y},end:{x:end.x,y:end.y}},perpendicularLine={start:{x:perpendicularStart.x,y:perpendicularStart.y},end:{x:perpendicularEnd.x,y:perpendicularEnd.y}},intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);if(!intersection){if(distance(movedPoint,start)>distance(movedPoint,end)){perpendicularEnd.x=adjustedLineP2.x-distanceFromMoved*dy;perpendicularEnd.y=adjustedLineP2.y+distanceFromMoved*dx;perpendicularStart.x=perpendicularEnd.x+total*dy;perpendicularStart.y=perpendicularEnd.y-total*dx}else{perpendicularEnd.x=adjustedLineP1.x-distanceFromMoved*dy;perpendicularEnd.y=adjustedLineP1.y+distanceFromMoved*dx;perpendicularStart.x=perpendicularEnd.x+total*dy;perpendicularStart.y=perpendicularEnd.y-total*dx}}return!0}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_perpendicularBothFixedLeft_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedLeft.js"),_perpendicularBothFixedRight_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/perpendicularBothFixedRight.js"),_perpendicularLeftFixedPoint_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/perpendicularLeftFixedPoint.js"),_perpendicularRightFixedPoint_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/perpendicularRightFixedPoint.js");__webpack_exports__["default"]=function(handle,eventData,data,distanceFromTool){var movedPoint,outOfBounds,result,intersection,d1,d2,longLine={},perpendicularLine={},proposedPoint={x:eventData.currentPoints.image.x+distanceFromTool.x,y:eventData.currentPoints.image.y+distanceFromTool.y};if(0===handle.index){result=Object(_perpendicularBothFixedLeft_js__WEBPACK_IMPORTED_MODULE_1__["default"])(proposedPoint,data);if(result){handle.x=proposedPoint.x;handle.y=proposedPoint.y}else{eventData.currentPoints.image.x=handle.x;eventData.currentPoints.image.y=handle.y}}else if(1===handle.index){result=Object(_perpendicularBothFixedRight_js__WEBPACK_IMPORTED_MODULE_2__["default"])(proposedPoint,data);if(result){handle.x=proposedPoint.x;handle.y=proposedPoint.y}else{eventData.currentPoints.image.x=handle.x;eventData.currentPoints.image.y=handle.y}}else if(2===handle.index){outOfBounds=!1;longLine.start={x:data.handles.start.x,y:data.handles.start.y};longLine.end={x:data.handles.end.x,y:data.handles.end.y};perpendicularLine.start={x:data.handles.perpendicularEnd.x,y:data.handles.perpendicularEnd.y};perpendicularLine.end={x:proposedPoint.x,y:proposedPoint.y};intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);if(!intersection){perpendicularLine.end={x:data.handles.perpendicularStart.x,y:data.handles.perpendicularStart.y};intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);d1=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance(intersection,data.handles.start);d2=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance(intersection,data.handles.end);if(!intersection||3>d1||3>d2){outOfBounds=!0}}movedPoint=!1;if(!outOfBounds){movedPoint=Object(_perpendicularLeftFixedPoint_js__WEBPACK_IMPORTED_MODULE_3__["default"])(proposedPoint,data);if(!movedPoint){eventData.currentPoints.image.x=data.handles.perpendicularStart.x;eventData.currentPoints.image.y=data.handles.perpendicularStart.y}}}else if(3===handle.index){outOfBounds=!1;longLine.start={x:data.handles.start.x,y:data.handles.start.y};longLine.end={x:data.handles.end.x,y:data.handles.end.y};perpendicularLine.start={x:data.handles.perpendicularStart.x,y:data.handles.perpendicularStart.y};perpendicularLine.end={x:proposedPoint.x,y:proposedPoint.y};intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);if(!intersection){perpendicularLine.end={x:data.handles.perpendicularEnd.x,y:data.handles.perpendicularEnd.y};intersection=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.intersectLine(longLine,perpendicularLine);d1=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance(intersection,data.handles.start);d2=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.distance(intersection,data.handles.end);if(!intersection||3>d1||3>d2){outOfBounds=!0}}movedPoint=!1;if(!outOfBounds){movedPoint=Object(_perpendicularRightFixedPoint_js__WEBPACK_IMPORTED_MODULE_4__["default"])(proposedPoint,data);if(!movedPoint){eventData.currentPoints.image.x=data.handles.perpendicularEnd.x;eventData.currentPoints.image.y=data.handles.perpendicularEnd.y}}}}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./store/index.js"),_events_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./events.js"),_setHandlesPosition_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),touchEndEvents=[_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_END,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG_END,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_PINCH,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_PRESS,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TAP];__webpack_exports__["default"]=function(mouseEventData,toolType,data,handle,doneMovingCallback,preventHandleOutsideImage){var element=mouseEventData.element,distanceFromTool={x:handle.x-mouseEventData.currentPoints.image.x,y:handle.y-mouseEventData.currentPoints.image.y},touchDragCallback=function touchDragCallback(event){var eventData=event.detail;handle.hasMoved=!0;if(void 0===handle.index||null===handle.index){handle.x=eventData.currentPoints.image.x+distanceFromTool.x;handle.y=eventData.currentPoints.image.y+distanceFromTool.y}else{Object(_setHandlesPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"])(handle,eventData,data,distanceFromTool)}if(preventHandleOutsideImage){handle.x=_Mathmax(handle.x,0);handle.x=_Mathmin(handle.x,eventData.image.width);handle.y=_Mathmax(handle.y,0);handle.y=_Mathmin(handle.y,eventData.image.height)}_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);var modifiedEventData={toolType:toolType,element:element,measurementData:data};Object(_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__["default"])(mouseEventData,data);_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.triggerEvent(element,_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].MEASUREMENT_MODIFIED,modifiedEventData)};handle.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked=!0;element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG,touchDragCallback);var touchEndCallback=function touchEndCallback(){handle.active=!1;_store_index_js__WEBPACK_IMPORTED_MODULE_1__.state.isToolLocked=!1;element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_2__["default"].TOUCH_DRAG,touchDragCallback);touchEndEvents.forEach(function(eventType){element.removeEventListener(eventType,touchEndCallback)});_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.updateImage(element);if("function"===typeof doneMovingCallback){doneMovingCallback()}};touchEndEvents.forEach(function(eventType){element.addEventListener(eventType,touchEndCallback)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/pointInsideBoundingBox.js"),pointNearPerpendicular=function pointNearPerpendicular(element,handles,coords,distanceThreshold){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone,cornerstoneMath=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath,lineSegment={start:cornerstone.pixelToCanvas(element,handles.perpendicularStart),end:cornerstone.pixelToCanvas(element,handles.perpendicularEnd)},distanceToPoint=cornerstoneMath.lineSegment.distanceToPoint(lineSegment,coords);return distanceToPoint<distanceThreshold};__webpack_exports__["default"]=function(element,data,coords){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse",cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone,cornerstoneMath=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstoneMath,handles=data.handles,lineSegment={start:cornerstone.pixelToCanvas(element,handles.start),end:cornerstone.pixelToCanvas(element,handles.end)},distanceToPoint=cornerstoneMath.lineSegment.distanceToPoint(lineSegment,coords);if(Object(_util_pointInsideBoundingBox_js__WEBPACK_IMPORTED_MODULE_2__["default"])(handles.textBox,coords)){return!0}var distanceThreshold="mouse"===interactionType?_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.clickProximity:_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.touchProximity;if(pointNearPerpendicular(element,handles,coords,distanceThreshold)){return!0}return distanceToPoint<distanceThreshold}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./drawing/drawHandles.js"),_utils_updatePerpendicularLineHandles_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./stateManagement/toolStyle.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./stateManagement/toolColors.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./stateManagement/toolState.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./drawing/index.js"),_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./drawing/drawLinkedTextBox.js");__webpack_exports__["default"]=function(evt){var _this=this,eventData=evt.detail,element=eventData.element,canvasContext=eventData.canvasContext,image=eventData.image,_this$configuration=this.configuration,handleRadius=_this$configuration.handleRadius,drawHandlesOnHover=_this$configuration.drawHandlesOnHover,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_7__.getToolState)(element,this.name);if(!toolData){return}var imagePlane=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone.metaData.get("imagePlaneModule",image.imageId),rowPixelSpacing=image.rowPixelSpacing,colPixelSpacing=image.columnPixelSpacing;if(imagePlane){rowPixelSpacing=imagePlane.rowPixelSpacing||imagePlane.rowImagePixelSpacing;colPixelSpacing=imagePlane.columnPixelSpacing||imagePlane.colImagePixelSpacing}if(!rowPixelSpacing||!colPixelSpacing){return}for(var context=Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.getNewContext)(canvasContext.canvas),color,activeColor=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_6__["default"].getActiveColor(),lineWidth=_stateManagement_toolStyle_js__WEBPACK_IMPORTED_MODULE_5__["default"].getToolWidth(),_loop=function _loop(i){var data=toolData.data[i];if(!1===data.visible){return"continue"}color=data.active?activeColor:_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_6__["default"].getToolColor();Object(_utils_calculateLongestAndShortestDiameters_js__WEBPACK_IMPORTED_MODULE_4__["default"])(eventData,data);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.setShadow)(context,_this.configuration);var _data$handles=data.handles,start=_data$handles.start,end=_data$handles.end,perpendicularStart=_data$handles.perpendicularStart,perpendicularEnd=_data$handles.perpendicularEnd,textBox=_data$handles.textBox;Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.drawLine)(context,element,start,end,{color:color});var strokeWidth=lineWidth;Object(_utils_updatePerpendicularLineHandles_js__WEBPACK_IMPORTED_MODULE_3__["default"])(eventData,data);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_8__.drawLine)(context,element,perpendicularStart,perpendicularEnd,{color:color,strokeWidth:strokeWidth});var handleOptions={color:color,handleRadius:handleRadius,drawHandlesIfActive:drawHandlesOnHover};Object(_drawing_drawHandles_js__WEBPACK_IMPORTED_MODULE_2__["default"])(context,eventData,data.handles,handleOptions);var xOffset=10,textBoxAnchorPoints=function textBoxAnchorPoints(handles){return[handles.start,handles.end,handles.perpendicularStart,handles.perpendicularEnd]},textLines=getTextBoxText(data,rowPixelSpacing,colPixelSpacing);Object(_drawing_drawLinkedTextBox_js__WEBPACK_IMPORTED_MODULE_9__["default"])(context,element,textBox,textLines,data.handles,textBoxAnchorPoints,color,lineWidth,xOffset,!0)})},i=0,_ret;i<toolData.data.length;i++){_ret=_loop(i);if("continue"===_ret)continue}};var getTextBoxText=function getTextBoxText(data,rowPixelSpacing,colPixelSpacing){var suffix=" mm";if(!rowPixelSpacing||!colPixelSpacing){suffix=" pixels"}var lengthText=" L ".concat(data.longestDiameter).concat(suffix),widthText=" W ".concat(data.shortestDiameter).concat(suffix),labels=data.labels;if(labels&&Array.isArray(labels)){return[].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(labels),[lengthText,widthText])}return[lengthText,widthText]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return calculateLongestAndShortestDiameters});function calculateLongestAndShortestDiameters(eventData,measurementData){var _eventData$image=eventData.image,rowPixelSpacing=_eventData$image.rowPixelSpacing,columnPixelSpacing=_eventData$image.columnPixelSpacing,_measurementData$hand=measurementData.handles,start=_measurementData$hand.start,end=_measurementData$hand.end,perpendicularStart=_measurementData$hand.perpendicularStart,perpendicularEnd=_measurementData$hand.perpendicularEnd,dx=(start.x-end.x)*(columnPixelSpacing||1),dy=(start.y-end.y)*(rowPixelSpacing||1),length=_Mathsqrt(dx*dx+dy*dy),wx=(perpendicularStart.x-perpendicularEnd.x)*(columnPixelSpacing||1),wy=(perpendicularStart.y-perpendicularEnd.y)*(rowPixelSpacing||1),width=_Mathsqrt(wx*wx+wy*wy);if(!width){width=0}if(width>length){var tempW=width,tempL=length;length=tempW;width=tempL}measurementData.longestDiameter=length.toFixed(1);measurementData.shortestDiameter=width.toFixed(1)}},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(eventData,data){if(!data.handles.perpendicularStart.locked){return}var startX,startY,endX,endY,_data$handles=data.handles,start=_data$handles.start,end=_data$handles.end;if(start.x===end.x&&start.y===end.y){startX=start.x;startY=start.y;endX=end.x;endY=end.y}else{var mid={x:(start.x+end.x)/2,y:(start.y+end.y)/2},dx=(start.x-end.x)*(eventData.image.columnPixelSpacing||1),dy=(start.y-end.y)*(eventData.image.rowPixelSpacing||1),length=_Mathsqrt(dx*dx+dy*dy),vectorX=(start.x-end.x)/length,vectorY=(start.y-end.y)/length,perpendicularLineLength=length/2;startX=mid.x+perpendicularLineLength/2*vectorY;startY=mid.y-perpendicularLineLength/2*vectorX;endX=mid.x-perpendicularLineLength/2*vectorY;endY=mid.y+perpendicularLineLength/2*vectorX}data.handles.perpendicularStart.x=startX;data.handles.perpendicularStart.y=startY;data.handles.perpendicularEnd.x=endX;data.handles.perpendicularEnd.y=endY}},"./tools/annotation/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _AngleTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/annotation/AngleTool.js"),_ArrowAnnotateTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/annotation/ArrowAnnotateTool.js"),_BidirectionalTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./tools/annotation/BidirectionalTool.js"),_CobbAngleTool_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/annotation/CobbAngleTool.js"),_EllipticalRoiTool_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/annotation/EllipticalRoiTool.js"),_FreehandMouseTool_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./tools/annotation/FreehandMouseTool.js"),_LengthTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/annotation/LengthTool.js"),_ProbeTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/annotation/ProbeTool.js"),_RectangleRoiTool_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/annotation/RectangleRoiTool.js"),_TextMarkerTool_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/annotation/TextMarkerTool.js");__webpack_require__.d(__webpack_exports__,"AngleTool",function(){return _AngleTool_js__WEBPACK_IMPORTED_MODULE_0__["default"]});__webpack_require__.d(__webpack_exports__,"ArrowAnnotateTool",function(){return _ArrowAnnotateTool_js__WEBPACK_IMPORTED_MODULE_1__["default"]});__webpack_require__.d(__webpack_exports__,"BidirectionalTool",function(){return _BidirectionalTool_js__WEBPACK_IMPORTED_MODULE_2__["default"]});__webpack_require__.d(__webpack_exports__,"CobbAngleTool",function(){return _CobbAngleTool_js__WEBPACK_IMPORTED_MODULE_3__["default"]});__webpack_require__.d(__webpack_exports__,"EllipticalRoiTool",function(){return _EllipticalRoiTool_js__WEBPACK_IMPORTED_MODULE_4__["default"]});__webpack_require__.d(__webpack_exports__,"FreehandMouseTool",function(){return _FreehandMouseTool_js__WEBPACK_IMPORTED_MODULE_5__["default"]});__webpack_require__.d(__webpack_exports__,"LengthTool",function(){return _LengthTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]});__webpack_require__.d(__webpack_exports__,"ProbeTool",function(){return _ProbeTool_js__WEBPACK_IMPORTED_MODULE_7__["default"]});__webpack_require__.d(__webpack_exports__,"RectangleRoiTool",function(){return _RectangleRoiTool_js__WEBPACK_IMPORTED_MODULE_8__["default"]});__webpack_require__.d(__webpack_exports__,"TextMarkerTool",function(){return _TextMarkerTool_js__WEBPACK_IMPORTED_MODULE_9__["default"]});__webpack_exports__["default"]={AngleTool:_AngleTool_js__WEBPACK_IMPORTED_MODULE_0__["default"],ArrowAnnotateTool:_ArrowAnnotateTool_js__WEBPACK_IMPORTED_MODULE_1__["default"],BidirectionalTool:_BidirectionalTool_js__WEBPACK_IMPORTED_MODULE_2__["default"],CobbAngleTool:_CobbAngleTool_js__WEBPACK_IMPORTED_MODULE_3__["default"],EllipticalRoiTool:_EllipticalRoiTool_js__WEBPACK_IMPORTED_MODULE_4__["default"],FreehandMouseTool:_FreehandMouseTool_js__WEBPACK_IMPORTED_MODULE_5__["default"],LengthTool:_LengthTool_js__WEBPACK_IMPORTED_MODULE_6__["default"],ProbeTool:_ProbeTool_js__WEBPACK_IMPORTED_MODULE_7__["default"],RectangleRoiTool:_RectangleRoiTool_js__WEBPACK_IMPORTED_MODULE_8__["default"],TextMarkerTool:_TextMarkerTool_js__WEBPACK_IMPORTED_MODULE_9__["default"]}},"./tools/base/BaseAnnotationTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__),_BaseTool_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./tools/base/BaseTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./stateManagement/toolState.js"),_manipulators_handleActivator_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./manipulators/handleActivator.js"),_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./util/findAndMoveHelpers.js"),BaseAnnotationTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default()(BaseAnnotationTool,_BaseTool);function BaseAnnotationTool(_ref){var name=_ref.name,strategies=_ref.strategies,defaultStrategy=_ref.defaultStrategy,configuration=_ref.configuration,supportedInteractionTypes=_ref.supportedInteractionTypes,mixins=_ref.mixins,svgCursor=_ref.svgCursor;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,BaseAnnotationTool);return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(BaseAnnotationTool).call(this,{name:name,strategies:strategies,defaultStrategy:defaultStrategy,configuration:configuration,supportedInteractionTypes:supportedInteractionTypes,mixins:mixins,svgCursor:svgCursor}))}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseAnnotationTool,[{key:"createNewMeasurement",value:function createNewMeasurement(evt){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function pointNearTool(element,data,coords){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse";throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function distanceFromPoint(element,data,coords){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function renderToolData(evt){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function mouseMoveCallback(evt){for(var _evt$detail=evt.detail,element=_evt$detail.element,currentPoints=_evt$detail.currentPoints,coords=currentPoints.canvas,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_6__.getToolState)(element,this.name),imageNeedsUpdate=!1,d=0,data;d<toolState.data.length;d++){data=toolState.data[d];if(!0===Object(_manipulators_handleActivator_js__WEBPACK_IMPORTED_MODULE_7__["default"])(element,data.handles,coords)){imageNeedsUpdate=!0}var nearToolAndNotMarkedActive=this.pointNearTool(element,data,coords)&&!data.active,notNearToolAndMarkedActive=!this.pointNearTool(element,data,coords)&&data.active;if(nearToolAndNotMarkedActive||notNearToolAndMarkedActive){data.active=!data.active;imageNeedsUpdate=!0}}return imageNeedsUpdate}},{key:"handleSelectedCallback",value:function handleSelectedCallback(evt,toolData,handle){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse";Object(_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_8__.moveHandleNearImagePoint)(evt,this,toolData,handle,interactionType)}},{key:"toolSelectedCallback",value:function toolSelectedCallback(evt,annotation){var interactionType=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"mouse";Object(_util_findAndMoveHelpers_js__WEBPACK_IMPORTED_MODULE_8__.moveAnnotation)(evt,this,annotation,interactionType)}}]);return BaseAnnotationTool}(_BaseTool_js__WEBPACK_IMPORTED_MODULE_5__["default"]);__webpack_exports__["default"]=BaseAnnotationTool},"./tools/base/BaseBrushTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_events_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./events.js"),_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/base/BaseTool.js"),_store_isToolActive_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./store/isToolActive.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./store/index.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./stateManagement/toolState.js"),_stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./stateManagement/imageIdSpecificStateManager.js"),_store$modules$brush=_store_index_js__WEBPACK_IMPORTED_MODULE_10__["default"].modules.brush,state=_store$modules$brush.state,setters=_store$modules$brush.setters,BaseBrushTool=function(_BaseTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(BaseBrushTool,_BaseTool);function BaseBrushTool(_ref){var _this,name=_ref.name,strategies=_ref.strategies,defaultStrategy=_ref.defaultStrategy,configuration=_ref.configuration,supportedInteractionTypes=_ref.supportedInteractionTypes,mixins=_ref.mixins,svgCursor=_ref.svgCursor;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,BaseBrushTool);configuration.referencedToolData="brush";_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(BaseBrushTool).call(this,{name:name,strategies:strategies,defaultStrategy:defaultStrategy,configuration:configuration,supportedInteractionTypes:supportedInteractionTypes,mixins:mixins,svgCursor:svgCursor}));_this.updateOnMouseMove=!0;_this.hideDefaultCursor=!0;_this._drawing=!1;_this._drawingMouseUpCallback=_this._drawingMouseUpCallback.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BaseBrushTool,[{key:"renderBrush",value:function renderBrush(evt){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function _paint(evt){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function mouseDragCallback(evt){this._startPainting(evt)}},{key:"preMouseDownCallback",value:function preMouseDownCallback(evt){this._startPainting(evt);return!0}},{key:"_startPainting",value:function _startPainting(evt){var eventData=evt.detail,element=eventData.element;this._paint(evt);this._drawing=!0;this._startListeningForMouseUp(element);this._lastImageCoords=eventData.currentPoints.image}},{key:"mouseMoveCallback",value:function mouseMoveCallback(evt){var currentPoints=evt.detail.currentPoints;this._lastImageCoords=currentPoints.image}},{key:"passiveCallback",value:function passiveCallback(evt){_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(this.element)}},{key:"renderToolData",value:function renderToolData(evt){var eventData=evt.detail,element=eventData.element;if(Object(_store_isToolActive_js__WEBPACK_IMPORTED_MODULE_9__["default"])(element,this.name)){this.renderBrush(evt)}}},{key:"_getBrushColor",value:function _getBrushColor(drawId){var colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.colors.getColormap(state.colorMapId),colorArray=colormap.getColor(drawId);if(this._drawing){return"rgba(".concat(colorArray[[0]],", ").concat(colorArray[[1]],", ").concat(colorArray[[2]],", 1.0 )")}return"rgba(".concat(colorArray[[0]],", ").concat(colorArray[[1]],", ").concat(colorArray[[2]],", 0.8 )")}},{key:"_drawingMouseUpCallback",value:function _drawingMouseUpCallback(evt){var eventData=evt.detail,element=eventData.element;this._drawing=!1;this._mouseUpRender=!0;this._stopListeningForMouseUp(element)}},{key:"_startListeningForMouseUp",value:function _startListeningForMouseUp(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._drawingMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_CLICK,this._drawingMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._drawingMouseUpCallback);element.addEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_CLICK,this._drawingMouseUpCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}},{key:"_stopListeningForMouseUp",value:function _stopListeningForMouseUp(element){element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_UP,this._drawingMouseUpCallback);element.removeEventListener(_events_js__WEBPACK_IMPORTED_MODULE_7__["default"].MOUSE_CLICK,this._drawingMouseUpCallback);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element)}},{key:"nextSegmentation",value:function nextSegmentation(){var numberOfColors=this.constructor.getNumberOfColors(),drawId=state.drawColorId+1;if(drawId===numberOfColors){drawId=0}state.drawColorId=drawId}},{key:"previousSegmentation",value:function previousSegmentation(){var numberOfColors=this.constructor.getNumberOfColors(),drawId=state.drawColorId-1;if(0>drawId){drawId=numberOfColors-1}state.drawColorId=drawId}},{key:"increaseBrushSize",value:function increaseBrushSize(){var oldRadius=state.radius,newRadius=_Mathfloor(1.2*oldRadius);if(newRadius===oldRadius){newRadius+=1}setters.radius(newRadius)}},{key:"decreaseBrushSize",value:function decreaseBrushSize(){var oldRadius=state.radius,newRadius=_Mathfloor(.8*oldRadius);setters.radius(newRadius)}},{key:"showSegmentationOnElement",value:function showSegmentationOnElement(segIndex){var enabledElement=this._getEnabledElement(),enabledElementUID=enabledElement.uuid;setters.brushVisibilityForElement(enabledElementUID,segIndex,!0);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}},{key:"hideSegmentationOnElement",value:function hideSegmentationOnElement(segIndex){var enabledElement=this._getEnabledElement(),enabledElementUID=enabledElement.uuid;setters.brushVisibilityForElement(enabledElementUID,segIndex,!1);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}},{key:"showAllSegmentationsOnElement",value:function showAllSegmentationsOnElement(){for(var enabledElement=this._getEnabledElement(),enabledElementUID=enabledElement.uuid,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.colors.getColormap(state.colorMapId),numberOfColors=colormap.getNumberOfColors(),segIndex=0;segIndex<numberOfColors;segIndex++){setters.brushVisibilityForElement(enabledElementUID,segIndex,!0)}_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}},{key:"hideAllSegmentationsOnElement",value:function hideAllSegmentationsOnElement(){for(var enabledElement=this._getEnabledElement(),enabledElementUID=enabledElement.uuid,colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.colors.getColormap(state.colorMapId),numberOfColors=colormap.getNumberOfColors(),segIndex=0;segIndex<numberOfColors;segIndex++){setters.brushVisibilityForElement(enabledElementUID,segIndex,!1)}_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}},{key:"_getEnabledElement",value:function _getEnabledElement(){return _externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getEnabledElement(this.element)}},{key:"alpha",get:function get(){return state.alpha},set:function set(value){var enabledElement=this._getEnabledElement();state.alpha=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}},{key:"hiddenButActiveAlpha",get:function get(){return state.hiddenButActiveAlpha},set:function set(value){var enabledElement=this._getEnabledElement();state.hiddenButActiveAlpha=value;_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(enabledElement.element)}}],[{key:"getNumberOfColors",value:function getNumberOfColors(){var colormap=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.colors.getColormap(state.colorMapId);return colormap.getNumberOfColors()}},{key:"getReferencedToolDataName",value:function getReferencedToolDataName(){return"brush"}},{key:"invalidateBrushOnEnabledElement",value:function invalidateBrushOnEnabledElement(enabledElementUID){var element=_store_index_js__WEBPACK_IMPORTED_MODULE_10__["default"].getters.enabledElementByUID(enabledElementUID),stackToolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,"stack");if(!stackToolState){return}for(var imageIds=stackToolState.data[0].imageIds,toolState=_stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_12__.globalImageIdSpecificToolStateManager.saveToolState(),i=0,imageId;i<imageIds.length;i++){imageId=imageIds[i];if(toolState[imageId]&&toolState[imageId].brush){for(var brushData=toolState[imageId].brush.data,j=0;j<brushData.length;j++){if(brushData[j].pixelData){brushData[j].invalidated=!0}}}}_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(element,!0)}},{key:"getDataAsVolume",value:function getDataAsVolume(enabledElementUID){var element=_store_index_js__WEBPACK_IMPORTED_MODULE_10__["default"].getters.enabledElementByUID(enabledElementUID),stackToolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_11__.getToolState)(element,"stack");if(!stackToolState){return}for(var imageIds=stackToolState.data[0].imageIds,enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getEnabledElement(element),image=enabledElement.image,dim={xy:image.columns*image.rows,z:image.rows,xyz:image.columns*image.rows*imageIds.length},toolState=_stateManagement_imageIdSpecificStateManager_js__WEBPACK_IMPORTED_MODULE_12__.globalImageIdSpecificToolStateManager.saveToolState(),buffer=new ArrayBuffer(dim.xyz),uint8View=new Uint8Array(buffer),i=0,imageId;i<imageIds.length;i++){imageId=imageIds[i];if(toolState[imageId]&&toolState[imageId].brush&&toolState[imageId].brush.data[0].pixelData){}}}}]);return BaseBrushTool}(_BaseTool_js__WEBPACK_IMPORTED_MODULE_8__["default"]);__webpack_exports__["default"]=BaseBrushTool},"./tools/base/BaseTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__),_mixins_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./mixins/index.js"),_util_logger_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/logger.js"),logger=Object(_util_logger_js__WEBPACK_IMPORTED_MODULE_4__.getLogger)("tools:base:BaseTool"),BaseTool=function(){function BaseTool(){var _ref=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},name=_ref.name,strategies=_ref.strategies,defaultStrategy=_ref.defaultStrategy,configuration=_ref.configuration,supportedInteractionTypes=_ref.supportedInteractionTypes,mixins=_ref.mixins,svgCursor=_ref.svgCursor;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,BaseTool);this.name=name;this.mode="disabled";this.element=void 0;this.supportedInteractionTypes=supportedInteractionTypes||[];this.strategies=strategies||{};this.defaultStrategy=defaultStrategy||Object.keys(this.strategies)[0]||void 0;this.activeStrategy=this.defaultStrategy;if(svgCursor){this.svgCursor=svgCursor}this._options={};this._configuration=Object.assign({},configuration);this.updateOnMouseMove=!1;this.hideDefaultCursor=!1;if(mixins&&mixins.length){this._applyMixins(mixins)}}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(BaseTool,[{key:"mergeOptions",value:function mergeOptions(options){this._options=Object.assign({},this._options,options)}},{key:"clearOptions",value:function clearOptions(){this._options={}}},{key:"applyActiveStrategy",value:function applyActiveStrategy(evt){return this.strategies[this.activeStrategy](evt,this.configuration)}},{key:"_applyMixins",value:function _applyMixins(mixinsArray){for(var i=0,mixin;i<mixinsArray.length;i++){mixin=_mixins_index_js__WEBPACK_IMPORTED_MODULE_3__["default"]["".concat(mixinsArray[i])];if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(mixin)){Object.assign(this,mixin)}else{logger.warn("".concat(this.name,": mixin ").concat(_mixins_index_js__WEBPACK_IMPORTED_MODULE_3__["default"][i]," does not exist."))}}}},{key:"configuration",get:function get(){return this._configuration},set:function set(configuration){this._configuration=configuration}},{key:"options",get:function get(){return this._options}}],[{key:"configuration",get:function get(){}}]);return BaseTool}();__webpack_exports__["default"]=BaseTool},"./tools/brush/BrushTool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return BrushTool});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@babel/runtime/helpers/inherits.js"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),_externalModules_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./externalModules.js"),_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/base/BaseBrushTool.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./stateManagement/toolState.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./store/index.js"),_util_brush_index_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./util/brush/index.js"),_events_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./events.js"),drawBrushPixels=_util_brush_index_js__WEBPACK_IMPORTED_MODULE_10__["default"].drawBrushPixels,getCircle=_util_brush_index_js__WEBPACK_IMPORTED_MODULE_10__["default"].getCircle,brushModule=_store_index_js__WEBPACK_IMPORTED_MODULE_9__["default"].modules.brush,BrushTool=function(_BaseBrushTool){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(BrushTool,_BaseBrushTool);function BrushTool(){var _this,configuration=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,BrushTool);var defaultConfig={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],strategies:{overlapping:_overlappingStrategy,nonOverlapping:_nonOverlappingStrategy},defaultStrategy:"overlapping",configuration:{}},initialConfiguration=Object.assign(defaultConfig,configuration);_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default()(BrushTool).call(this,initialConfiguration));_this.touchDragCallback=_this._paint.bind(_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default()(_this));_this.initialConfiguration=initialConfiguration;return _this}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(BrushTool,[{key:"renderBrush",value:function renderBrush(evt){var eventData=evt.detail,viewport=eventData.viewport,mousePosition;if(this._drawing){mousePosition=this._lastImageCoords}else if(this._mouseUpRender){mousePosition=this._lastImageCoords;this._mouseUpRender=!1}else{mousePosition=_store_index_js__WEBPACK_IMPORTED_MODULE_9__["default"].state.mousePositionImage}if(!mousePosition){return}var _eventData$image=eventData.image,rows=_eventData$image.rows,columns=_eventData$image.columns,_mousePosition=mousePosition,x=_mousePosition.x,y=_mousePosition.y;if(0>x||x>columns||0>y||y>rows){return}var radius=brushModule.state.radius,context=eventData.canvasContext,element=eventData.element,drawId=brushModule.state.drawColorId,color=this._getBrushColor(drawId);context.setTransform(1,0,0,1,0,0);var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone,circleRadius=radius*viewport.scale,mouseCoordsCanvas=cornerstone.pixelToCanvas(element,mousePosition);context.beginPath();context.strokeStyle=color;context.ellipse(mouseCoordsCanvas.x,mouseCoordsCanvas.y,circleRadius,circleRadius,0,0,2*_MathPI);context.stroke()}},{key:"_paint",value:function _paint(evt){this.applyActiveStrategy(evt,this.configuration);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.triggerEvent(evt.detail.element,_events_js__WEBPACK_IMPORTED_MODULE_11__["default"].MEASUREMENT_MODIFIED,evt.detail);_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.updateImage(evt.detail.element)}}]);return BrushTool}(_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"]);function _overlappingStrategy(evt){var eventData=evt.detail,element=eventData.element,_eventData$image2=eventData.image,rows=_eventData$image2.rows,columns=_eventData$image2.columns,_eventData$currentPoi=eventData.currentPoints.image,x=_eventData$currentPoi.x,y=_eventData$currentPoi.y,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName());if(!toolState){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.addToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName(),{});toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName())}var toolData=toolState.data;if(0>x||x>columns||0>y||y>rows){return}var radius=brushModule.state.radius,pointerArray=getCircle(radius,rows,columns,x,y);_drawMainColor(eventData,toolData,pointerArray)}function _nonOverlappingStrategy(evt){var eventData=evt.detail,element=eventData.element,_eventData$image3=eventData.image,rows=_eventData$image3.rows,columns=_eventData$image3.columns,_eventData$currentPoi2=eventData.currentPoints.image,x=_eventData$currentPoi2.x,y=_eventData$currentPoi2.y,toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName());if(!toolState){Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.addToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName(),{});toolState=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_8__.getToolState)(element,_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getReferencedToolDataName())}var toolData=toolState.data,segmentationIndex=brushModule.state.drawColorId;if(0>x||x>columns||0>y||y>rows){return}for(var radius=brushModule.state.radius,pointerArray=getCircle(radius,rows,columns,x,y),numberOfColors=_base_BaseBrushTool_js__WEBPACK_IMPORTED_MODULE_7__["default"].getNumberOfColors(),i=0;i<numberOfColors;i++){if(i===segmentationIndex){continue}if(toolData[i]&&toolData[i].pixelData){drawBrushPixels(pointerArray,toolData[i],columns,!0);toolData[i].invalidated=!0}}_drawMainColor(eventData,toolData,pointerArray)}function _drawMainColor(eventData,toolData,pointerArray){var shouldErase=_isCtrlDown(eventData),columns=eventData.image.columns,segmentationIndex=brushModule.state.drawColorId;if(shouldErase&&!toolData[segmentationIndex]){return}if(!toolData[segmentationIndex]){toolData[segmentationIndex]={}}if(!toolData[segmentationIndex].pixelData){var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_6__["default"].cornerstone.getEnabledElement(eventData.element),enabledElementUID=enabledElement.uuid,imageBitmapCacheForElement=brushModule.getters.imageBitmapCacheForElement(enabledElementUID);if(imageBitmapCacheForElement){imageBitmapCacheForElement[segmentationIndex]=null}toolData[segmentationIndex].pixelData=new Uint8ClampedArray(eventData.image.width*eventData.image.height)}var toolDataI=toolData[segmentationIndex];drawBrushPixels(pointerArray,toolDataI,columns,shouldErase);toolDataI.invalidated=!0}function _isCtrlDown(eventData){return eventData.event&&eventData.event.ctrlKey||eventData.ctrlKey}},"./tools/brush/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _BrushTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/brush/BrushTool.js");__webpack_require__.d(__webpack_exports__,"BrushTool",function(){return _BrushTool_js__WEBPACK_IMPORTED_MODULE_0__["default"]});__webpack_exports__["default"]={BrushTool:_BrushTool_js__WEBPACK_IMPORTED_MODULE_0__["default"]}},"./tools/cursors/MouseCursor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return MouseCursor});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolColors.js"),_store_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./store/index.js"),cursorModule=_store_index_js__WEBPACK_IMPORTED_MODULE_3__.modules.cursor,MouseCursor=function(){function MouseCursor(iconGroupString,options){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,MouseCursor);this.iconGroupString=iconGroupString;this.options=Object.assign({},cursorModule.getters.defaultOptions(),options)}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(MouseCursor,[{key:"getIconSVG",value:function getIconSVG(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},svgString=this._generateIconSVGString(options);return new Blob([svgString],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function getIconSVGString(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(options)}},{key:"getIconWithPointerSVG",value:function getIconWithPointerSVG(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},svgString=this._generateIconWithPointerSVGString(options);return new Blob([svgString],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function getIconWithPointerString(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(options)}},{key:"_generateIconWithPointerSVGString",value:function _generateIconWithPointerSVGString(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},svgOptions=Object.assign({},this.options,options),mousePointerGroupString=svgOptions.mousePointerGroupString,iconSize=svgOptions.iconSize,viewBox=svgOptions.viewBox,scale=iconSize/_Mathmax(viewBox.x,viewBox.y),svgSize=16+iconSize,svgString="\n        <svg\n        data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"".concat(svgSize,"\" height=\"").concat(svgSize,"\" viewBox=\"0 0 ").concat(svgSize," ").concat(svgSize,"\"\n      >\n        <g>\n          ").concat(mousePointerGroupString,"\n        </g>\n        <g transform=\"translate(16, 16) scale(").concat(scale,")\">\n          ").concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(svgString,svgOptions)}},{key:"_generateIconSVGString",value:function _generateIconSVGString(){var options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},svgOptions=Object.assign({},this.options,options),iconSize=svgOptions.iconSize,viewBox=svgOptions.viewBox,svgString="\n      <svg\n        data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"".concat(iconSize,"\" height=\"").concat(iconSize,"\" viewBox=\"0 0\n        ").concat(viewBox.x," ").concat(viewBox.y,"\"\n      >\n        ").concat(this.iconGroupString,"\n      </svg>");return this._injectColors(svgString,svgOptions)}},{key:"_injectColors",value:function _injectColors(svgString){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},activeColor=options.activeColor||_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__["default"].getActiveColor(),toolColor=options.toolColor||_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__["default"].getToolColor(),fillColor=options.fillColor||_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__["default"].getFillColor();return svgString.replace(/ACTIVE_COLOR/g,"".concat(activeColor)).replace(/TOOL_COLOR/g,"".concat(toolColor)).replace(/FILL_COLOR/g,"".concat(fillColor))}},{key:"mousePoint",get:function get(){var mousePoint=this.options.mousePoint;return"".concat(mousePoint.x," ").concat(mousePoint.y)}}]);return MouseCursor}()},"./tools/cursors/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"angleCursor",function(){return angleCursor});__webpack_require__.d(__webpack_exports__,"arrowAnnotateCursor",function(){return arrowAnnotateCursor});__webpack_require__.d(__webpack_exports__,"bidirectionalCursor",function(){return bidirectionalCursor});__webpack_require__.d(__webpack_exports__,"cobbAngleCursor",function(){return cobbAngleCursor});__webpack_require__.d(__webpack_exports__,"ellipticalRoiCursor",function(){return ellipticalRoiCursor});__webpack_require__.d(__webpack_exports__,"freehandMouseCursor",function(){return freehandMouseCursor});__webpack_require__.d(__webpack_exports__,"freehandSculpterMouseCursor",function(){return freehandSculpterMouseCursor});__webpack_require__.d(__webpack_exports__,"lengthCursor",function(){return lengthCursor});__webpack_require__.d(__webpack_exports__,"probeCursor",function(){return probeCursor});__webpack_require__.d(__webpack_exports__,"rectangleRoiCursor",function(){return rectangleRoiCursor});__webpack_require__.d(__webpack_exports__,"textMarkerCursor",function(){return textMarkerCursor});__webpack_require__.d(__webpack_exports__,"crosshairsCursor",function(){return crosshairsCursor});__webpack_require__.d(__webpack_exports__,"eraserCursor",function(){return eraserCursor});__webpack_require__.d(__webpack_exports__,"magnifyCursor",function(){return magnifyCursor});__webpack_require__.d(__webpack_exports__,"panCursor",function(){return panCursor});__webpack_require__.d(__webpack_exports__,"rotateCursor",function(){return rotateCursor});__webpack_require__.d(__webpack_exports__,"stackScrollCursor",function(){return stackScrollCursor});__webpack_require__.d(__webpack_exports__,"wwwcRegionCursor",function(){return wwwcRegionCursor});__webpack_require__.d(__webpack_exports__,"wwwcCursor",function(){return wwwcCursor});__webpack_require__.d(__webpack_exports__,"zoomCursor",function(){return zoomCursor});var _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/cursors/MouseCursor.js"),angleCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z\"\n      />",{viewBox:{x:1792,y:1792}}),arrowAnnotateCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<g id=\"arrowAnnotate-group\" fill=\"none\" stroke-width=\"1\" stroke=\"ACTIVE_COLOR\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"arrowAnnotate-arrow\" d=\"M23,7 l-15,15 M7,17 l0,6 6,0\" stroke-width=\"2\" />\n  </g>",{viewBox:{x:24,y:24}}),bidirectionalCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<g fill=\"ACTIVE_COLOR\" stroke-width=\"3\" stroke=\"ACTIVE_COLOR\">\n    <path d=\"M27.63 3.21L3.12 28.81\"></path>\n    <path d=\"M27.63 15.75L15.27 4.43\"></path>\n    <path d=\"M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z\" ></path>\n    <path d=\"M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z\"></path>\n    <path d=\"M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z\"></path>\n    <path d=\"M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z\"></path>\n  </g>",{viewBox:{x:48,y:48}}),cobbAngleCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<g stroke=\"ACTIVE_COLOR\" stroke-width=\"3\">\n    <path d=\"M28.59 2.34L3.82 12.32\"></path>\n    <path d=\"M28.59 29.66L3.82 19.68\"></path>\n    <path stroke-dasharray=\"2\" fill-opacity=\"0\" d=\"M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63\">\n    </path>\n  </g>",{viewBox:{x:32,y:32}}),ellipticalRoiCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path stroke=\"ACTIVE_COLOR\" fill=\"none\" stroke-width=\"3\" d=\"M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z\"\n    />",{viewBox:{x:32,y:32}}),freehandMouseCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("\n  <g fill=\"ACTIVE_COLOR\" stroke=\"ACTIVE_COLOR\" stroke-width=\"2\">\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_3\" cy=\"4.240343\" cx=\"14.306499\"/>\n    <line id=\"svg_4\" y2=\"3.58462\" x2=\"12.242186\" y1=\"3.997482\" x1=\"13.432202\"/>\n    <line id=\"svg_5\" y2=\"3.268901\" x2=\"10.857882\" y1=\"3.608906\" x1=\"12.387902\"/>\n    <line id=\"svg_6\" y2=\"3.147471\" x2=\"9.740724\" y1=\"3.293187\" x1=\"10.955026\"/>\n    <line id=\"svg_7\" y2=\"3.147471\" x2=\"8.089274\" y1=\"3.196043\" x1=\"9.983585\"/>\n    <line id=\"svg_8\" y2=\"3.268901\" x2=\"6.874972\" y1=\"3.123185\" x1=\"8.307848\"/>\n    <line id=\"svg_9\" y2=\"3.657478\" x2=\"5.587812\" y1=\"3.220329\" x1=\"7.020688\"/>\n    <line id=\"svg_10\" y2=\"4.046054\" x2=\"4.737801\" y1=\"3.560334\" x1=\"5.854959\"/>\n    <line id=\"svg_11\" y2=\"4.337487\" x2=\"4.300652\" y1=\"3.997482\" x1=\"4.834945\"/>\n    <line id=\"svg_12\" y2=\"4.726063\" x2=\"3.88779\" y1=\"4.191771\" x1=\"4.470655\"/>\n    <line id=\"svg_15\" y2=\"5.3575\" x2=\"3.377783\" y1=\"4.604633\" x1=\"3.960648\"/>\n    <line id=\"svg_16\" y2=\"6.183226\" x2=\"2.916348\" y1=\"5.138926\" x1=\"3.547785\"/>\n    <line id=\"svg_17\" y2=\"6.960379\" x2=\"2.770632\" y1=\"5.867507\" x1=\"3.037779\"/>\n    <line id=\"svg_18\" y2=\"7.713246\" x2=\"2.673488\" y1=\"6.741804\" x1=\"2.819204\"/>\n    <line id=\"svg_19\" y2=\"8.684687\" x2=\"2.697774\" y1=\"7.616102\" x1=\"2.673488\"/>\n    <line id=\"svg_20\" y2=\"9.753273\" x2=\"2.892062\" y1=\"8.611829\" x1=\"2.697774\"/>\n    <line id=\"svg_21\" y2=\"10.724714\" x2=\"3.134923\" y1=\"9.534698\" x1=\"2.84349\"/>\n    <line id=\"svg_23\" y2=\"11.647583\" x2=\"3.596357\" y1=\"10.578998\" x1=\"3.086351\"/>\n    <line id=\"svg_25\" y2=\"12.521881\" x2=\"4.276366\" y1=\"11.501867\" x1=\"3.499213\"/>\n    <line id=\"svg_26\" y2=\"13.930471\" x2=\"5.830673\" y1=\"12.376165\" x1=\"4.13065\"/>\n    <line id=\"svg_28\" y2=\"14.707624\" x2=\"7.263549\" y1=\"13.881899\" x1=\"5.733528\"/>\n    <line id=\"svg_29\" y2=\"15.339061\" x2=\"8.963571\" y1=\"14.61048\" x1=\"7.06926\"/>\n    <line id=\"svg_30\" y2=\"15.581921\" x2=\"10.882168\" y1=\"15.314775\" x1=\"8.817855\"/>\n    <line id=\"svg_31\" y2=\"15.460491\" x2=\"12.023612\" y1=\"15.581921\" x1=\"10.785024\"/>\n    <line id=\"svg_33\" y2=\"15.120487\" x2=\"13.092197\" y1=\"15.484777\" x1=\"11.877895\"/>\n    <line id=\"svg_34\" y2=\"14.586194\" x2=\"13.86935\" y1=\"15.217631\" x1=\"12.897909\"/>\n    <line id=\"svg_35\" y2=\"13.833327\" x2=\"14.597931\" y1=\"14.756196\" x1=\"13.699348\"/>\n    <line id=\"svg_37\" y2=\"12.716169\" x2=\"15.180796\" y1=\"13.881899\" x1=\"14.549359\"/>\n    <line id=\"svg_39\" y2=\"11.429009\" x2=\"15.520801\" y1=\"12.813313\" x1=\"15.15651\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_40\" cy=\"10.967574\" cx=\"15.520801\"/>\n  </g>",{viewBox:{x:18,y:18}}),freehandSculpterMouseCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<g id=\"icon-freehand-sculpt\" fill=\"none\" stroke-width=\"1.5\" stroke=\"ACTIVE_COLOR\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n      <line id=\"svg_1\" y2=\"2.559367\" x2=\"10.184807\" y1=\"4.467781\" x1=\"8.81711\"/>\n      <line id=\"svg_4\" y2=\"1.493836\" x2=\"11.727442\" y1=\"2.766112\" x1=\"10.089386\"/>\n      <line id=\"svg_7\" y2=\"1.080346\" x2=\"13.047428\" y1=\"1.748291\" x1=\"11.345759\"/>\n      <line id=\"svg_8\" y2=\"1.000829\" x2=\"14.351511\" y1=\"1.112153\" x1=\"12.77707\"/>\n      <line id=\"svg_9\" y2=\"1.350705\" x2=\"15.242104\" y1=\"0.905408\" x1=\"13.969828\"/>\n      <line id=\"svg_10\" y2=\"2.098167\" x2=\"15.862339\" y1=\"1.14396\" x1=\"14.955842\"/>\n      <line id=\"svg_11\" y2=\"3.195505\" x2=\"16.41896\" y1=\"1.939133\" x1=\"15.766918\"/>\n      <line id=\"svg_12\" y2=\"4.292843\" x2=\"16.530284\" y1=\"2.925147\" x1=\"16.387153\"/>\n      <line id=\"svg_16\" y2=\"5.644637\" x2=\"16.196311\" y1=\"3.831643\" x1=\"16.593898\"/>\n      <line id=\"svg_18\" y2=\"7.266789\" x2=\"15.623787\" y1=\"5.19934\" x1=\"16.275829\"/>\n      <line id=\"svg_19\" y2=\"10.813258\" x2=\"14.526449\" y1=\"6.726071\" x1=\"15.766918\"/>\n      <line id=\"svg_20\" y2=\"5.056209\" x2=\"8.085552\" y1=\"4.181519\" x1=\"8.976145\"/>\n      <line id=\"svg_23\" y2=\"5.326568\" x2=\"7.481221\" y1=\"4.78585\" x1=\"8.403621\"/>\n      <line id=\"svg_24\" y2=\"5.565119\" x2=\"6.749662\" y1=\"5.294761\" x1=\"7.624352\"/>\n      <line id=\"svg_25\" y2=\"5.994512\" x2=\"5.429675\" y1=\"5.533312\" x1=\"6.956407\"/>\n      <line id=\"svg_27\" y2=\"6.551133\" x2=\"4.284627\" y1=\"5.962706\" x1=\"5.572807\"/>\n      <line id=\"svg_28\" y2=\"7.584858\" x2=\"3.044158\" y1=\"6.392099\" x1=\"4.427758\"/>\n      <line id=\"svg_29\" y2=\"8.84123\" x2=\"2.185372\" y1=\"7.489437\" x1=\"3.219096\"/>\n      <line id=\"svg_31\" y2=\"10.606513\" x2=\"1.644654\" y1=\"8.602678\" x1=\"2.280792\"/>\n      <line id=\"svg_32\" y2=\"13.214679\" x2=\"1.48562\" y1=\"10.352058\" x1=\"1.724171\"/>\n      <line id=\"svg_33\" y2=\"14.375631\" x2=\"1.676461\" y1=\"12.992031\" x1=\"1.453813\"/>\n      <line id=\"svg_34\" y2=\"15.298031\" x2=\"2.264889\" y1=\"14.152983\" x1=\"1.517427\"/>\n      <line id=\"svg_35\" y2=\"16.172721\" x2=\"3.521261\" y1=\"14.948155\" x1=\"1.915013\"/>\n      <line id=\"svg_36\" y2=\"16.824762\" x2=\"5.207027\" y1=\"15.997783\" x1=\"3.28271\"/>\n      <line id=\"svg_38\" y2=\"17.063314\" x2=\"7.035924\" y1=\"16.745245\" x1=\"4.968475\"/>\n      <line id=\"svg_39\" y2=\"16.888376\" x2=\"9.278311\" y1=\"17.047411\" x1=\"6.733758\"/>\n      <line id=\"svg_40\" y2=\"16.284045\" x2=\"10.661911\" y1=\"16.983797\" x1=\"8.992048\"/>\n      <line id=\"svg_41\" y2=\"15.313934\" x2=\"11.647925\" y1=\"16.395369\" x1=\"10.455166\"/>\n      <line id=\"svg_44\" y2=\"13.898527\" x2=\"12.82478\" y1=\"15.425259\" x1=\"11.504794\"/>\n      <line id=\"svg_45\" y2=\"12.037824\" x2=\"14.144766\" y1=\"14.312017\" x1=\"12.522614\"/>\n      <line id=\"svg_47\" y2=\"10.59061\" x2=\"14.605966\" y1=\"12.228665\" x1=\"13.953925\"/>\n      <ellipse ry=\"1\" rx=\"1\" id=\"svg_48\" cy=\"3.982726\" cx=\"13.460918\"/>\n    </g>",{viewBox:{x:18,y:18}}),lengthCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<g id=\"length-group\" fill=\"none\" stroke-width=\"1\" stroke=\"ACTIVE_COLOR\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"length-dashes\" d=\"m22.5,6 -16.5,16.5\" stroke-width=\"3\" stroke-dasharray=\"0.6666,5\" />\n  </g>",{viewBox:{x:24,y:24}}),probeCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z\"\n  />",{viewBox:{x:1792,y:1792}}),rectangleRoiCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\"\n  />",{viewBox:{x:1792,y:1792}}),textMarkerCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z\"\n  />",{viewBox:{x:1792,y:1792}}),crosshairsCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z\"\n  />",{viewBox:{x:1792,y:1792}}),eraserCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path transform=\"translate(0,1792) scale(1,-1)\" fill=\"ACTIVE_COLOR\" d=\"M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z\"\n    />",{viewBox:{x:2048,y:1792}}),magnifyCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z\"\n    />",{viewBox:{x:512,y:512}}),panCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z\"\n    />",{viewBox:{x:1792,y:1792}}),rotateCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z\"\n    />",{viewBox:{x:1792,y:1792}}),stackScrollCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z\"\n      />",{viewBox:{x:24,y:28}}),wwwcRegionCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z\"\n  />",{viewBox:{x:1792,y:1792}}),wwwcCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M14.5,3.5 a1 1 0 0 1 -11,11 Z\" stroke=\"none\" opacity=\"0.8\" />\n    <circle cx=\"9\" cy=\"9\" r=\"8\" fill=\"none\" stroke-width=\"2\" stroke=\"ACTIVE_COLOR\" />",{viewBox:{x:18,y:18}}),zoomCursor=new _MouseCursor_js__WEBPACK_IMPORTED_MODULE_0__["default"]("<path fill=\"ACTIVE_COLOR\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z\"\n    />\n    <path fill=\"ACTIVE_COLOR\" transform=\"scale(0.22,0.22) translate(1400,0)\" d=\"M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z\"\n    />",{viewBox:{x:640,y:512}})},"./tools/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _CrosshairsTool_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./tools/CrosshairsTool.js");__webpack_require__.d(__webpack_exports__,"CrosshairsTool",function(){return _CrosshairsTool_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _DoubleTapFitToWindowTool_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/DoubleTapFitToWindowTool.js");__webpack_require__.d(__webpack_exports__,"DoubleTapFitToWindowTool",function(){return _DoubleTapFitToWindowTool_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _DragProbeTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./tools/DragProbeTool.js");__webpack_require__.d(__webpack_exports__,"DragProbeTool",function(){return _DragProbeTool_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _EraserTool_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./tools/EraserTool.js");__webpack_require__.d(__webpack_exports__,"EraserTool",function(){return _EraserTool_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _FreehandSculpterMouseTool_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./tools/FreehandSculpterMouseTool.js");__webpack_require__.d(__webpack_exports__,"FreehandSculpterMouseTool",function(){return _FreehandSculpterMouseTool_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var _MagnifyTool_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./tools/MagnifyTool.js");__webpack_require__.d(__webpack_exports__,"MagnifyTool",function(){return _MagnifyTool_js__WEBPACK_IMPORTED_MODULE_5__["default"]});var _PanMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./tools/PanMultiTouchTool.js");__webpack_require__.d(__webpack_exports__,"PanMultiTouchTool",function(){return _PanMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_6__["default"]});var _PanTool_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./tools/PanTool.js");__webpack_require__.d(__webpack_exports__,"PanTool",function(){return _PanTool_js__WEBPACK_IMPORTED_MODULE_7__["default"]});var _ReferenceLinesTool_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./tools/ReferenceLinesTool.js");__webpack_require__.d(__webpack_exports__,"ReferenceLinesTool",function(){return _ReferenceLinesTool_js__WEBPACK_IMPORTED_MODULE_8__["default"]});var _RotateTool_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./tools/RotateTool.js");__webpack_require__.d(__webpack_exports__,"RotateTool",function(){return _RotateTool_js__WEBPACK_IMPORTED_MODULE_9__["default"]});var _RotateTouchTool_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./tools/RotateTouchTool.js");__webpack_require__.d(__webpack_exports__,"RotateTouchTool",function(){return _RotateTouchTool_js__WEBPACK_IMPORTED_MODULE_10__["default"]});var _ScaleOverlayTool_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./tools/ScaleOverlayTool.js");__webpack_require__.d(__webpack_exports__,"ScaleOverlayTool",function(){return _ScaleOverlayTool_js__WEBPACK_IMPORTED_MODULE_11__["default"]});var _StackScrollMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./tools/StackScrollMouseWheelTool.js");__webpack_require__.d(__webpack_exports__,"StackScrollMouseWheelTool",function(){return _StackScrollMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_12__["default"]});var _StackScrollMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./tools/StackScrollMultiTouchTool.js");__webpack_require__.d(__webpack_exports__,"StackScrollMultiTouchTool",function(){return _StackScrollMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_13__["default"]});var _StackScrollTool_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./tools/StackScrollTool.js");__webpack_require__.d(__webpack_exports__,"StackScrollTool",function(){return _StackScrollTool_js__WEBPACK_IMPORTED_MODULE_14__["default"]});var _WwwcRegionTool_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./tools/WwwcRegionTool.js");__webpack_require__.d(__webpack_exports__,"WwwcRegionTool",function(){return _WwwcRegionTool_js__WEBPACK_IMPORTED_MODULE_15__["default"]});var _WwwcTool_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./tools/WwwcTool.js");__webpack_require__.d(__webpack_exports__,"WwwcTool",function(){return _WwwcTool_js__WEBPACK_IMPORTED_MODULE_16__["default"]});var _ZoomMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./tools/ZoomMouseWheelTool.js");__webpack_require__.d(__webpack_exports__,"ZoomMouseWheelTool",function(){return _ZoomMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_17__["default"]});var _ZoomTool_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./tools/ZoomTool.js");__webpack_require__.d(__webpack_exports__,"ZoomTool",function(){return _ZoomTool_js__WEBPACK_IMPORTED_MODULE_18__["default"]});var _ZoomTouchPinchTool_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./tools/ZoomTouchPinchTool.js");__webpack_require__.d(__webpack_exports__,"ZoomTouchPinchTool",function(){return _ZoomTouchPinchTool_js__WEBPACK_IMPORTED_MODULE_19__["default"]});__webpack_exports__["default"]={CrosshairsTool:_CrosshairsTool_js__WEBPACK_IMPORTED_MODULE_0__["default"],DoubleTapFitToWindowTool:_DoubleTapFitToWindowTool_js__WEBPACK_IMPORTED_MODULE_1__["default"],DragProbeTool:_DragProbeTool_js__WEBPACK_IMPORTED_MODULE_2__["default"],EraserTool:_EraserTool_js__WEBPACK_IMPORTED_MODULE_3__["default"],FreehandSculpterMouseTool:_FreehandSculpterMouseTool_js__WEBPACK_IMPORTED_MODULE_4__["default"],MagnifyTool:_MagnifyTool_js__WEBPACK_IMPORTED_MODULE_5__["default"],PanMultiTouchTool:_PanMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_6__["default"],PanTool:_PanTool_js__WEBPACK_IMPORTED_MODULE_7__["default"],ReferenceLinesTool:_ReferenceLinesTool_js__WEBPACK_IMPORTED_MODULE_8__["default"],RotateTool:_RotateTool_js__WEBPACK_IMPORTED_MODULE_9__["default"],RotateTouchTool:_RotateTouchTool_js__WEBPACK_IMPORTED_MODULE_10__["default"],ScaleOverlayTool:_ScaleOverlayTool_js__WEBPACK_IMPORTED_MODULE_11__["default"],StackScrollMouseWheelTool:_StackScrollMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_12__["default"],StackScrollMultiTouchTool:_StackScrollMultiTouchTool_js__WEBPACK_IMPORTED_MODULE_13__["default"],StackScrollTool:_StackScrollTool_js__WEBPACK_IMPORTED_MODULE_14__["default"],WwwcRegionTool:_WwwcRegionTool_js__WEBPACK_IMPORTED_MODULE_15__["default"],WwwcTool:_WwwcTool_js__WEBPACK_IMPORTED_MODULE_16__["default"],ZoomMouseWheelTool:_ZoomMouseWheelTool_js__WEBPACK_IMPORTED_MODULE_17__["default"],ZoomTool:_ZoomTool_js__WEBPACK_IMPORTED_MODULE_18__["default"],ZoomTouchPinchTool:_ZoomTouchPinchTool_js__WEBPACK_IMPORTED_MODULE_19__["default"]}},"./tools/referenceLines/calculateReferenceLine.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _util_pointProjector_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/pointProjector.js");__webpack_exports__["default"]=function(targetImagePlane,referenceImagePlane){var points=Object(_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_0__.planePlaneIntersection)(targetImagePlane,referenceImagePlane);if(!points){return}return{start:Object(_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_0__.projectPatientPointToImagePlane)(points.start,targetImagePlane),end:Object(_util_pointProjector_js__WEBPACK_IMPORTED_MODULE_0__.projectPatientPointToImagePlane)(points.end,targetImagePlane)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_calculateReferenceLine_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./tools/referenceLines/calculateReferenceLine.js"),_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolColors.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/convertToVector3.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./drawing/index.js");__webpack_exports__["default"]=function(context,eventData,targetElement,referenceElement){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,targetImage=cornerstone.getEnabledElement(targetElement).image,referenceImage=cornerstone.getEnabledElement(referenceElement).image;if(!targetImage||!referenceImage){return}var targetImagePlane=cornerstone.metaData.get("imagePlaneModule",targetImage.imageId),referenceImagePlane=cornerstone.metaData.get("imagePlaneModule",referenceImage.imageId);if(!targetImagePlane||!referenceImagePlane||!targetImagePlane.rowCosines||!targetImagePlane.columnCosines||!targetImagePlane.imagePositionPatient||!referenceImagePlane.rowCosines||!referenceImagePlane.columnCosines||!referenceImagePlane.imagePositionPatient){return}if(targetImagePlane.frameOfReferenceUID!==referenceImagePlane.frameOfReferenceUID){return}targetImagePlane.rowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(targetImagePlane.rowCosines);targetImagePlane.columnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(targetImagePlane.columnCosines);targetImagePlane.imagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(targetImagePlane.imagePositionPatient);referenceImagePlane.rowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(referenceImagePlane.rowCosines);referenceImagePlane.columnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(referenceImagePlane.columnCosines);referenceImagePlane.imagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_3__["default"])(referenceImagePlane.imagePositionPatient);var targetNormal=targetImagePlane.rowCosines.clone().cross(targetImagePlane.columnCosines),referenceNormal=referenceImagePlane.rowCosines.clone().cross(referenceImagePlane.columnCosines),angleInRadians=targetNormal.angleTo(referenceNormal);angleInRadians=_Mathabs(angleInRadians);if(.5>angleInRadians){return}var referenceLine=Object(_calculateReferenceLine_js__WEBPACK_IMPORTED_MODULE_1__["default"])(targetImagePlane,referenceImagePlane);if(!referenceLine){return}var color=_stateManagement_toolColors_js__WEBPACK_IMPORTED_MODULE_2__["default"].getActiveColor();context.setTransform(1,0,0,1,0,0);Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_4__.draw)(context,function(context){Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_4__.drawLine)(context,eventData.element,referenceLine.start,referenceLine.end,{color:color})})}},"./util/SaveAs.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(element,filename){var mimetype=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"image/png",canvas=element.querySelector("canvas");if(canvas.msToBlob){var blob=canvas.msToBlob();return window.navigator.msSaveBlob(blob,filename)}var lnk=document.createElement("a");lnk.download=filename;lnk.href=canvas.toDataURL(mimetype,1);if(document.createEvent){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);lnk.dispatchEvent(e)}else if(lnk.fireEvent){lnk.fireEvent("onclick")}}},"./util/angleBetweenPoints.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(p0,p1,p2){var p12=_Mathsqrt(_Mathpow(p0.x-p1.x,2)+_Mathpow(p0.y-p1.y,2)),p13=_Mathsqrt(_Mathpow(p0.x-p2.x,2)+_Mathpow(p0.y-p2.y,2)),p23=_Mathsqrt(_Mathpow(p1.x-p2.x,2)+_Mathpow(p1.y-p2.y,2)),angle=180*_Mathacos((_Mathpow(p12,2)+_Mathpow(p13,2)-_Mathpow(p23,2))/(2*p12*p13))/_MathPI,direction=(p1.x-p0.x)*(p2.y-p0.y)-(p1.y-p0.y)*(p2.x-p0.x);return{angle:angle,direction:direction}}},"./util/brush/drawBrush.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"drawBrushPixels",function(){return drawBrushPixels});__webpack_require__.d(__webpack_exports__,"drawBrushOnCanvas",function(){return drawBrushOnCanvas});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_drawing_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./drawing/index.js");function drawBrushPixels(pointerArray,toolData,columns){var shouldErase=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,getPixelIndex=function getPixelIndex(x,y){return y*columns+x},pixelData=toolData.pixelData;pointerArray.forEach(function(point){var spIndex=getPixelIndex(point[0],point[1]);pixelData[spIndex]=shouldErase?0:1});if(shouldErase&&!pixelData.some(function(element){return 0!==element})){delete toolData.pixelData}}function drawBrushOnCanvas(pointerArray,context,color,element){var canvasPtTL=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,{x:0,y:0}),canvasPtBR=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,{x:1,y:1}),sizeX=canvasPtBR.x-canvasPtTL.x,sizeY=canvasPtBR.y-canvasPtTL.y;Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_1__.draw)(context,function(context){pointerArray.forEach(function(point){var canvasPt=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.pixelToCanvas(element,{x:point[0],y:point[1]}),boundingBox={left:canvasPt.x,top:canvasPt.y,width:sizeX,height:sizeY};Object(_drawing_index_js__WEBPACK_IMPORTED_MODULE_1__.fillBox)(context,boundingBox,color)})})}},"./util/brush/getCircle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return getCircle});function getCircle(radius,rows,columns){var xCoord=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,yCoord=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,x0=_Mathround(xCoord),y0=_Mathround(yCoord);if(1===radius){return[[x0,y0]]}for(var circleArray=[],index=0,y=-radius,_yCoord;y<=radius;y++){_yCoord=y0+y;if(_yCoord>rows||0>_yCoord){continue}for(var x=-radius,_xCoord;x<=radius;x++){_xCoord=x0+x;if(_xCoord>columns||0>_xCoord){continue}if(x*x+y*y<radius*radius){circleArray[index++]=[x0+x,y0+y]}}}return circleArray}},"./util/brush/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _drawBrush_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/brush/drawBrush.js"),_getCircle_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/brush/getCircle.js");__webpack_exports__["default"]={drawBrushPixels:_drawBrush_js__WEBPACK_IMPORTED_MODULE_0__.drawBrushPixels,drawBrushOnCanvas:_drawBrush_js__WEBPACK_IMPORTED_MODULE_0__.drawBrushOnCanvas,getCircle:_getCircle_js__WEBPACK_IMPORTED_MODULE_1__["default"]}},"./util/calculateSUV.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(image,storedPixelValue){var skipRescale=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,patientStudyModule=cornerstone.metaData.get("patientStudyModule",image.imageId),seriesModule=cornerstone.metaData.get("generalSeriesModule",image.imageId);if(!patientStudyModule||!seriesModule){return}var modality=seriesModule.modality;if("PT"!==modality){return}var modalityPixelValue=skipRescale?storedPixelValue:storedPixelValue*image.slope+image.intercept,patientWeight=patientStudyModule.patientWeight;if(!patientWeight){return}var petSequenceModule=cornerstone.metaData.get("petIsotopeModule",image.imageId);if(!petSequenceModule){return}var radiopharmaceuticalInfo=petSequenceModule.radiopharmaceuticalInfo,startTime=radiopharmaceuticalInfo.radiopharmaceuticalStartTime,totalDose=radiopharmaceuticalInfo.radionuclideTotalDose,halfLife=radiopharmaceuticalInfo.radionuclideHalfLife,seriesAcquisitionTime=seriesModule.seriesTime;if(!startTime||!totalDose||!halfLife||!seriesAcquisitionTime){return}var acquisitionTimeInSeconds=fracToDec(seriesAcquisitionTime.fractionalSeconds||0)+seriesAcquisitionTime.seconds+60*seriesAcquisitionTime.minutes+60*(60*seriesAcquisitionTime.hours),injectionStartTimeInSeconds=fracToDec(startTime.fractionalSeconds)+startTime.seconds+60*startTime.minutes+60*(60*startTime.hours),durationInSeconds=acquisitionTimeInSeconds-injectionStartTimeInSeconds,correctedDose=totalDose*Math.exp(0.6931471805599453*-durationInSeconds/halfLife),suv=1e3*(modalityPixelValue*patientWeight/correctedDose);return suv};function fracToDec(fractionalValue){return parseFloat(".".concat(fractionalValue))}},"./util/clip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return clip});__webpack_require__.d(__webpack_exports__,"clipToBox",function(){return clipToBox});function clip(val,low,high){return _Mathmin(_Mathmax(low,val),high)}function clipToBox(point,box){point.x=clip(point.x,0,box.width);point.y=clip(point.y,0,box.height)}},"./util/convertToVector3.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return convertToVector3});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");function convertToVector3(arrayOrVector3){var cornerstoneMath=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath;if(arrayOrVector3 instanceof cornerstoneMath.Vector3){return arrayOrVector3}return new cornerstoneMath.Vector3(arrayOrVector3[0],arrayOrVector3[1],arrayOrVector3[2])}},"./util/copyPoints.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(points){var page=_copy(points.page),image=_copy(points.image),client=_copy(points.client),canvas=_copy(points.canvas);return{page:page,image:image,client:client,canvas:canvas}};function _copy(){var _ref=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},x=_ref.x,y=_ref.y;return{x:x,y:y}}},"./util/debounce.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _isObject_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/isObject.js");function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0,useRAF=!wait&&0!==wait&&"function"===typeof window.requestAnimationFrame;if("function"!==typeof func){throw new TypeError("Expected a function")}wait=+wait||0;if(Object(_isObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(options)){leading=!!options.leading;maxing="maxWait"in options;maxWait=maxing?_Mathmax(+options.maxWait||0,wait):maxWait;trailing="trailing"in options?!!options.trailing:trailing}function invokeFunc(time){var args=lastArgs,thisArg=lastThis;lastArgs=lastThis=void 0;lastInvokeTime=time;result=func.apply(thisArg,args);return result}function startTimer(pendingFunc,wait){if(useRAF){return window.requestAnimationFrame(pendingFunc)}return setTimeout(pendingFunc,wait)}function cancelTimer(id){if(useRAF){return window.cancelAnimationFrame(id)}clearTimeout(id)}function leadingEdge(time){lastInvokeTime=time;timerId=startTimer(timerExpired,wait);return leading?invokeFunc(time):result}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,timeWaiting=wait-timeSinceLastCall;return maxing?_Mathmin(timeWaiting,maxWait-timeSinceLastInvoke):timeWaiting}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;return void 0===lastCallTime||timeSinceLastCall>=wait||0>timeSinceLastCall||maxing&&timeSinceLastInvoke>=maxWait}function timerExpired(){var time=Date.now();if(shouldInvoke(time)){return trailingEdge(time)}timerId=startTimer(timerExpired,remainingWait(time))}function trailingEdge(time){timerId=void 0;if(trailing&&lastArgs){return invokeFunc(time)}lastArgs=lastThis=void 0;return result}function cancel(){if(void 0!==timerId){cancelTimer(timerId)}lastInvokeTime=0;lastArgs=lastCallTime=lastThis=timerId=void 0}function flush(){return void 0===timerId?result:trailingEdge(Date.now())}function pending(){return void 0!==timerId}function debounced(){for(var time=Date.now(),isInvoking=shouldInvoke(time),_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}lastArgs=args;lastThis=this;lastCallTime=time;if(isInvoking){if(void 0===timerId){return leadingEdge(lastCallTime)}if(maxing){timerId=startTimer(timerExpired,wait);return invokeFunc(lastCallTime)}}if(void 0===timerId){timerId=startTimer(timerExpired,wait)}return result}debounced.cancel=cancel;debounced.flush=flush;debounced.pending=pending;return debounced}__webpack_exports__["default"]=debounce},"./util/ellipse/calculateEllipseStatistics.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _pointInEllipse_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/ellipse/pointInEllipse.js");__webpack_exports__["default"]=function(sp,ellipse){for(var sum=0,sumSquared=0,count=0,index=0,min=null,max=null,y=ellipse.top;y<ellipse.top+ellipse.height;y++){for(var x=ellipse.left,point;x<ellipse.left+ellipse.width;x++){point={x:x,y:y};if(Object(_pointInEllipse_js__WEBPACK_IMPORTED_MODULE_0__["default"])(ellipse,point)){if(null===min){min=sp[index];max=sp[index]}sum+=sp[index];sumSquared+=sp[index]*sp[index];min=_Mathmin(min,sp[index]);max=_Mathmax(max,sp[index]);count++}index++}}if(0===count){return{count:count,mean:0,variance:0,stdDev:0,min:0,max:0}}var mean=sum/count,variance=sumSquared/count-mean*mean;return{count:count,mean:mean,variance:variance,stdDev:_Mathsqrt(variance),min:min,max:max}}},"./util/ellipse/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _calculateEllipseStatistics_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/ellipse/calculateEllipseStatistics.js");__webpack_require__.d(__webpack_exports__,"calculateEllipseStatistics",function(){return _calculateEllipseStatistics_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _pointInEllipse_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/ellipse/pointInEllipse.js");__webpack_require__.d(__webpack_exports__,"pointInEllipse",function(){return _pointInEllipse_js__WEBPACK_IMPORTED_MODULE_1__["default"]});__webpack_exports__["default"]={calculateEllipseStatistics:_calculateEllipseStatistics_js__WEBPACK_IMPORTED_MODULE_0__["default"],pointInEllipse:_pointInEllipse_js__WEBPACK_IMPORTED_MODULE_1__["default"]}},"./util/ellipse/pointInEllipse.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(ellipse,location){var xRadius=ellipse.width/2,yRadius=ellipse.height/2;if(0>=xRadius||0>=yRadius){return!1}var center={x:ellipse.left+xRadius,y:ellipse.top+yRadius},normalized={x:location.x-center.x,y:location.y-center.y},inEllipse=1>=normalized.x*normalized.x/(xRadius*xRadius)+normalized.y*normalized.y/(yRadius*yRadius);return inEllipse}},"./util/findAndMoveHelpers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"moveHandleNearImagePoint",function(){return moveHandleNearImagePoint});__webpack_require__.d(__webpack_exports__,"findHandleDataNearImagePoint",function(){return findHandleDataNearImagePoint});__webpack_require__.d(__webpack_exports__,"moveAnnotation",function(){return moveAnnotation});var _store_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./store/index.js"),_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./manipulators/getHandleNearImagePoint.js"),_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./manipulators/index.js"),moveHandleNearImagePoint=function moveHandleNearImagePoint(evt,tool,toolData,handle,interactionType){toolData.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked=!0;Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__.moveHandle)(evt.detail,tool.name,toolData,handle,tool.options,interactionType);evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault();return},findHandleDataNearImagePoint=function findHandleDataNearImagePoint(element,toolState,toolName,coords){for(var interactionType=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"mouse",i=0;i<toolState.data.length;i++){var data=toolState.data[i],handle=Object(_manipulators_getHandleNearImagePoint_js__WEBPACK_IMPORTED_MODULE_1__["default"])(element,data.handles,coords,"mouse"===interactionType?_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.clickProximity:_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.touchProximity);if(handle){return{handle:handle,data:data}}}},moveAnnotation=function moveAnnotation(evt,tool,annotation){var interactionType=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"mouse",toolOptions=Object.assign({},{doneMovingCallback:function doneMovingCallback(){annotation.active=!1;_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked=!1}},tool.options);annotation.active=!0;_store_index_js__WEBPACK_IMPORTED_MODULE_0__.state.isToolLocked=!0;Object(_manipulators_index_js__WEBPACK_IMPORTED_MODULE_2__.moveAllHandles)(evt.detail,tool.name,annotation,null,toolOptions,interactionType);evt.stopImmediatePropagation();evt.stopPropagation();evt.preventDefault();return}},"./util/freehand/ClickedLineData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return ClickedLineData});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),ClickedLineData=function ClickedLineData(toolIndex,handleIndexArray){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,ClickedLineData);this.toolIndex=toolIndex;this.handleIndexArray=handleIndexArray}},"./util/freehand/FreehandHandleData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return FreehandHandleData});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),FreehandHandleData=function FreehandHandleData(position){var highlight=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,active=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,FreehandHandleData);this.x=position.x;this.y=position.y;this.highlight=highlight;this.active=active;this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return FreehandLineFinder});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolState.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),_ClickedLineData_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/freehand/ClickedLineData.js"),distanceThreshold=10,FreehandLineFinder=function(){function FreehandLineFinder(eventData,toolName){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,FreehandLineFinder);this._eventData=eventData;this._toolName=toolName}_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(FreehandLineFinder,[{key:"findLine",value:function findLine(){var closestToolIndex=this.findTool();if(null===closestToolIndex){return null}var closeLines=this._getCloseLinesInTool(closestToolIndex);if(closeLines){var clickedLineData=this._findCorrectLine(closestToolIndex,closeLines);return clickedLineData}return null}},{key:"findTool",value:function findTool(){this._toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(this._eventData.element,this._toolName);this._mousePoint=this._eventData.currentPoints.canvas;if(!this._toolData){return null}var closestHandle=this._nearestHandleToPointAllTools();return closestHandle.toolIndex}},{key:"_nearestHandleToPointAllTools",value:function _nearestHandleToPointAllTools(){for(var toolData=this._toolData,closestHandle={toolIndex:null,handleIndex:null,distance:1/0},toolIndex=0,closestHandleForToolI;toolIndex<toolData.data.length;toolIndex++){closestHandleForToolI=this._nearestHandleToPoint(toolIndex);if(null===closestHandleForToolI){continue}if(closestHandleForToolI.distance<closestHandle.distance){closestHandle=closestHandleForToolI}}return closestHandle}},{key:"_nearestHandleToPoint",value:function _nearestHandleToPoint(toolIndex){var eventData=this._eventData,toolData=this._toolData,data=toolData.data[toolIndex],points=data.handles.points;if(void 0===points){return null}if(!1===data.visible){return null}for(var closest={toolIndex:toolIndex,handleIndex:null,distance:1/0},i=0;i<points.length;i++){var handleCanvas=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,points[i]),handleDistanceFromMousePoint=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstoneMath.point.distance(handleCanvas,this._mousePoint);if(handleDistanceFromMousePoint<closest.distance){closest.handleIndex=i;closest.distance=handleDistanceFromMousePoint}}return closest}},{key:"_getCloseLinesInTool",value:function _getCloseLinesInTool(toolIndex){for(var toolData=this._toolData,points=toolData.data[toolIndex].handles.points,closeLines=[],i=0;i<points.length;i++){var nextIndex=FreehandLineFinder.getNextHandleIndex(i,points.length),d=this._distanceOfPointfromLine(points[i],points[nextIndex]);if(d<distanceThreshold){closeLines.push([i,nextIndex])}}return closeLines}},{key:"_findCorrectLine",value:function _findCorrectLine(toolIndex,closeLines){for(var i=0;i<closeLines.length;i++){if(this._pointProjectsToLineSegment(toolIndex,closeLines[i])){return new _ClickedLineData_js__WEBPACK_IMPORTED_MODULE_4__["default"](toolIndex,closeLines[i])}}return null}},{key:"_pointProjectsToLineSegment",value:function _pointProjectsToLineSegment(toolIndex,handleIndexArray){var eventData=this._eventData,toolData=this._toolData,data=toolData.data[toolIndex],points=data.handles.points;if(void 0===data.handles.points){return}if(!1===data.visible){return!1}var handle1=points[handleIndexArray[0]],handle2=points[handleIndexArray[1]],p=FreehandLineFinder.getCanvasPointsFromHandles(handle1,handle2,eventData.element),r=FreehandLineFinder.getLineAsVector(p),m=this._getLineOriginToMouseAsVector(p),mProj=(m[0]*r[0]+m[1]*r[1])/r.magnitude;if(0<mProj&&mProj<r.magnitude){return!0}return!1}},{key:"_getLineOriginToMouseAsVector",value:function _getLineOriginToMouseAsVector(p){var m=[this._mousePoint.x-p[0].x,this._mousePoint.y-p[0].y];return m}},{key:"_distanceOfPointfromLine",value:function _distanceOfPointfromLine(handle1,handle2){var eventData=this._eventData,p1=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,handle1),p2=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(eventData.element,handle2),pMouse=this._mousePoint,twiceAreaOfTriangle=_Mathabs((p2.y-p1.y)*pMouse.x-(p2.x-p1.x)*pMouse.y+p2.x*p1.y-p2.y*p1.x),rMagnitude=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstoneMath.point.distance(p1,p2),d=twiceAreaOfTriangle/rMagnitude;return d}}],[{key:"getCanvasPointsFromHandles",value:function getCanvasPointsFromHandles(handle1,handle2,element){var p=[];if(handle1.x<handle2.x){p.push(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(element,handle1));p.push(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(element,handle2))}else{p.push(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(element,handle2));p.push(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.pixelToCanvas(element,handle1))}return p}},{key:"getLineAsVector",value:function getLineAsVector(p){var r=[p[1].x-p[0].x,p[1].y-p[0].y];r.magnitude=_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstoneMath.point.distance(p[0],p[1]);return r}},{key:"getNextHandleIndex",value:function getNextHandleIndex(currentIndex,length){var nextIndex;if(currentIndex<length-1){nextIndex=currentIndex+1}else{nextIndex=0}return nextIndex}}]);return FreehandLineFinder}()},"./util/freehand/addLine.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(points,insertIndex){if(insertIndex===points.length-1){points[insertIndex].lines.push(points[0])}else{points[insertIndex].lines.push(points[insertIndex+1])}}},"./util/freehand/calculateFreehandStatistics.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _pointInFreehand_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/freehand/pointInFreehand.js");__webpack_exports__["default"]=function(sp,boundingBox,dataHandles){var statisticsObj={count:0,mean:0,variance:0,stdDev:0},sum=getSum(sp,boundingBox,dataHandles);if(0===sum.count){return statisticsObj}statisticsObj.count=sum.count;statisticsObj.mean=sum.value/sum.count;statisticsObj.variance=sum.squared/sum.count-statisticsObj.mean*statisticsObj.mean;statisticsObj.stdDev=_Mathsqrt(statisticsObj.variance);return statisticsObj};function getSum(sp,boundingBox,dataHandles){for(var sum={value:0,squared:0,count:0},index=0,y=boundingBox.top;y<boundingBox.top+boundingBox.height;y++){for(var x=boundingBox.left,point;x<boundingBox.left+boundingBox.width;x++){point={x:x,y:y};sumPointIfInFreehand(dataHandles,point,sum,sp[index]);index++}}return sum}function sumPointIfInFreehand(dataHandles,point,workingSum,pixelValue){if(Object(_pointInFreehand_js__WEBPACK_IMPORTED_MODULE_0__["default"])(dataHandles,point)){workingSum.value+=pixelValue;workingSum.squared+=pixelValue*pixelValue;workingSum.count++}}},"./util/freehand/freehandArea.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(dataHandles,scaling){var freeHandArea=0,j=dataHandles.length-1;scaling=scaling||1;for(var i=0;i<dataHandles.length;i++){freeHandArea+=(dataHandles[j].x+dataHandles[i].x)*(dataHandles[j].y-dataHandles[i].y);j=i}return _Mathabs(freeHandArea*scaling/2)}},"./util/freehand/freehandIntersect.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function newHandle(candidateHandle,dataHandles){var lastHandleId=dataHandles.length-1,lastHandle=getCoords(dataHandles[lastHandleId]),newHandle=getCoords(candidateHandle);return doesIntersectOtherLines(dataHandles,lastHandle,newHandle,[lastHandleId])}function end(dataHandles){var lastHandleId=dataHandles.length-1,lastHandle=getCoords(dataHandles[lastHandleId]),firstHandle=getCoords(dataHandles[0]);return doesIntersectOtherLines(dataHandles,lastHandle,firstHandle,[lastHandleId,0])}function modify(dataHandles,modifiedHandleId){var modifiedHandle=getCoords(dataHandles[modifiedHandleId]),neighborHandleId=modifiedHandleId-1;if(0===modifiedHandleId){neighborHandleId=dataHandles.length-1}var neighborHandle=getCoords(dataHandles[neighborHandleId]);if(doesIntersectOtherLines(dataHandles,modifiedHandle,neighborHandle,[modifiedHandleId,neighborHandleId])){return!0}if(modifiedHandleId===dataHandles.length-1){neighborHandleId=0}else{neighborHandleId=modifiedHandleId+1}neighborHandle=getCoords(dataHandles[neighborHandleId]);return doesIntersectOtherLines(dataHandles,modifiedHandle,neighborHandle,[modifiedHandleId,neighborHandleId])}function doesIntersectOtherLines(dataHandles,p1,q1,ignoredHandleIds){for(var j=dataHandles.length-1,i=0;i<dataHandles.length;i++){if(-1!==ignoredHandleIds.indexOf(i)||-1!==ignoredHandleIds.indexOf(j)){j=i;continue}var p2=getCoords(dataHandles[j]),q2=getCoords(dataHandles[i]);if(doesIntersect(p1,q1,p2,q2)){return!0}j=i}return!1}function doesIntersect(p1,q1,p2,q2){var result=!1,orient=[orientation(p1,q1,p2),orientation(p1,q1,q2),orientation(p2,q2,p1),orientation(p2,q2,q1)];if(orient[0]!==orient[1]&&orient[2]!==orient[3]){return!0}if(0===orient[0]&&onSegment(p1,p2,q1)){result=!0}else if(0===orient[1]&&onSegment(p1,q2,q1)){result=!0}else if(0===orient[2]&&onSegment(p2,p1,q2)){result=!0}else if(0===orient[3]&&onSegment(p2,q1,q2)){result=!0}return result}function getCoords(dataHandle){return{x:dataHandle.x,y:dataHandle.y}}function orientation(p,q,r){var orientationValue=(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y);if(0===orientationValue){return 0}return 0<orientationValue?1:2}function onSegment(p,q,r){if(q.x<=_Mathmax(p.x,r.x)&&q.x>=_Mathmin(p.x,r.x)&&q.y<=_Mathmax(p.y,r.y)&&q.y>=_Mathmin(p.y,r.y)){return!0}return!1}__webpack_exports__["default"]={newHandle:newHandle,end:end,modify:modify}},"./util/freehand/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _calculateFreehandStatistics_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/freehand/calculateFreehandStatistics.js"),_ClickedLineData_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/freehand/ClickedLineData.js"),_freehandArea_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/freehand/freehandArea.js"),_FreehandHandleData_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./util/freehand/FreehandHandleData.js"),_freehandIntersect_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/freehand/freehandIntersect.js"),_FreehandLineFinder_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/freehand/FreehandLineFinder.js"),_insertOrDelete_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./util/freehand/insertOrDelete.js"),_pointInFreehand_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./util/freehand/pointInFreehand.js"),_addLine_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./util/freehand/addLine.js");__webpack_exports__["default"]={calculateFreehandStatistics:_calculateFreehandStatistics_js__WEBPACK_IMPORTED_MODULE_0__["default"],ClickedLineData:_ClickedLineData_js__WEBPACK_IMPORTED_MODULE_1__["default"],freehandArea:_freehandArea_js__WEBPACK_IMPORTED_MODULE_2__["default"],FreehandHandleData:_FreehandHandleData_js__WEBPACK_IMPORTED_MODULE_3__["default"],freehandIntersect:_freehandIntersect_js__WEBPACK_IMPORTED_MODULE_4__["default"],FreehandLineFinder:_FreehandLineFinder_js__WEBPACK_IMPORTED_MODULE_5__["default"],insertOrDelete:_insertOrDelete_js__WEBPACK_IMPORTED_MODULE_6__["default"],pointInFreehand:_pointInFreehand_js__WEBPACK_IMPORTED_MODULE_7__["default"],addLine:_addLine_js__WEBPACK_IMPORTED_MODULE_8__["default"]}},"./util/freehand/insertOrDelete.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _FreehandLineFinder_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/freehand/FreehandLineFinder.js"),_FreehandHandleData_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/freehand/FreehandHandleData.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolState.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js"),_addLine_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./util/freehand/addLine.js");__webpack_exports__["default"]=function(evt,nearby){var eventData=evt.detail;if(nearby&&null!==nearby.handleNearby){var deleteInfo={toolIndex:nearby.toolIndex,handleIndex:nearby.handleNearby};_deletePoint.call(this,eventData,deleteInfo)}else{var freehandLineFinder=new _FreehandLineFinder_js__WEBPACK_IMPORTED_MODULE_0__["default"](eventData,this.name),insertInfo=freehandLineFinder.findLine();if(insertInfo){_insertPoint.call(this,eventData,insertInfo)}}};function _deletePoint(eventData,deleteInfo){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(eventData.element,this.name);if(void 0===toolData){return}var deleteHandle=deleteInfo.handleIndex,toolIndex=deleteInfo.toolIndex,data=toolData.data[toolIndex],points=data.handles.points;if(3>=points.length){return}if(deleteHandle===points.length-1){points[deleteHandle-1].lines.pop();points[deleteHandle-1].lines.push(points[0])}else if(0===deleteHandle){points[points.length-1].lines.pop();points[points.length-1].lines.push(points[deleteHandle+1])}else{points[deleteHandle-1].lines.pop();points[deleteHandle-1].lines.push(points[deleteHandle+1])}points.splice(deleteHandle,1);data.invalidated=!0;data.active=!0;data.highlight=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.updateImage(eventData.element)}function _insertPoint(eventData,insertInfo){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(eventData.element,this.name);if(void 0===toolData){return}var data=toolData.data[insertInfo.toolIndex],insertIndex=_getInsertionIndex(insertInfo);if(insertIndex===1/0){return}var handleData=new _FreehandHandleData_js__WEBPACK_IMPORTED_MODULE_1__["default"](eventData.currentPoints.image),points=data.handles.points;points.splice(insertIndex,0,handleData);points[insertIndex-1].lines.pop();points[insertIndex-1].lines.push(eventData.currentPoints.image);Object(_addLine_js__WEBPACK_IMPORTED_MODULE_4__["default"])(points,insertIndex);data.active=!0;data.highlight=!0;data.invalidated=!0;_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.updateImage(eventData.element)}function _getInsertionIndex(insertInfo){for(var handleIndexArray=insertInfo.handleIndexArray,insertIndex=1/0,arrayContainsZero=handleIndexArray.includes(0),i=0,index;i<handleIndexArray.length;i++){index=handleIndexArray[i];if(0!==index&&index<insertIndex){insertIndex=index}}if(arrayContainsZero&&1===insertIndex){insertIndex=0}insertIndex++;return insertIndex}},"./util/freehand/pointInFreehand.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(dataHandles,location){for(var inROI=!1,j=dataHandles.length-1,i=0;i<dataHandles.length;i++){if(rayFromPointCrosssesLine(location,dataHandles[i],dataHandles[j])){inROI=!inROI}j=i}return inROI};function isEnclosedY(yp,y1,y2){if(y1<yp&&yp<y2||y2<yp&&yp<y1){return!0}return!1}function isLineRightOfPoint(point,lp1,lp2){if(lp1.x>point.x&&lp2.x>point.x){return!0}if(lp1.x===lp2.x){return point.x<lp1.x}if(lp1.x>lp2.x){var lptemp=lp1;lp1=lp2;lp2=lptemp}var lPointY=lineSegmentAtPoint(point,lp1,lp2);if(Math.sign(lPointY.gradient)*point.y>lPointY.value){return!0}return!1}function lineSegmentAtPoint(point,lp1,lp2){var dydx=(lp2.y-lp1.y)/(lp2.x-lp1.x),fx={value:lp1.x+dydx*(point.x-lp1.x),gradient:dydx};return fx}function rayFromPointCrosssesLine(point,handleI,handleJ){if(isEnclosedY(point.y,handleI.y,handleJ.y)&&isLineRightOfPoint(point,handleI,handleJ)){return!0}return!1}},"./util/getDefault.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(value,defaultValue){return void 0===value?defaultValue:value}},"./util/getKeyFromKeyCode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(keyCode){return KEY_CODES[keyCode]};var KEY_CODES={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",13:"RETURN",8:"BACKSPACE",9:"TAB",46:"DELETE",12:"DELETE",27:"ESCAPE",20:"CAPSLOCK",173:"-",189:"-",109:"-",61:"+",187:"+",107:"+",219:"[",221:"]",59:";",186:";",188:",",190:".",199:"/"}},"./util/getLuminance.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(element,x,y,width,height){if(!element){throw new Error("getLuminance: parameter element must not be undefined")}x=_Mathround(x);y=_Mathround(y);var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element),image=enabledElement.image,luminance=[],index=0,pixelData=image.getPixelData(),spIndex,row,column;if(image.color){for(row=0;row<height;row++){for(column=0;column<width;column++){spIndex=4*((row+y)*image.columns+(column+x));var red=pixelData[spIndex],green=pixelData[spIndex+1],blue=pixelData[spIndex+2];luminance[index++]=.2126*red+.7152*green+.0722*blue}}}else{for(row=0;row<height;row++){for(column=0;column<width;column++){spIndex=(row+y)*image.columns+(column+x);luminance[index++]=pixelData[spIndex]*image.slope+image.intercept}}}return luminance}},"./util/getMaxSimultaneousRequests.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"getDefaultSimultaneousRequests",function(){return getDefaultSimultaneousRequests});__webpack_require__.d(__webpack_exports__,"getMaxSimultaneousRequests",function(){return getMaxSimultaneousRequests});__webpack_require__.d(__webpack_exports__,"setMaxSimultaneousRequests",function(){return setMaxSimultaneousRequests});__webpack_require__.d(__webpack_exports__,"getBrowserInfo",function(){return getBrowserInfo});__webpack_require__.d(__webpack_exports__,"isMobileDevice",function(){return isMobileDevice});var configMaxSimultaneousRequests,maxSimultaneousRequests={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function getBrowserInfo(){var ua=navigator.userAgent,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],tem;if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return"IE ".concat(tem[1]||"")}if("Chrome"===M[1]){tem=ua.match(/\b(OPR|Edge)\/(\d+)/);if(null!==tem){return tem.slice(1).join(" ").replace("OPR","Opera")}}M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,"-?"];if(null!==(tem=ua.match(/version\/(\d+)/i))){M.splice(1,1,tem[1])}return M.join(" ")}function setMaxSimultaneousRequests(newMaxSimultaneousRequests){configMaxSimultaneousRequests=newMaxSimultaneousRequests}function getMaxSimultaneousRequests(){if(configMaxSimultaneousRequests){return configMaxSimultaneousRequests}return getDefaultSimultaneousRequests()}function getDefaultSimultaneousRequests(){var infoString=getBrowserInfo(),info=infoString.split(" "),browserName=info[0],browserVersion=info[1],browserData=maxSimultaneousRequests[browserName];if(!browserData){return maxSimultaneousRequests.default}if(!browserData[browserVersion]){return browserData.default}return browserData[browserVersion]}function isMobileDevice(){var pattern=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/;return pattern.test(navigator.userAgent)}},"./util/getRGBPixels.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(element,x,y,width,height){if(!element){throw new Error("getRGBPixels: parameter element must not be undefined")}x=_Mathround(x);y=_Mathround(y);var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element),storedPixelData=[],index=0,pixelData=enabledElement.image.getPixelData(),spIndex,row,column;if(enabledElement.image.color){for(row=0;row<height;row++){for(column=0;column<width;column++){spIndex=4*((row+y)*enabledElement.image.columns+(column+x));var red=pixelData[spIndex],green=pixelData[spIndex+1],blue=pixelData[spIndex+2],alpha=pixelData[spIndex+3];storedPixelData[index++]=red;storedPixelData[index++]=green;storedPixelData[index++]=blue;storedPixelData[index++]=alpha}}}return storedPixelData}},"./util/isObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__);function isObject(value){var type=_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(value);return null!==value&&("object"===type||"function"===type)}__webpack_exports__["default"]=isObject},"./util/lineSegDistance.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(element,start,end,coords){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,lineSegment={start:cornerstone.pixelToCanvas(element,start),end:cornerstone.pixelToCanvas(element,end)};return _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.lineSegment.distanceToPoint(lineSegment,coords)}},"./util/logger.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"getLogger",function(){return getLogger});__webpack_require__.d(__webpack_exports__,"enable",function(){return enable});__webpack_require__.d(__webpack_exports__,"disable",function(){return disable});var debug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/debug/src/browser.js"),debug__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_0__),BASE_SCOPE="cornerstoneTools",baseLogger=debug__WEBPACK_IMPORTED_MODULE_0___default()(BASE_SCOPE),devMode="development"==="development";if(!baseLogger.enabled){console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white");console.info("run %clocalStorage.setItem(\"debug\", \"cornerstoneTools\")%c to see console output","background: #eaeaea; color: #333; font-family: monospace","")}var getLogger=function getLogger(scope){var log=baseLogger.extend(scope);return{log:log,warn:devMode?console.warn.bind(console):log,error:console.error.bind(console)}},enable=function enable(){var scope=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"".concat(BASE_SCOPE,":*");return debug__WEBPACK_IMPORTED_MODULE_0___default.a.enable(scope)},disable=function disable(){return debug__WEBPACK_IMPORTED_MODULE_0___default.a.disable()}},"./util/makeUnselectable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(element,ignorePointerEvents){element.style.webkitUserSelect="none";element.style.webkitTouchCallout="none";element.style.mozUserSelect="none";element.style.msUserSelect="none";element.style.oUserSelect="none";element.style.khtmlUserSelect="none";element.style.userSelect="none";element.unselectable="on";element.oncontextmenu=function(){return!1};if(!0===ignorePointerEvents){element.style.pointerEvents="none"}}},"./util/numbersWithCommas.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return parts.join(".")}},"./util/pointInsideBoundingBox.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(handle,coords){if(!handle.boundingBox){return}return _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.point.insideRect(coords,handle.boundingBox)}},"./util/pointProjector.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"projectPatientPointToImagePlane",function(){return projectPatientPointToImagePlane});__webpack_require__.d(__webpack_exports__,"imagePointToPatientPoint",function(){return imagePointToPatientPoint});__webpack_require__.d(__webpack_exports__,"planePlaneIntersection",function(){return planePlaneIntersection});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/convertToVector3.js");function projectPatientPointToImagePlane(patientPoint,imagePlane){var rowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.rowCosines),columnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.columnCosines),imagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.imagePositionPatient),point=patientPoint.clone().sub(imagePositionPatient),x=rowCosines.dot(point)/imagePlane.columnPixelSpacing,y=columnCosines.dot(point)/imagePlane.rowPixelSpacing;return{x:x,y:y}}function imagePointToPatientPoint(imagePoint,imagePlane){var rowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.rowCosines),columnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.columnCosines),imagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imagePlane.imagePositionPatient),x=rowCosines.clone().multiplyScalar(imagePoint.x);x.multiplyScalar(imagePlane.columnPixelSpacing);var y=columnCosines.clone().multiplyScalar(imagePoint.y);y.multiplyScalar(imagePlane.rowPixelSpacing);var patientPoint=x.add(y);patientPoint.add(imagePositionPatient);return patientPoint}function getRectangleFromImagePlane(imagePlane){var topLeft=imagePointToPatientPoint({x:0,y:0},imagePlane),topRight=imagePointToPatientPoint({x:imagePlane.columns,y:0},imagePlane),bottomLeft=imagePointToPatientPoint({x:0,y:imagePlane.rows},imagePlane),bottomRight=imagePointToPatientPoint({x:imagePlane.columns,y:imagePlane.rows},imagePlane),rect={top:new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Line3(topLeft,topRight),left:new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Line3(topLeft,bottomLeft),right:new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Line3(topRight,bottomRight),bottom:new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Line3(bottomLeft,bottomRight)};return rect}function lineRectangleIntersection(line,rect){var intersections=[];Object.keys(rect).forEach(function(side){var segment=rect[side],intersection=line.intersectLine(segment);if(intersection){intersections.push(intersection)}});return intersections}function planePlaneIntersection(targetImagePlane,referenceImagePlane){var targetRowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(targetImagePlane.rowCosines),targetColumnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(targetImagePlane.columnCosines),targetImagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(targetImagePlane.imagePositionPatient),referenceRowCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(referenceImagePlane.rowCosines),referenceColumnCosines=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(referenceImagePlane.columnCosines),referenceImagePositionPatient=Object(_util_convertToVector3_js__WEBPACK_IMPORTED_MODULE_1__["default"])(referenceImagePlane.imagePositionPatient),targetNormal=targetRowCosines.clone().cross(targetColumnCosines),targetPlane=new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Plane;targetPlane.setFromNormalAndCoplanarPoint(targetNormal,targetImagePositionPatient);var referenceNormal=referenceRowCosines.clone().cross(referenceColumnCosines),referencePlane=new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Plane;referencePlane.setFromNormalAndCoplanarPoint(referenceNormal,referenceImagePositionPatient);var originDirection=referencePlane.clone().intersectPlane(targetPlane),origin=originDirection.origin,direction=originDirection.direction,bottomRight=imagePointToPatientPoint({x:referenceImagePlane.columns,y:referenceImagePlane.rows},referenceImagePlane),distance=referenceImagePositionPatient.distanceTo(bottomRight),line=new _externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstoneMath.Line3;line.start=origin;line.end=origin.clone().add(direction.multiplyScalar(distance));var rect=getRectangleFromImagePlane(referenceImagePlane),intersections=lineRectangleIntersection(line,rect);if(2!==intersections.length){return}return{start:intersections[0],end:intersections[1]}}},"./util/roundToDecimal.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(value,precision){var multiplier=_Mathpow(10,precision);return _Mathround(value*multiplier)/multiplier}},"./util/scroll.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _scrollToIndex_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/scrollToIndex.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./stateManagement/toolState.js"),_clip_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./util/clip.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(element,images){var loop=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,allowSkipping=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_1__.getToolState)(element,"stack");if(!toolData||!toolData.data||!toolData.data.length){return}var stackData=toolData.data[0];if(!stackData.pending){stackData.pending=[]}var newImageIdIndex=stackData.currentImageIdIndex+images;if(loop){var nbImages=stackData.imageIds.length;newImageIdIndex%=nbImages}else{newImageIdIndex=Object(_clip_js__WEBPACK_IMPORTED_MODULE_2__["default"])(newImageIdIndex,0,stackData.imageIds.length-1)}if(allowSkipping){Object(_scrollToIndex_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,newImageIdIndex)}else{var pendingEvent={index:newImageIdIndex};stackData.pending.push(pendingEvent);scrollWithoutSkipping(stackData,pendingEvent,element)}};function scrollWithoutSkipping(stackData,pendingEvent,element){if(stackData.pending[0]===pendingEvent){if(stackData.currentImageIdIndex===pendingEvent.index){stackData.pending.splice(stackData.pending.indexOf(pendingEvent),1);if(0<stackData.pending.length){scrollWithoutSkipping(stackData,stackData.pending[0],element)}return}var newImageHandler=function newImageHandler(event){var index=stackData.imageIds.indexOf(event.detail.image.imageId);if(index===pendingEvent.index){stackData.pending.splice(stackData.pending.indexOf(pendingEvent),1);element.removeEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.NEW_IMAGE,newImageHandler);if(0<stackData.pending.length){scrollWithoutSkipping(stackData,stackData.pending[0],element)}}};element.addEventListener(_externalModules_js__WEBPACK_IMPORTED_MODULE_3__["default"].cornerstone.EVENTS.NEW_IMAGE,newImageHandler);Object(_scrollToIndex_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,pendingEvent.index)}}},"./util/scrollToIndex.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _events_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./events.js"),_externalModules_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./externalModules.js"),_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./stateManagement/toolState.js"),_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./requestPool/requestPoolManager.js"),_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./stateManagement/loadHandlerManager.js"),_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./util/triggerEvent.js");__webpack_exports__["default"]=function(element,newImageIdIndex){var toolData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(element,"stack");if(!toolData||!toolData.data||!toolData.data.length){return}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_1__["default"].cornerstone,stackRenderer;if(1<toolData.data.length){var stackRendererData=Object(_stateManagement_toolState_js__WEBPACK_IMPORTED_MODULE_2__.getToolState)(element,"stackRenderer");if(stackRendererData&&stackRendererData.data&&stackRendererData.data.length){stackRenderer=stackRendererData.data[0]}}var stackData=toolData.data[0];if(0>newImageIdIndex){newImageIdIndex+=stackData.imageIds.length}var startLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].getStartLoadHandler(),endLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].getEndLoadHandler(),errorLoadingHandler=_stateManagement_loadHandlerManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].getErrorLoadingHandler();function doneCallback(image){if(stackData.currentImageIdIndex!==newImageIdIndex){return}try{cornerstone.getEnabledElement(element)}catch(error){return}if(stackRenderer){stackRenderer.currentImageIdIndex=newImageIdIndex;stackRenderer.render(element,toolData.data)}else{cornerstone.displayImage(element,image)}if(endLoadingHandler){endLoadingHandler(element,image)}}function failCallback(error){var imageId=stackData.imageIds[newImageIdIndex];if(errorLoadingHandler){errorLoadingHandler(element,imageId,error)}}if(newImageIdIndex===stackData.currentImageIdIndex){return}if(startLoadingHandler){startLoadingHandler(element)}var eventData={newImageIdIndex:newImageIdIndex,direction:newImageIdIndex-stackData.currentImageIdIndex};stackData.currentImageIdIndex=newImageIdIndex;var newImageId=stackData.imageIds[newImageIdIndex],preventCache=!!stackData.preventCache,imagePromise;if(preventCache){imagePromise=cornerstone.loadImage(newImageId)}else{imagePromise=cornerstone.loadAndCacheImage(newImageId)}imagePromise.then(doneCallback,failCallback);_requestPool_requestPoolManager_js__WEBPACK_IMPORTED_MODULE_3__["default"].startGrabbing();Object(_util_triggerEvent_js__WEBPACK_IMPORTED_MODULE_5__["default"])(element,_events_js__WEBPACK_IMPORTED_MODULE_0__["default"].STACK_SCROLL,eventData)}},"./util/setContextToDisplayFontSize.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");__webpack_exports__["default"]=function(enabledElement,context,fontSize){var fontScale=.1;_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.setToPixelCoordinateSystem(enabledElement,context,fontScale);var scaledFontSize=fontSize/enabledElement.viewport.scale/fontScale,lineHeight=fontSize/enabledElement.viewport.scale/fontScale;return{fontSize:scaledFontSize,lineHeight:lineHeight,fontScale:fontScale}}},"./util/throttle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _debounce_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/debounce.js"),_isObject_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/isObject.js");function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!==typeof func){throw new TypeError("Expected a function")}if(Object(_isObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing}return Object(_debounce_js__WEBPACK_IMPORTED_MODULE_0__["default"])(func,wait,{leading:leading,trailing:trailing,maxWait:wait})}__webpack_exports__["default"]=throttle},"./util/triggerEvent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return triggerEvent});function triggerEvent(el,type){var detail=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,event;if("function"===typeof window.CustomEvent){event=new CustomEvent(type,{detail:detail,cancelable:!0})}else{event=document.createEvent("CustomEvent");event.initCustomEvent(type,!0,!0,detail)}return el.dispatchEvent(event)}},"./util/wait.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"wait",function(){return wait});__webpack_require__.d(__webpack_exports__,"waitForEnabledElementImageToLoad",function(){return waitForEnabledElementImageToLoad});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),wait=function wait(ms){return new Promise(function(resolve){return setTimeout(resolve,ms)})};function waitForEnabledElementImageToLoad(element){try{var enabledElement=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone.getEnabledElement(element);if(!enabledElement.image){return wait(250).then(function(){return waitForEnabledElementImageToLoad(element)})}return enabledElement}catch(ex){return null}}__webpack_exports__["default"]=wait},"./util/zoom/changeViewportScale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(viewport,ticks,scaleLimits){var maxScale=scaleLimits.maxScale,minScale=scaleLimits.minScale,pow=1.7,oldFactor=Math.log(viewport.scale)/0.5306282510621704,factor=oldFactor+ticks,scale=_Mathpow(pow,factor);if(maxScale&&scale>maxScale){viewport.scale=maxScale}else if(minScale&&scale<minScale){viewport.scale=minScale}else{viewport.scale=scale}return viewport}},"./util/zoom/correctShift.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(shift,viewportOrientation){var hflip=viewportOrientation.hflip,vflip=viewportOrientation.vflip,rotation=viewportOrientation.rotation;shift.x*=hflip?-1:1;shift.y*=vflip?-1:1;if(0!==rotation){var angle=rotation*_MathPI/180,cosA=_Mathcos(angle),sinA=_Mathsin(angle),newX=shift.x*cosA-shift.y*sinA,newY=shift.x*sinA+shift.y*cosA;shift.x=newX;shift.y=newY}return shift}},"./util/zoom/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _changeViewportScale_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./util/zoom/changeViewportScale.js");__webpack_require__.d(__webpack_exports__,"changeViewportScale",function(){return _changeViewportScale_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _correctShift_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./util/zoom/correctShift.js");__webpack_require__.d(__webpack_exports__,"correctShift",function(){return _correctShift_js__WEBPACK_IMPORTED_MODULE_1__["default"]});__webpack_exports__["default"]={changeViewportScale:_changeViewportScale_js__WEBPACK_IMPORTED_MODULE_0__["default"],correctShift:_correctShift_js__WEBPACK_IMPORTED_MODULE_1__["default"]}},"./version.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]="3.7.0"}})});