(function webpackUniversalModuleDefinition(root,factory){if("object"===typeof exports&&"object"===typeof module)module.exports=factory();else if("function"===typeof define&&define.amd)define("cornerstoneWADOImageLoader",[],factory);else if("object"===typeof exports)exports.cornerstoneWADOImageLoader=factory();else root.cornerstoneWADOImageLoader=factory()})(this,function(){var _StringfromCharCode=String.fromCharCode,_Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor;return function(modules){function hotDisposeChunk(chunkId){delete installedChunks[chunkId]}var parentHotUpdateCallback=this.webpackHotUpdate_name_;this.webpackHotUpdate_name_=function webpackHotUpdateCallback(chunkId,moreModules){hotAddUpdateChunk(chunkId,moreModules);if(parentHotUpdateCallback)parentHotUpdateCallback(chunkId,moreModules)};function hotDownloadUpdateChunk(chunkId){var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.charset="utf-8";script.src=__webpack_require__.p+""+chunkId+"."+hotCurrentHash+".hot-update.js";if(null)script.crossOrigin=null;head.appendChild(script)}function hotDownloadManifest(requestTimeout){requestTimeout=requestTimeout||1e4;return new Promise(function(resolve,reject){if("undefined"===typeof XMLHttpRequest){return reject(new Error("No browser support"))}try{var request=new XMLHttpRequest,requestPath=__webpack_require__.p+""+hotCurrentHash+".hot-update.json";request.open("GET",requestPath,!0);request.timeout=requestTimeout;request.send(null)}catch(err){return reject(err)}request.onreadystatechange=function(){if(4!==request.readyState)return;if(0===request.status){reject(new Error("Manifest request to "+requestPath+" timed out."))}else if(404===request.status){resolve()}else if(200!==request.status&&304!==request.status){reject(new Error("Manifest request to "+requestPath+" failed."))}else{try{var update=JSON.parse(request.responseText)}catch(e){reject(e);return}resolve(update)}}})}var hotApplyOnUpdate=!0,hotCurrentHash="8ffa164be7f9a32e3dae",hotRequestTimeout=1e4,hotCurrentModuleData={},hotCurrentChildModule,hotCurrentParents=[],hotCurrentParentsTemp=[];function hotCreateRequire(moduleId){var me=installedModules[moduleId];if(!me)return __webpack_require__;var fn=function(request){if(me.hot.active){if(installedModules[request]){if(-1===installedModules[request].parents.indexOf(moduleId)){installedModules[request].parents.push(moduleId)}}else{hotCurrentParents=[moduleId];hotCurrentChildModule=request}if(-1===me.children.indexOf(request)){me.children.push(request)}}else{console.warn("[HMR] unexpected require("+request+") from disposed module "+moduleId);hotCurrentParents=[]}return __webpack_require__(request)},ObjectFactory=function ObjectFactory(name){return{configurable:!0,enumerable:!0,get:function(){return __webpack_require__[name]},set:function(value){__webpack_require__[name]=value}}};for(var name in __webpack_require__){if(Object.prototype.hasOwnProperty.call(__webpack_require__,name)&&"e"!==name&&"t"!==name){Object.defineProperty(fn,name,ObjectFactory(name))}}fn.e=function(chunkId){if("ready"===hotStatus)hotSetStatus("prepare");hotChunksLoading++;return __webpack_require__.e(chunkId).then(finishChunkLoading,function(err){finishChunkLoading();throw err});function finishChunkLoading(){hotChunksLoading--;if("prepare"===hotStatus){if(!hotWaitingFilesMap[chunkId]){hotEnsureUpdateChunk(chunkId)}if(0===hotChunksLoading&&0===hotWaitingFiles){hotUpdateDownloaded()}}}};fn.t=function(value,mode){if(1&mode)value=fn(value);return __webpack_require__.t(value,~1&mode)};return fn}function hotCreateModule(moduleId){var hot={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:hotCurrentChildModule!==moduleId,active:!0,accept:function(dep,callback){if(dep===void 0)hot._selfAccepted=!0;else if("function"===typeof dep)hot._selfAccepted=dep;else if("object"===typeof dep)for(var i=0;i<dep.length;i++)hot._acceptedDependencies[dep[i]]=callback||function(){};else hot._acceptedDependencies[dep]=callback||function(){}},decline:function(dep){if(dep===void 0)hot._selfDeclined=!0;else if("object"===typeof dep)for(var i=0;i<dep.length;i++)hot._declinedDependencies[dep[i]]=!0;else hot._declinedDependencies[dep]=!0},dispose:function(callback){hot._disposeHandlers.push(callback)},addDisposeHandler:function(callback){hot._disposeHandlers.push(callback)},removeDisposeHandler:function(callback){var idx=hot._disposeHandlers.indexOf(callback);if(0<=idx)hot._disposeHandlers.splice(idx,1)},check:hotCheck,apply:hotApply,status:function(l){if(!l)return hotStatus;hotStatusHandlers.push(l)},addStatusHandler:function(l){hotStatusHandlers.push(l)},removeStatusHandler:function(l){var idx=hotStatusHandlers.indexOf(l);if(0<=idx)hotStatusHandlers.splice(idx,1)},data:hotCurrentModuleData[moduleId]};hotCurrentChildModule=void 0;return hot}var hotStatusHandlers=[],hotStatus="idle";function hotSetStatus(newStatus){hotStatus=newStatus;for(var i=0;i<hotStatusHandlers.length;i++)hotStatusHandlers[i].call(null,newStatus)}var hotWaitingFiles=0,hotChunksLoading=0,hotWaitingFilesMap={},hotRequestedFilesMap={},hotAvailableFilesMap={},hotDeferred,hotUpdate,hotUpdateNewHash;function toModuleId(id){var isNumber=+id+""===id;return isNumber?+id:id}function hotCheck(apply){if("idle"!==hotStatus){throw new Error("check() is only allowed in idle status")}hotApplyOnUpdate=apply;hotSetStatus("check");return hotDownloadManifest(hotRequestTimeout).then(function(update){if(!update){hotSetStatus("idle");return null}hotRequestedFilesMap={};hotWaitingFilesMap={};hotAvailableFilesMap=update.c;hotUpdateNewHash=update.h;hotSetStatus("prepare");var promise=new Promise(function(resolve,reject){hotDeferred={resolve:resolve,reject:reject}});hotUpdate={};var chunkId="cornerstoneWADOImageLoader";{hotEnsureUpdateChunk(chunkId)}if("prepare"===hotStatus&&0===hotChunksLoading&&0===hotWaitingFiles){hotUpdateDownloaded()}return promise})}function hotAddUpdateChunk(chunkId,moreModules){if(!hotAvailableFilesMap[chunkId]||!hotRequestedFilesMap[chunkId])return;hotRequestedFilesMap[chunkId]=!1;for(var moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){hotUpdate[moduleId]=moreModules[moduleId]}}if(0===--hotWaitingFiles&&0===hotChunksLoading){hotUpdateDownloaded()}}function hotEnsureUpdateChunk(chunkId){if(!hotAvailableFilesMap[chunkId]){hotWaitingFilesMap[chunkId]=!0}else{hotRequestedFilesMap[chunkId]=!0;hotWaitingFiles++;hotDownloadUpdateChunk(chunkId)}}function hotUpdateDownloaded(){hotSetStatus("ready");var deferred=hotDeferred;hotDeferred=null;if(!deferred)return;if(hotApplyOnUpdate){Promise.resolve().then(function(){return hotApply(hotApplyOnUpdate)}).then(function(result){deferred.resolve(result)},function(err){deferred.reject(err)})}else{var outdatedModules=[];for(var id in hotUpdate){if(Object.prototype.hasOwnProperty.call(hotUpdate,id)){outdatedModules.push(toModuleId(id))}}deferred.resolve(outdatedModules)}}function hotApply(options){if("ready"!==hotStatus)throw new Error("apply() is only allowed in ready status");options=options||{};var cb,i,j,module,moduleId;function getAffectedStuff(updateModuleId){var outdatedModules=[updateModuleId],outdatedDependencies={},queue=outdatedModules.slice().map(function(id){return{chain:[id],id:id}});while(0<queue.length){var queueItem=queue.pop(),moduleId=queueItem.id,chain=queueItem.chain;module=installedModules[moduleId];if(!module||module.hot._selfAccepted)continue;if(module.hot._selfDeclined){return{type:"self-declined",chain:chain,moduleId:moduleId}}if(module.hot._main){return{type:"unaccepted",chain:chain,moduleId:moduleId}}for(var i=0;i<module.parents.length;i++){var parentId=module.parents[i],parent=installedModules[parentId];if(!parent)continue;if(parent.hot._declinedDependencies[moduleId]){return{type:"declined",chain:chain.concat([parentId]),moduleId:moduleId,parentId:parentId}}if(-1!==outdatedModules.indexOf(parentId))continue;if(parent.hot._acceptedDependencies[moduleId]){if(!outdatedDependencies[parentId])outdatedDependencies[parentId]=[];addAllToSet(outdatedDependencies[parentId],[moduleId]);continue}delete outdatedDependencies[parentId];outdatedModules.push(parentId);queue.push({chain:chain.concat([parentId]),id:parentId})}}return{type:"accepted",moduleId:updateModuleId,outdatedModules:outdatedModules,outdatedDependencies:outdatedDependencies}}function addAllToSet(a,b){for(var i=0,item;i<b.length;i++){item=b[i];if(-1===a.indexOf(item))a.push(item)}}var outdatedDependencies={},outdatedModules=[],appliedUpdate={},warnUnexpectedRequire=function warnUnexpectedRequire(){console.warn("[HMR] unexpected require("+result.moduleId+") to disposed module")};for(var id in hotUpdate){if(Object.prototype.hasOwnProperty.call(hotUpdate,id)){moduleId=toModuleId(id);var result;if(hotUpdate[id]){result=getAffectedStuff(moduleId)}else{result={type:"disposed",moduleId:id}}var abortError=!1,doApply=!1,doDispose=!1,chainInfo="";if(result.chain){chainInfo="\nUpdate propagation: "+result.chain.join(" -> ")}switch(result.type){case"self-declined":if(options.onDeclined)options.onDeclined(result);if(!options.ignoreDeclined)abortError=new Error("Aborted because of self decline: "+result.moduleId+chainInfo);break;case"declined":if(options.onDeclined)options.onDeclined(result);if(!options.ignoreDeclined)abortError=new Error("Aborted because of declined dependency: "+result.moduleId+" in "+result.parentId+chainInfo);break;case"unaccepted":if(options.onUnaccepted)options.onUnaccepted(result);if(!options.ignoreUnaccepted)abortError=new Error("Aborted because "+moduleId+" is not accepted"+chainInfo);break;case"accepted":if(options.onAccepted)options.onAccepted(result);doApply=!0;break;case"disposed":if(options.onDisposed)options.onDisposed(result);doDispose=!0;break;default:throw new Error("Unexception type "+result.type);}if(abortError){hotSetStatus("abort");return Promise.reject(abortError)}if(doApply){appliedUpdate[moduleId]=hotUpdate[moduleId];addAllToSet(outdatedModules,result.outdatedModules);for(moduleId in result.outdatedDependencies){if(Object.prototype.hasOwnProperty.call(result.outdatedDependencies,moduleId)){if(!outdatedDependencies[moduleId])outdatedDependencies[moduleId]=[];addAllToSet(outdatedDependencies[moduleId],result.outdatedDependencies[moduleId])}}}if(doDispose){addAllToSet(outdatedModules,[result.moduleId]);appliedUpdate[moduleId]=warnUnexpectedRequire}}}var outdatedSelfAcceptedModules=[];for(i=0;i<outdatedModules.length;i++){moduleId=outdatedModules[i];if(installedModules[moduleId]&&installedModules[moduleId].hot._selfAccepted)outdatedSelfAcceptedModules.push({module:moduleId,errorHandler:installedModules[moduleId].hot._selfAccepted})}hotSetStatus("dispose");Object.keys(hotAvailableFilesMap).forEach(function(chunkId){if(!1===hotAvailableFilesMap[chunkId]){hotDisposeChunk(chunkId)}});var idx,queue=outdatedModules.slice();while(0<queue.length){moduleId=queue.pop();module=installedModules[moduleId];if(!module)continue;var data={},disposeHandlers=module.hot._disposeHandlers;for(j=0;j<disposeHandlers.length;j++){cb=disposeHandlers[j];cb(data)}hotCurrentModuleData[moduleId]=data;module.hot.active=!1;delete installedModules[moduleId];delete outdatedDependencies[moduleId];for(j=0;j<module.children.length;j++){var child=installedModules[module.children[j]];if(!child)continue;idx=child.parents.indexOf(moduleId);if(0<=idx){child.parents.splice(idx,1)}}}var dependency,moduleOutdatedDependencies;for(moduleId in outdatedDependencies){if(Object.prototype.hasOwnProperty.call(outdatedDependencies,moduleId)){module=installedModules[moduleId];if(module){moduleOutdatedDependencies=outdatedDependencies[moduleId];for(j=0;j<moduleOutdatedDependencies.length;j++){dependency=moduleOutdatedDependencies[j];idx=module.children.indexOf(dependency);if(0<=idx)module.children.splice(idx,1)}}}}hotSetStatus("apply");hotCurrentHash=hotUpdateNewHash;for(moduleId in appliedUpdate){if(Object.prototype.hasOwnProperty.call(appliedUpdate,moduleId)){modules[moduleId]=appliedUpdate[moduleId]}}var error=null;for(moduleId in outdatedDependencies){if(Object.prototype.hasOwnProperty.call(outdatedDependencies,moduleId)){module=installedModules[moduleId];if(module){moduleOutdatedDependencies=outdatedDependencies[moduleId];var callbacks=[];for(i=0;i<moduleOutdatedDependencies.length;i++){dependency=moduleOutdatedDependencies[i];cb=module.hot._acceptedDependencies[dependency];if(cb){if(-1!==callbacks.indexOf(cb))continue;callbacks.push(cb)}}for(i=0;i<callbacks.length;i++){cb=callbacks[i];try{cb(moduleOutdatedDependencies)}catch(err){if(options.onErrored){options.onErrored({type:"accept-errored",moduleId:moduleId,dependencyId:moduleOutdatedDependencies[i],error:err})}if(!options.ignoreErrored){if(!error)error=err}}}}}}for(i=0;i<outdatedSelfAcceptedModules.length;i++){var item=outdatedSelfAcceptedModules[i];moduleId=item.module;hotCurrentParents=[moduleId];try{__webpack_require__(moduleId)}catch(err){if("function"===typeof item.errorHandler){try{item.errorHandler(err)}catch(err2){if(options.onErrored){options.onErrored({type:"self-accept-error-handler-errored",moduleId:moduleId,error:err2,originalError:err})}if(!options.ignoreErrored){if(!error)error=err2}if(!error)error=err}}else{if(options.onErrored){options.onErrored({type:"self-accept-errored",moduleId:moduleId,error:err})}if(!options.ignoreErrored){if(!error)error=err}}}}if(error){hotSetStatus("fail");return Promise.reject(error)}hotSetStatus("idle");return new Promise(function(resolve){resolve(outdatedModules)})}var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{},hot:hotCreateModule(moduleId),parents:(hotCurrentParentsTemp=hotCurrentParents,hotCurrentParents=[],hotCurrentParentsTemp),children:[]};modules[moduleId].call(module.exports,module,module.exports,hotCreateRequire(moduleId));module.l=!0;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:!0,get:getter})}};__webpack_require__.r=function(exports){if("undefined"!==typeof Symbol&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:!0})};__webpack_require__.t=function(value,mode){if(1&mode)value=__webpack_require__(value);if(8&mode)return value;if(4&mode&&"object"===typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:!0,value:value});if(2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";__webpack_require__.h=function(){return hotCurrentHash};return hotCreateRequire("./imageLoader/index.js")(__webpack_require__.s="./imageLoader/index.js")}({"./externalModules.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _imageLoader_registerLoaders_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/registerLoaders.js"),cornerstone,dicomParser,external={set cornerstone(cs){cornerstone=cs;Object(_imageLoader_registerLoaders_js__WEBPACK_IMPORTED_MODULE_0__["default"])(cornerstone)},get cornerstone(){if(!cornerstone){if(window&&window.cornerstone){cornerstone=window.cornerstone;Object(_imageLoader_registerLoaders_js__WEBPACK_IMPORTED_MODULE_0__["default"])(cornerstone)}else{throw new Error("cornerstoneWADOImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneWADOImageLoader.external.cornerstone = cornerstone; to your application.")}}return cornerstone},set dicomParser(dp){dicomParser=dp},get dicomParser(){if(!dicomParser){if(window&&window.dicomParser){dicomParser=window.dicomParser}else{throw new Error("cornerstoneWADOImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneWADOImageLoader.external.dicomParser = dicomParser; to your application.")}}return dicomParser}};__webpack_exports__["default"]=external},"./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function convertLUTto8Bit(lut,shift){for(var numEntries=lut.length,cleanedLUT=new Uint8ClampedArray(numEntries),i=0;i<numEntries;++i){cleanedLUT[i]=lut[i]>>shift}return cleanedLUT}__webpack_exports__["default"]=function(imageFrame,rgbaBuffer){for(var numPixels=imageFrame.columns*imageFrame.rows,pixelData=imageFrame.pixelData,rData=imageFrame.redPaletteColorLookupTableData,gData=imageFrame.greenPaletteColorLookupTableData,bData=imageFrame.bluePaletteColorLookupTableData,len=imageFrame.redPaletteColorLookupTableData.length,palIndex=0,rgbaIndex=0,start=imageFrame.redPaletteColorLookupTableDescriptor[1],shift=8===imageFrame.redPaletteColorLookupTableDescriptor[2]?0:8,rDataCleaned=convertLUTto8Bit(rData,shift),gDataCleaned=convertLUTto8Bit(gData,shift),bDataCleaned=convertLUTto8Bit(bData,shift),i=0,value;i<numPixels;++i){value=pixelData[palIndex++];if(value<start){value=0}else if(value>start+len-1){value=len-1}else{value-=start}rgbaBuffer[rgbaIndex++]=rDataCleaned[value];rgbaBuffer[rgbaIndex++]=gDataCleaned[value];rgbaBuffer[rgbaIndex++]=bDataCleaned[value];rgbaBuffer[rgbaIndex++]=255}}},"./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(imageFrame,rgbaBuffer){if(void 0===imageFrame){throw new Error("decodeRGB: rgbBuffer must not be undefined")}if(0!==imageFrame.length%3){throw new Error("decodeRGB: rgbBuffer length must be divisible by 3")}for(var numPixels=imageFrame.length/3,rgbIndex=0,rgbaIndex=0,i=0;i<numPixels;i++){rgbaBuffer[rgbaIndex++]=imageFrame[rgbIndex++];rgbaBuffer[rgbaIndex++]=imageFrame[rgbIndex++];rgbaBuffer[rgbaIndex++]=imageFrame[rgbIndex++];rgbaBuffer[rgbaIndex++]=255}}},"./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(imageFrame,rgbaBuffer){if(void 0===imageFrame){throw new Error("decodeRGB: rgbBuffer must not be undefined")}if(0!==imageFrame.length%3){throw new Error("decodeRGB: rgbBuffer length must be divisible by 3")}for(var numPixels=imageFrame.length/3,rgbaIndex=0,rIndex=0,gIndex=numPixels,bIndex=2*numPixels,i=0;i<numPixels;i++){rgbaBuffer[rgbaIndex++]=imageFrame[rIndex++];rgbaBuffer[rgbaIndex++]=imageFrame[gIndex++];rgbaBuffer[rgbaIndex++]=imageFrame[bIndex++];rgbaBuffer[rgbaIndex++]=255}}},"./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(imageFrame,rgbaBuffer){if(void 0===imageFrame){throw new Error("decodeRGB: ybrBuffer must not be undefined")}if(0!==imageFrame.length%3){throw new Error("decodeRGB: ybrBuffer length must be divisble by 3")}for(var numPixels=imageFrame.length/3,ybrIndex=0,rgbaIndex=0,i=0;i<numPixels;i++){var y=imageFrame[ybrIndex++],cb=imageFrame[ybrIndex++],cr=imageFrame[ybrIndex++];rgbaBuffer[rgbaIndex++]=y+1.402*(cr-128);rgbaBuffer[rgbaIndex++]=y-.34414*(cb-128)-.71414*(cr-128);rgbaBuffer[rgbaIndex++]=y+1.772*(cb-128);rgbaBuffer[rgbaIndex++]=255}}},"./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(imageFrame,rgbaBuffer){if(void 0===imageFrame){throw new Error("decodeRGB: ybrBuffer must not be undefined")}if(0!==imageFrame.length%3){throw new Error("decodeRGB: ybrBuffer length must be divisble by 3")}for(var numPixels=imageFrame.length/3,rgbaIndex=0,yIndex=0,cbIndex=numPixels,crIndex=2*numPixels,i=0;i<numPixels;i++){var y=imageFrame[yIndex++],cb=imageFrame[cbIndex++],cr=imageFrame[crIndex++];rgbaBuffer[rgbaIndex++]=y+1.402*(cr-128);rgbaBuffer[rgbaIndex++]=y-.34414*(cb-128)-.71414*(cr-128);rgbaBuffer[rgbaIndex++]=y+1.772*(cb-128);rgbaBuffer[rgbaIndex++]=255}}},"./imageLoader/colorSpaceConverters/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _convertRGBColorByPixel_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js");__webpack_require__.d(__webpack_exports__,"convertRGBColorByPixel",function(){return _convertRGBColorByPixel_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _convertRGBColorByPlane_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js");__webpack_require__.d(__webpack_exports__,"convertRGBColorByPlane",function(){return _convertRGBColorByPlane_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _convertYBRFullByPixel_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js");__webpack_require__.d(__webpack_exports__,"convertYBRFullByPixel",function(){return _convertYBRFullByPixel_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _convertYBRFullByPlane_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js");__webpack_require__.d(__webpack_exports__,"convertYBRFullByPlane",function(){return _convertYBRFullByPlane_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _convertPALETTECOLOR_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js");__webpack_require__.d(__webpack_exports__,"convertPALETTECOLOR",function(){return _convertPALETTECOLOR_js__WEBPACK_IMPORTED_MODULE_4__["default"]})},"./imageLoader/configure.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _internal_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/internal/index.js");function configure(options){Object(_internal_index_js__WEBPACK_IMPORTED_MODULE_0__.setOptions)(options)}__webpack_exports__["default"]=configure},"./imageLoader/convertColorSpace.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return convertColorSpace});var _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/colorSpaceConverters/index.js");function convertRGB(imageFrame,rgbaBuffer){if(0===imageFrame.planarConfiguration){Object(_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPixel)(imageFrame.pixelData,rgbaBuffer)}else{Object(_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPlane)(imageFrame.pixelData,rgbaBuffer)}}function convertYBRFull(imageFrame,rgbaBuffer){if(0===imageFrame.planarConfiguration){Object(_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPixel)(imageFrame.pixelData,rgbaBuffer)}else{Object(_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPlane)(imageFrame.pixelData,rgbaBuffer)}}function convertColorSpace(imageFrame,imageData){var rgbaBuffer=imageData.data;if("RGB"===imageFrame.photometricInterpretation){convertRGB(imageFrame,rgbaBuffer)}else if("YBR_RCT"===imageFrame.photometricInterpretation){convertRGB(imageFrame,rgbaBuffer)}else if("YBR_ICT"===imageFrame.photometricInterpretation){convertRGB(imageFrame,rgbaBuffer)}else if("PALETTE COLOR"===imageFrame.photometricInterpretation){Object(_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertPALETTECOLOR)(imageFrame,rgbaBuffer)}else if("YBR_FULL_422"===imageFrame.photometricInterpretation){convertRGB(imageFrame,rgbaBuffer)}else if("YBR_FULL"===imageFrame.photometricInterpretation){convertYBRFull(imageFrame,rgbaBuffer)}else{throw new Error("No color space conversion for photometric interpretation ".concat(imageFrame.photometricInterpretation))}}},"./imageLoader/createImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_getImageFrame_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/getImageFrame.js"),_decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/decodeImageFrame.js"),_isColorImage_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/isColorImage.js"),_convertColorSpace_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/convertColorSpace.js"),_shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/getMinMax.js"),_isJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./imageLoader/isJPEGBaseline8BitColor.js"),lastImageIdDrawn="";function isModalityLUTForDisplay(sopClassUid){return"1.2.840.10008.5.1.4.1.1.12.1"!==sopClassUid&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==sopClassUid}function convertToIntPixelData(floatPixelData){for(var floatMinMax=Object(_shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_5__["default"])(floatPixelData),floatRange=Math.abs(floatMinMax.max-floatMinMax.min),intRange=65535,slope=floatRange/intRange,intercept=floatMinMax.min,numPixels=floatPixelData.length,intPixelData=new Uint16Array(numPixels),min=65535,max=0,i=0,rescaledPixel;i<numPixels;i++){rescaledPixel=_Mathfloor((floatPixelData[i]-intercept)/slope);intPixelData[i]=rescaledPixel;min=_Mathmin(min,rescaledPixel);max=_Mathmax(max,rescaledPixel)}return{min:min,max:max,intPixelData:intPixelData,slope:slope,intercept:intercept}}function setPixelDataType(imageFrame){if(32===imageFrame.bitsAllocated){imageFrame.pixelData=new Float32Array(imageFrame.pixelData)}else if(16===imageFrame.bitsAllocated){if(0===imageFrame.pixelRepresentation){imageFrame.pixelData=new Uint16Array(imageFrame.pixelData)}else{imageFrame.pixelData=new Int16Array(imageFrame.pixelData)}}else{imageFrame.pixelData=new Uint8Array(imageFrame.pixelData)}}function createImage(imageId,pixelData,transferSyntax,options){if(!pixelData||!pixelData.length){return Promise.reject(new Error("The file does not contain image data."))}var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,canvas=document.createElement("canvas"),imageFrame=Object(_getImageFrame_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imageId),decodePromise=Object(_decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imageFrame,transferSyntax,pixelData,canvas,options);return new Promise(function(resolve,reject){decodePromise.then(function(imageFrame){var imagePlaneModule=cornerstone.metaData.get("imagePlaneModule",imageId)||{},voiLutModule=cornerstone.metaData.get("voiLutModule",imageId)||{},modalityLutModule=cornerstone.metaData.get("modalityLutModule",imageId)||{},sopCommonModule=cornerstone.metaData.get("sopCommonModule",imageId)||{},isColorImage=Object(_isColorImage_js__WEBPACK_IMPORTED_MODULE_3__["default"])(imageFrame.photometricInterpretation);if(!Object(_isJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_6__["default"])(imageFrame,transferSyntax)){setPixelDataType(imageFrame);if(isColorImage){canvas.height=imageFrame.rows;canvas.width=imageFrame.columns;var context=canvas.getContext("2d"),imageData=context.createImageData(imageFrame.columns,imageFrame.rows);Object(_convertColorSpace_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imageFrame,imageData);imageFrame.imageData=imageData;imageFrame.pixelData=imageData.data;var minMax=Object(_shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_5__["default"])(imageFrame.pixelData);imageFrame.smallestPixelValue=minMax.min;imageFrame.largestPixelValue=minMax.max}}var image={imageId:imageId,color:isColorImage,columnPixelSpacing:imagePlaneModule.columnPixelSpacing,columns:imageFrame.columns,height:imageFrame.rows,intercept:modalityLutModule.rescaleIntercept?modalityLutModule.rescaleIntercept:0,invert:"MONOCHROME1"===imageFrame.photometricInterpretation,minPixelValue:imageFrame.smallestPixelValue,maxPixelValue:imageFrame.largestPixelValue,rowPixelSpacing:imagePlaneModule.rowPixelSpacing,rows:imageFrame.rows,sizeInBytes:imageFrame.pixelData.length,slope:modalityLutModule.rescaleSlope?modalityLutModule.rescaleSlope:1,width:imageFrame.columns,windowCenter:voiLutModule.windowCenter?voiLutModule.windowCenter[0]:void 0,windowWidth:voiLutModule.windowWidth?voiLutModule.windowWidth[0]:void 0,decodeTimeInMS:imageFrame.decodeTimeInMS,floatPixelData:void 0};if(imageFrame.pixelData instanceof Float32Array){var floatPixelData=imageFrame.pixelData,results=convertToIntPixelData(floatPixelData);image.minPixelValue=results.min;image.maxPixelValue=results.max;image.slope=results.slope;image.intercept=results.intercept;image.floatPixelData=floatPixelData;image.getPixelData=function(){return results.intPixelData}}else{image.getPixelData=function(){return imageFrame.pixelData}}if(image.color){image.getCanvas=function(){if(lastImageIdDrawn===imageId){return canvas}canvas.height=image.rows;canvas.width=image.columns;var context=canvas.getContext("2d");context.putImageData(imageFrame.imageData,0,0);lastImageIdDrawn=imageId;return canvas}}if(modalityLutModule.modalityLUTSequence&&0<modalityLutModule.modalityLUTSequence.length&&isModalityLUTForDisplay(sopCommonModule.sopClassUID)){image.modalityLUT=modalityLutModule.modalityLUTSequence[0]}if(voiLutModule.voiLUTSequence&&0<voiLutModule.voiLUTSequence.length){image.voiLUT=voiLutModule.voiLUTSequence[0]}if(image.color){image.windowWidth=255;image.windowCenter=127}if(void 0===image.windowCenter||void 0===image.windowWidth){var maxVoi=image.maxPixelValue*image.slope+image.intercept,minVoi=image.minPixelValue*image.slope+image.intercept;image.windowWidth=maxVoi-minVoi;image.windowCenter=(maxVoi+minVoi)/2}resolve(image)},reject)})}__webpack_exports__["default"]=createImage},"./imageLoader/decodeImageFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _internal_options_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/internal/options.js"),_webWorkerManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/webWorkerManager.js"),_decodeJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/decodeJPEGBaseline8BitColor.js"),_shared_decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./shared/decodeImageFrame.js"),_shared_calculateMinMax_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/calculateMinMax.js"),_shared_decoders_decodeJPEG2000_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/decoders/decodeJPEG2000.js"),_shared_decoders_decodeJPEGLS_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/decoders/decodeJPEGLS.js"),codecsInitialized=!1;function processDecodeTask(imageFrame,transferSyntax,pixelData,options){var priority=options.priority||void 0,transferList=options.transferPixelData?[pixelData.buffer]:void 0,loaderOptions=Object(_internal_options_js__WEBPACK_IMPORTED_MODULE_0__.getOptions)(),strict=loaderOptions.strict,decodeConfig=loaderOptions.decodeConfig,useWebWorkers=loaderOptions.useWebWorkers;if(!1===useWebWorkers){if(!1===codecsInitialized){Object(_shared_decoders_decodeJPEG2000_js__WEBPACK_IMPORTED_MODULE_5__.initializeJPEG2000)(decodeConfig);Object(_shared_decoders_decodeJPEGLS_js__WEBPACK_IMPORTED_MODULE_6__.initializeJPEGLS)(decodeConfig);codecsInitialized=!0}return new Promise(function(resolve,reject){try{var decodeArguments=[imageFrame,transferSyntax,pixelData,decodeConfig,options],decodedImageFrame=_shared_decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_3__["default"].apply(void 0,decodeArguments);Object(_shared_calculateMinMax_js__WEBPACK_IMPORTED_MODULE_4__["default"])(decodedImageFrame,strict);resolve(decodedImageFrame)}catch(error){reject(error)}})}return _webWorkerManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].addTask("decodeTask",{imageFrame:imageFrame,transferSyntax:transferSyntax,pixelData:pixelData,options:options},priority,transferList).promise}function decodeImageFrame(imageFrame,transferSyntax,pixelData,canvas){var options=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};if("1.2.840.10008.1.2"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.1"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.2"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.1.99"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.5"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.50"===transferSyntax){if(8===imageFrame.bitsAllocated&&(3===imageFrame.samplesPerPixel||4===imageFrame.samplesPerPixel)){return Object(_decodeJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imageFrame,pixelData,canvas)}return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.51"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.57"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.70"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.80"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.81"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.90"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}else if("1.2.840.10008.1.2.4.91"===transferSyntax){return processDecodeTask(imageFrame,transferSyntax,pixelData,options)}return new Promise(function(resolve,reject){reject(new Error("No decoder for transfer syntax ".concat(transferSyntax)))})}__webpack_exports__["default"]=decodeImageFrame},"./imageLoader/decodeJPEGBaseline8BitColor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./shared/getMinMax.js");function arrayBufferToString(buffer){return binaryToString(_StringfromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(buffer))))}function binaryToString(binary){var error;try{return decodeURIComponent(escape(binary))}catch(_error){error=_error;if(error instanceof URIError){return binary}throw error}}function decodeJPEGBaseline8BitColor(imageFrame,pixelData,canvas){var start=new Date().getTime(),imgBlob=new Blob([pixelData],{type:"image/jpeg"});return new Promise(function(resolve,reject){var fileReader=new FileReader;if(void 0===fileReader.readAsBinaryString){fileReader.readAsArrayBuffer(imgBlob)}else{fileReader.readAsBinaryString(imgBlob)}fileReader.onload=function(){var img=new Image;img.onload=function(){canvas.height=img.height;canvas.width=img.width;imageFrame.rows=img.height;imageFrame.columns=img.width;var context=canvas.getContext("2d");context.drawImage(this,0,0);var imageData=context.getImageData(0,0,img.width,img.height),end=new Date().getTime();imageFrame.pixelData=imageData.data;imageFrame.imageData=imageData;imageFrame.decodeTimeInMS=end-start;var minMax=Object(_shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageFrame.pixelData);imageFrame.smallestPixelValue=minMax.min;imageFrame.largestPixelValue=minMax.max;resolve(imageFrame)};img.onerror=function(error){reject(error)};if(void 0===fileReader.readAsBinaryString){img.src="data:image/jpeg;base64,".concat(window.btoa(arrayBufferToString(fileReader.result)))}else{img.src="data:image/jpeg;base64,".concat(window.btoa(fileReader.result))}};fileReader.onerror=function(e){reject(e)}})}__webpack_exports__["default"]=decodeJPEGBaseline8BitColor},"./imageLoader/getImageFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");function getImageFrame(imageId){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,imagePixelModule=cornerstone.metaData.get("imagePixelModule",imageId);return{samplesPerPixel:imagePixelModule.samplesPerPixel,photometricInterpretation:imagePixelModule.photometricInterpretation,planarConfiguration:imagePixelModule.planarConfiguration,rows:imagePixelModule.rows,columns:imagePixelModule.columns,bitsAllocated:imagePixelModule.bitsAllocated,bitsStored:imagePixelModule.bitsStored,pixelRepresentation:imagePixelModule.pixelRepresentation,smallestPixelValue:imagePixelModule.smallestPixelValue,largestPixelValue:imagePixelModule.largestPixelValue,redPaletteColorLookupTableDescriptor:imagePixelModule.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:imagePixelModule.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:imagePixelModule.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:imagePixelModule.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:imagePixelModule.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:imagePixelModule.bluePaletteColorLookupTableData,pixelData:void 0}}__webpack_exports__["default"]=getImageFrame},"./imageLoader/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/colorSpaceConverters/index.js");__webpack_require__.d(__webpack_exports__,"convertRGBColorByPixel",function(){return _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPixel});__webpack_require__.d(__webpack_exports__,"convertRGBColorByPlane",function(){return _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPlane});__webpack_require__.d(__webpack_exports__,"convertYBRFullByPixel",function(){return _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPixel});__webpack_require__.d(__webpack_exports__,"convertYBRFullByPlane",function(){return _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPlane});__webpack_require__.d(__webpack_exports__,"convertPALETTECOLOR",function(){return _colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertPALETTECOLOR});var _wadouri_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/index.js");__webpack_require__.d(__webpack_exports__,"wadouri",function(){return _wadouri_index_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _wadors_index_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadors/index.js");__webpack_require__.d(__webpack_exports__,"wadors",function(){return _wadors_index_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _configure_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/configure.js");__webpack_require__.d(__webpack_exports__,"configure",function(){return _configure_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _convertColorSpace_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/convertColorSpace.js");__webpack_require__.d(__webpack_exports__,"convertColorSpace",function(){return _convertColorSpace_js__WEBPACK_IMPORTED_MODULE_4__["default"]});var _createImage_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./imageLoader/createImage.js");__webpack_require__.d(__webpack_exports__,"createImage",function(){return _createImage_js__WEBPACK_IMPORTED_MODULE_5__["default"]});var _decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./imageLoader/decodeImageFrame.js");__webpack_require__.d(__webpack_exports__,"decodeImageFrame",function(){return _decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_6__["default"]});var _decodeJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./imageLoader/decodeJPEGBaseline8BitColor.js");__webpack_require__.d(__webpack_exports__,"decodeJPEGBaseline8BitColor",function(){return _decodeJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_7__["default"]});var _getImageFrame_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./imageLoader/getImageFrame.js");__webpack_require__.d(__webpack_exports__,"getImageFrame",function(){return _getImageFrame_js__WEBPACK_IMPORTED_MODULE_8__["default"]});var _shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./shared/getMinMax.js");__webpack_require__.d(__webpack_exports__,"getMinMax",function(){return _shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_9__["default"]});var _isColorImage_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./imageLoader/isColorImage.js");__webpack_require__.d(__webpack_exports__,"isColorImage",function(){return _isColorImage_js__WEBPACK_IMPORTED_MODULE_10__["default"]});var _isJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./imageLoader/isJPEGBaseline8BitColor.js");__webpack_require__.d(__webpack_exports__,"isJPEGBaseline8BitColor",function(){return _isJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_11__["default"]});var _webWorkerManager_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./imageLoader/webWorkerManager.js");__webpack_require__.d(__webpack_exports__,"webWorkerManager",function(){return _webWorkerManager_js__WEBPACK_IMPORTED_MODULE_12__["default"]});var _version_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./version.js");__webpack_require__.d(__webpack_exports__,"version",function(){return _version_js__WEBPACK_IMPORTED_MODULE_13__["default"]});var _internal_index_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./imageLoader/internal/index.js");__webpack_require__.d(__webpack_exports__,"internal",function(){return _internal_index_js__WEBPACK_IMPORTED_MODULE_14__.internal});var _externalModules_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./externalModules.js");__webpack_require__.d(__webpack_exports__,"external",function(){return _externalModules_js__WEBPACK_IMPORTED_MODULE_15__["default"]});var cornerstoneWADOImageLoader={convertRGBColorByPixel:_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPixel,convertRGBColorByPlane:_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertRGBColorByPlane,convertYBRFullByPixel:_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPixel,convertYBRFullByPlane:_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertYBRFullByPlane,convertPALETTECOLOR:_colorSpaceConverters_index_js__WEBPACK_IMPORTED_MODULE_0__.convertPALETTECOLOR,wadouri:_wadouri_index_js__WEBPACK_IMPORTED_MODULE_1__["default"],wadors:_wadors_index_js__WEBPACK_IMPORTED_MODULE_2__["default"],configure:_configure_js__WEBPACK_IMPORTED_MODULE_3__["default"],convertColorSpace:_convertColorSpace_js__WEBPACK_IMPORTED_MODULE_4__["default"],createImage:_createImage_js__WEBPACK_IMPORTED_MODULE_5__["default"],decodeImageFrame:_decodeImageFrame_js__WEBPACK_IMPORTED_MODULE_6__["default"],decodeJPEGBaseline8BitColor:_decodeJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_7__["default"],getImageFrame:_getImageFrame_js__WEBPACK_IMPORTED_MODULE_8__["default"],getMinMax:_shared_getMinMax_js__WEBPACK_IMPORTED_MODULE_9__["default"],isColorImage:_isColorImage_js__WEBPACK_IMPORTED_MODULE_10__["default"],isJPEGBaseline8BitColor:_isJPEGBaseline8BitColor_js__WEBPACK_IMPORTED_MODULE_11__["default"],webWorkerManager:_webWorkerManager_js__WEBPACK_IMPORTED_MODULE_12__["default"],version:_version_js__WEBPACK_IMPORTED_MODULE_13__["default"],internal:_internal_index_js__WEBPACK_IMPORTED_MODULE_14__.internal,external:_externalModules_js__WEBPACK_IMPORTED_MODULE_15__["default"]};__webpack_exports__["default"]=cornerstoneWADOImageLoader},"./imageLoader/internal/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"internal",function(){return internal});var _xhrRequest_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/internal/xhrRequest.js");__webpack_require__.d(__webpack_exports__,"xhrRequest",function(){return _xhrRequest_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _options_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/internal/options.js");__webpack_require__.d(__webpack_exports__,"setOptions",function(){return _options_js__WEBPACK_IMPORTED_MODULE_1__.setOptions});__webpack_require__.d(__webpack_exports__,"getOptions",function(){return _options_js__WEBPACK_IMPORTED_MODULE_1__.getOptions});var internal={xhrRequest:_xhrRequest_js__WEBPACK_IMPORTED_MODULE_0__["default"],setOptions:_options_js__WEBPACK_IMPORTED_MODULE_1__.setOptions,getOptions:_options_js__WEBPACK_IMPORTED_MODULE_1__.getOptions}},"./imageLoader/internal/options.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"setOptions",function(){return setOptions});__webpack_require__.d(__webpack_exports__,"getOptions",function(){return getOptions});var options={beforeSend:function beforeSend(){},imageCreated:function imageCreated(){},strict:!1,useWebWorkers:!0,decodeConfig:{usePDFJS:!1}};function setOptions(newOptions){options=Object.assign(options,newOptions)}function getOptions(){return options}},"./imageLoader/internal/xhrRequest.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_options_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/internal/options.js");function xhrRequest(url,imageId){var headers=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},params=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,options=Object(_options_js__WEBPACK_IMPORTED_MODULE_1__.getOptions)();return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("get",url,!0);xhr.responseType="arraybuffer";options.beforeSend(xhr,imageId,headers,params);Object.keys(headers).forEach(function(key){xhr.setRequestHeader(key,headers[key])});params.deferred={resolve:resolve,reject:reject};params.url=url;params.imageId=imageId;xhr.onloadstart=function(event){if(options.onloadstart){options.onloadstart(event,params)}var eventData={url:url,imageId:imageId};cornerstone.triggerEvent(cornerstone.events,"cornerstoneimageloadstart",eventData)};xhr.onloadend=function(event){if(options.onloadend){options.onloadend(event,params)}var eventData={url:url,imageId:imageId};cornerstone.triggerEvent(cornerstone.events,"cornerstoneimageloadend",eventData)};xhr.onreadystatechange=function(event){if(options.onreadystatechange){options.onreadystatechange(event,params);return}if(4===xhr.readyState){if(200===xhr.status){resolve(xhr.response,xhr)}else{reject(xhr)}}};xhr.onprogress=function(oProgress){var loaded=oProgress.loaded,total,percentComplete;if(oProgress.lengthComputable){total=oProgress.total;percentComplete=Math.round(100*(loaded/total))}if(options.onprogress){options.onprogress(oProgress,params)}var eventData={url:url,imageId:imageId,loaded:loaded,total:total,percentComplete:percentComplete};cornerstone.triggerEvent(cornerstone.events,"cornerstoneimageloadprogress",eventData)};xhr.send()})}__webpack_exports__["default"]=xhrRequest},"./imageLoader/isColorImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]=function(photoMetricInterpretation){return"RGB"===photoMetricInterpretation||"PALETTE COLOR"===photoMetricInterpretation||"YBR_FULL"===photoMetricInterpretation||"YBR_FULL_422"===photoMetricInterpretation||"YBR_PARTIAL_422"===photoMetricInterpretation||"YBR_PARTIAL_420"===photoMetricInterpretation||"YBR_RCT"===photoMetricInterpretation||"YBR_ICT"===photoMetricInterpretation}},"./imageLoader/isJPEGBaseline8BitColor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function isJPEGBaseline8BitColor(imageFrame,transferSyntax){transferSyntax=transferSyntax||imageFrame.transferSyntax;if(8===imageFrame.bitsAllocated&&"1.2.840.10008.1.2.4.50"===transferSyntax&&(3===imageFrame.samplesPerPixel||4===imageFrame.samplesPerPixel)){return!0}}__webpack_exports__["default"]=isJPEGBaseline8BitColor},"./imageLoader/registerLoaders.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _wadors_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/index.js"),_wadouri_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/index.js");function registerLoaders(cornerstone){_wadors_index_js__WEBPACK_IMPORTED_MODULE_0__["default"].register(cornerstone);_wadouri_index_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(cornerstone)}__webpack_exports__["default"]=registerLoaders},"./imageLoader/wadors/findIndexOfString.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function checkToken(token,data,dataOffset){if(dataOffset+token.length>data.length){return!1}for(var endIndex=dataOffset,i=0;i<token.length;i++){if(token[i]!==data[endIndex++]){return!1}}return!0}function stringToUint8Array(str){for(var uint=new Uint8Array(str.length),i=0,j=str.length;i<j;i++){uint[i]=str.charCodeAt(i)}return uint}function findIndexOfString(data,str,offset){offset=offset||0;for(var token=stringToUint8Array(str),i=offset;i<data.length;i++){if(token[0]===data[i]){if(checkToken(token,data,i)){return i}}}return-1}__webpack_exports__["default"]=findIndexOfString},"./imageLoader/wadors/getPixelData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _internal_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/internal/index.js"),_findIndexOfString_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/findIndexOfString.js");function findBoundary(header){for(var i=0;i<header.length;i++){if("--"===header[i].substr(0,2)){return header[i]}}}function findContentType(header){for(var i=0;i<header.length;i++){if("Content-Type:"===header[i].substr(0,13)){return header[i].substr(13).trim()}}}function uint8ArrayToString(data,offset,length){offset=offset||0;length=length||data.length-offset;for(var str="",i=offset;i<offset+length;i++){str+=_StringfromCharCode(data[i])}return str}function getPixelData(uri,imageId){var mediaType=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"application/octet-stream",headers={accept:mediaType};return new Promise(function(resolve,reject){var loadPromise=Object(_internal_index_js__WEBPACK_IMPORTED_MODULE_0__.xhrRequest)(uri,imageId,headers);loadPromise.then(function(imageFrameAsArrayBuffer){var response=new Uint8Array(imageFrameAsArrayBuffer),tokenIndex=Object(_findIndexOfString_js__WEBPACK_IMPORTED_MODULE_1__["default"])(response,"\r\n\r\n");if(-1===tokenIndex){reject(new Error("invalid response - no multipart mime header"))}var header=uint8ArrayToString(response,0,tokenIndex),split=header.split("\r\n"),boundary=findBoundary(split);if(!boundary){reject(new Error("invalid response - no boundary marker"))}var offset=tokenIndex+4,endIndex=Object(_findIndexOfString_js__WEBPACK_IMPORTED_MODULE_1__["default"])(response,boundary,offset);if(-1===endIndex){reject(new Error("invalid response - terminating boundary not found"))}var length=endIndex-offset-2;resolve({contentType:findContentType(split),imageFrame:{pixelData:new Uint8Array(imageFrameAsArrayBuffer,offset,length)}})})})}__webpack_exports__["default"]=getPixelData},"./imageLoader/wadors/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _metaData_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/metaData/index.js"),_findIndexOfString_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/findIndexOfString.js"),_getPixelData_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadors/getPixelData.js"),_metaDataManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadors/metaDataManager.js"),_loadImage_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadors/loadImage.js"),_register_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./imageLoader/wadors/register.js"),metaData={getNumberString:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getNumberString,getNumberValue:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getNumberValue,getNumberValues:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getNumberValues,getValue:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getValue,metaDataProvider:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.metaDataProvider};__webpack_exports__["default"]={metaData:metaData,findIndexOfString:_findIndexOfString_js__WEBPACK_IMPORTED_MODULE_1__["default"],getPixelData:_getPixelData_js__WEBPACK_IMPORTED_MODULE_2__["default"],loadImage:_loadImage_js__WEBPACK_IMPORTED_MODULE_4__["default"],metaDataManager:_metaDataManager_js__WEBPACK_IMPORTED_MODULE_3__["default"],register:_register_js__WEBPACK_IMPORTED_MODULE_5__["default"]}},"./imageLoader/wadors/loadImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"getTransferSyntaxForContentType",function(){return getTransferSyntaxForContentType});var _metaDataManager_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/metaDataManager.js"),_getPixelData_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/getPixelData.js"),_createImage_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/createImage.js");function getTransferSyntaxForContentType(contentType){var defaultTransferSyntax="1.2.840.10008.1.2";if(!contentType){return defaultTransferSyntax}var parameters=contentType.split(";"),params={};parameters.forEach(function(parameter){var parameterValues=parameter.split("=");if(2!==parameterValues.length){return}var value=parameterValues[1].trim().replace(/"/g,"");params[parameterValues[0].trim()]=value});var defaultTransferSyntaxByType={"image/jpeg":"1.2.840.10008.1.2.4.70","image/x-dicom-rle":"1.2.840.10008.1.2.5","image/x-jls":"1.2.840.10008.1.2.4.80","image/jp2":"1.2.840.10008.1.2.4.90","image/jpx":"1.2.840.10008.1.2.4.92"};if(params["transfer-syntax"]){return params["transfer-syntax"]}else if(contentType&&!Object.keys(params).length&&defaultTransferSyntaxByType[contentType]){return defaultTransferSyntaxByType[contentType]}else if(params.type&&defaultTransferSyntaxByType[params.type]){return defaultTransferSyntaxByType[params.type]}return defaultTransferSyntax}function loadImage(imageId,options){var start=new Date().getTime(),uri=imageId.substring(7),promise=new Promise(function(resolve,reject){var metaData=_metaDataManager_js__WEBPACK_IMPORTED_MODULE_0__["default"].get(imageId);if(void 0===metaData){var error=new Error("no metadata for imageId ".concat(imageId));return reject(error)}var mediaType="multipart/related; type=\"application/octet-stream\"";Object(_getPixelData_js__WEBPACK_IMPORTED_MODULE_1__["default"])(uri,imageId,mediaType).then(function(result){var transferSyntax=getTransferSyntaxForContentType(result.contentType),pixelData=result.imageFrame.pixelData,imagePromise=Object(_createImage_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imageId,pixelData,transferSyntax,options);imagePromise.then(function(image){var end=new Date().getTime();image.loadTimeInMS=end-start;resolve(image)},reject)},reject)});return{promise:promise,cancelFn:void 0}}__webpack_exports__["default"]=loadImage},"./imageLoader/wadors/metaData/getNumberString.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getValue_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/metaData/getValue.js");function getNumberString(element,index,defaultValue){var value=Object(_getValue_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,index,defaultValue);if(void 0===value){return}return parseFloat(value)}__webpack_exports__["default"]=getNumberString},"./imageLoader/wadors/metaData/getNumberValue.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getValue_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/metaData/getValue.js");function getNumberValue(element,index){var value=Object(_getValue_js__WEBPACK_IMPORTED_MODULE_0__["default"])(element,index);if(void 0===value){return}return parseFloat(value)}__webpack_exports__["default"]=getNumberValue},"./imageLoader/wadors/metaData/getNumberValues.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getNumberValues(element,minimumLength){if(!element){return}if(!element.Value){return}if(minimumLength&&element.Value.length<minimumLength){return}for(var values=[],i=0;i<element.Value.length;i++){values.push(parseFloat(element.Value[i]))}return values}__webpack_exports__["default"]=getNumberValues},"./imageLoader/wadors/metaData/getValue.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getValue(element,index,defaultValue){index=index||0;if(!element){return defaultValue}if(!element.Value){return defaultValue}if(element.Value.length<=index){return defaultValue}return element.Value[index]}__webpack_exports__["default"]=getValue},"./imageLoader/wadors/metaData/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getNumberString_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/metaData/getNumberString.js");__webpack_require__.d(__webpack_exports__,"getNumberString",function(){return _getNumberString_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _getNumberValue_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/metaData/getNumberValue.js");__webpack_require__.d(__webpack_exports__,"getNumberValue",function(){return _getNumberValue_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _getNumberValues_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadors/metaData/getNumberValues.js");__webpack_require__.d(__webpack_exports__,"getNumberValues",function(){return _getNumberValues_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _getValue_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadors/metaData/getValue.js");__webpack_require__.d(__webpack_exports__,"getValue",function(){return _getValue_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _metaDataProvider_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadors/metaData/metaDataProvider.js");__webpack_require__.d(__webpack_exports__,"metaDataProvider",function(){return _metaDataProvider_js__WEBPACK_IMPORTED_MODULE_4__["default"]})},"./imageLoader/wadors/metaData/metaDataProvider.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/metaData/getNumberValues.js"),_getValue_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadors/metaData/getValue.js"),_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadors/metaData/getNumberValue.js"),_metaDataManager_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadors/metaDataManager.js");function metaDataProvider(type,imageId){var dicomParser=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].dicomParser,metaData=_metaDataManager_js__WEBPACK_IMPORTED_MODULE_4__["default"].get(imageId);if(!metaData){return}if("generalSeriesModule"===type){return{modality:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00080060"]),seriesInstanceUID:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["0020000e"]),seriesNumber:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00200011"]),studyInstanceUID:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["0020000d"]),seriesDate:dicomParser.parseDA(Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00080021"])),seriesTime:dicomParser.parseTM(Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00080031"],0,""))}}if("patientStudyModule"===type){return{patientAge:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00101010"]),patientSize:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00101020"]),patientWeight:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00101030"])}}if("imagePlaneModule"===type){var imageOrientationPatient=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00200037"],6),imagePositionPatient=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00200032"],3),pixelSpacing=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00280030"],2),columnPixelSpacing=null,rowPixelSpacing=null;if(pixelSpacing){rowPixelSpacing=pixelSpacing[0];columnPixelSpacing=pixelSpacing[1]}var rowCosines=null,columnCosines=null;if(imageOrientationPatient){rowCosines=[parseFloat(imageOrientationPatient[0]),parseFloat(imageOrientationPatient[1]),parseFloat(imageOrientationPatient[2])];columnCosines=[parseFloat(imageOrientationPatient[3]),parseFloat(imageOrientationPatient[4]),parseFloat(imageOrientationPatient[5])]}return{frameOfReferenceUID:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00200052"]),rows:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280010"]),columns:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280011"]),imageOrientationPatient:imageOrientationPatient,rowCosines:rowCosines,columnCosines:columnCosines,imagePositionPatient:imagePositionPatient,sliceThickness:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00180050"]),sliceLocation:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00201041"]),pixelSpacing:pixelSpacing,rowPixelSpacing:rowPixelSpacing,columnPixelSpacing:columnPixelSpacing}}if("imagePixelModule"===type){return{samplesPerPixel:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280002"]),photometricInterpretation:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00280004"]),rows:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280010"]),columns:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280011"]),bitsAllocated:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280100"]),bitsStored:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280101"]),highBit:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00280102"]),pixelRepresentation:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280103"]),planarConfiguration:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280006"]),pixelAspectRatio:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00280034"]),smallestPixelValue:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280106"]),largestPixelValue:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00280107"]),redPaletteColorLookupTableDescriptor:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281101"]),greenPaletteColorLookupTableDescriptor:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281102"]),bluePaletteColorLookupTableDescriptor:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281103"]),redPaletteColorLookupTableData:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281201"]),greenPaletteColorLookupTableData:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281202"]),bluePaletteColorLookupTableData:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281203"])}}if("voiLutModule"===type){return{windowCenter:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281050"],1),windowWidth:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(metaData["00281051"],1)}}if("modalityLutModule"===type){return{rescaleIntercept:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00281052"]),rescaleSlope:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(metaData["00281053"]),rescaleType:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00281054"])}}if("sopCommonModule"===type){return{sopClassUID:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00080016"]),sopInstanceUID:Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00080018"])}}if("petIsotopeModule"===type){var radiopharmaceuticalInfo=Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(metaData["00540016"]);if(void 0===radiopharmaceuticalInfo){return}return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:dicomParser.parseTM(Object(_getValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(radiopharmaceuticalInfo["00181072"],0,"")),radionuclideTotalDose:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(radiopharmaceuticalInfo["00181074"]),radionuclideHalfLife:Object(_getNumberValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(radiopharmaceuticalInfo["00181075"])}}}}__webpack_exports__["default"]=metaDataProvider},"./imageLoader/wadors/metaDataManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var imageIds=[];function add(imageId,metadata){imageIds[imageId]=metadata}function get(imageId){return imageIds[imageId]}function remove(imageId){imageIds[imageId]=void 0}function purge(){imageIds=[]}__webpack_exports__["default"]={add:add,get:get,remove:remove,purge:purge}},"./imageLoader/wadors/register.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _loadImage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadors/loadImage.js"),_metaData_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadors/metaData/index.js");__webpack_exports__["default"]=function(cornerstone){cornerstone.registerImageLoader("wadors",_loadImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);cornerstone.metaData.addProvider(_metaData_index_js__WEBPACK_IMPORTED_MODULE_1__.metaDataProvider)}},"./imageLoader/wadouri/dataSetCacheManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"getInfo",function(){return getInfo});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_internal_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/internal/index.js"),cacheSizeInBytes=0,loadedDataSets={},promises={};function isLoaded(uri){return void 0!==loadedDataSets[uri]}function get(uri){if(!loadedDataSets[uri]){return}return loadedDataSets[uri].dataSet}function load(uri){var loadRequest=1<arguments.length&&void 0!==arguments[1]?arguments[1]:_internal_index_js__WEBPACK_IMPORTED_MODULE_1__.xhrRequest,imageId=2<arguments.length?arguments[2]:void 0,cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone,dicomParser=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].dicomParser;if(loadedDataSets[uri]){return new Promise(function(resolve){loadedDataSets[uri].cacheCount++;resolve(loadedDataSets[uri].dataSet)})}if(promises[uri]){promises[uri].cacheCount++;return promises[uri]}var loadDICOMPromise=loadRequest(uri,imageId),promise=new Promise(function(resolve,reject){loadDICOMPromise.then(function(dicomPart10AsArrayBuffer){var byteArray=new Uint8Array(dicomPart10AsArrayBuffer),dataSet;try{dataSet=dicomParser.parseDicom(byteArray)}catch(error){return reject(error)}loadedDataSets[uri]={dataSet:dataSet,cacheCount:promise.cacheCount};cacheSizeInBytes+=dataSet.byteArray.length;resolve(dataSet);cornerstone.triggerEvent(cornerstone.events,"datasetscachechanged",{uri:uri,action:"loaded",cacheInfo:getInfo()})},reject).then(function(){delete promises[uri]},function(){delete promises[uri]})});promise.cacheCount=1;promises[uri]=promise;return promise}function unload(uri){var cornerstone=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].cornerstone;if(loadedDataSets[uri]){loadedDataSets[uri].cacheCount--;if(0===loadedDataSets[uri].cacheCount){cacheSizeInBytes-=loadedDataSets[uri].dataSet.byteArray.length;delete loadedDataSets[uri];cornerstone.triggerEvent(cornerstone.events,"datasetscachechanged",{uri:uri,action:"unloaded",cacheInfo:getInfo()})}}}function getInfo(){return{cacheSizeInBytes:cacheSizeInBytes,numberOfDataSetsCached:Object.keys(loadedDataSets).length}}function purge(){loadedDataSets={};promises={}}__webpack_exports__["default"]={isLoaded:isLoaded,load:load,unload:unload,getInfo:getInfo,purge:purge,get:get}},"./imageLoader/wadouri/fileManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var files=[];function add(file){var fileIndex=files.push(file);return"dicomfile:".concat(fileIndex-1)}function get(index){return files[index]}function remove(index){files[index]=void 0}function purge(){files=[]}__webpack_exports__["default"]={add:add,get:get,remove:remove,purge:purge}},"./imageLoader/wadouri/getEncapsulatedImageFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return getEncapsulatedImageFrame});var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js");function framesAreFragmented(dataSet){var numberOfFrames=dataSet.intString("x00280008"),pixelDataElement=dataSet.elements.x7fe00010;return numberOfFrames!==pixelDataElement.fragments.length}function getEncapsulatedImageFrame(dataSet,frameIndex){var dicomParser=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].dicomParser;if(dataSet.elements.x7fe00010&&dataSet.elements.x7fe00010.basicOffsetTable.length){return dicomParser.readEncapsulatedImageFrame(dataSet,dataSet.elements.x7fe00010,frameIndex)}if(framesAreFragmented(dataSet)){var basicOffsetTable=dicomParser.createJPEGBasicOffsetTable(dataSet,dataSet.elements.x7fe00010);return dicomParser.readEncapsulatedImageFrame(dataSet,dataSet.elements.x7fe00010,frameIndex,basicOffsetTable)}return dicomParser.readEncapsulatedPixelDataFromFragments(dataSet,dataSet.elements.x7fe00010,frameIndex)}},"./imageLoader/wadouri/getPixelData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getEncapsulatedImageFrame_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/getEncapsulatedImageFrame.js"),_getUncompressedImageFrame_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/getUncompressedImageFrame.js");function getPixelData(dataSet){var frameIndex=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,pixelDataElement=dataSet.elements.x7fe00010||dataSet.elements.x7fe00008;if(!pixelDataElement){return null}if(pixelDataElement.encapsulatedPixelData){return Object(_getEncapsulatedImageFrame_js__WEBPACK_IMPORTED_MODULE_0__["default"])(dataSet,frameIndex)}return Object(_getUncompressedImageFrame_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,frameIndex)}__webpack_exports__["default"]=getPixelData},"./imageLoader/wadouri/getUncompressedImageFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _unpackBinaryFrame_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/unpackBinaryFrame.js");function getUncompressedImageFrame(dataSet,frameIndex){var pixelDataElement=dataSet.elements.x7fe00010||dataSet.elements.x7fe00008,bitsAllocated=dataSet.uint16("x00280100"),rows=dataSet.uint16("x00280010"),columns=dataSet.uint16("x00280011"),samplesPerPixel=dataSet.uint16("x00280002"),pixelDataOffset=pixelDataElement.dataOffset,pixelsPerFrame=rows*columns*samplesPerPixel,frameOffset;if(8===bitsAllocated){frameOffset=pixelDataOffset+frameIndex*pixelsPerFrame;if(frameOffset>=dataSet.byteArray.length){throw new Error("frame exceeds size of pixelData")}return new Uint8Array(dataSet.byteArray.buffer,frameOffset,pixelsPerFrame)}else if(16===bitsAllocated){frameOffset=pixelDataOffset+2*(frameIndex*pixelsPerFrame);if(frameOffset>=dataSet.byteArray.length){throw new Error("frame exceeds size of pixelData")}return new Uint8Array(dataSet.byteArray.buffer,frameOffset,2*pixelsPerFrame)}else if(1===bitsAllocated){frameOffset=pixelDataOffset+.125*(frameIndex*pixelsPerFrame);if(frameOffset>=dataSet.byteArray.length){throw new Error("frame exceeds size of pixelData")}return Object(_unpackBinaryFrame_js__WEBPACK_IMPORTED_MODULE_0__["default"])(dataSet.byteArray,frameOffset,pixelsPerFrame)}else if(32===bitsAllocated){frameOffset=pixelDataOffset+4*(frameIndex*pixelsPerFrame);if(frameOffset>=dataSet.byteArray.length){throw new Error("frame exceeds size of pixelData")}return new Uint8Array(dataSet.byteArray.buffer,frameOffset,4*pixelsPerFrame)}throw new Error("unsupported pixel format")}__webpack_exports__["default"]=getUncompressedImageFrame},"./imageLoader/wadouri/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _metaData_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/metaData/index.js"),_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/dataSetCacheManager.js"),_fileManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadouri/fileManager.js"),_getEncapsulatedImageFrame_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadouri/getEncapsulatedImageFrame.js"),_getUncompressedImageFrame_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadouri/getUncompressedImageFrame.js"),_loadFileRequest_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./imageLoader/wadouri/loadFileRequest.js"),_loadImage_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./imageLoader/wadouri/loadImage.js"),_parseImageId_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./imageLoader/wadouri/parseImageId.js"),_unpackBinaryFrame_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./imageLoader/wadouri/unpackBinaryFrame.js"),_register_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./imageLoader/wadouri/register.js"),metaData={getImagePixelModule:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getImagePixelModule,getLUTs:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getLUTs,getModalityLUTOutputPixelRepresentation:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getModalityLUTOutputPixelRepresentation,getNumberValues:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.getNumberValues,metaDataProvider:_metaData_index_js__WEBPACK_IMPORTED_MODULE_0__.metaDataProvider};__webpack_exports__["default"]={metaData:metaData,dataSetCacheManager:_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_1__["default"],fileManager:_fileManager_js__WEBPACK_IMPORTED_MODULE_2__["default"],getEncapsulatedImageFrame:_getEncapsulatedImageFrame_js__WEBPACK_IMPORTED_MODULE_3__["default"],getUncompressedImageFrame:_getUncompressedImageFrame_js__WEBPACK_IMPORTED_MODULE_4__["default"],loadFileRequest:_loadFileRequest_js__WEBPACK_IMPORTED_MODULE_5__["default"],loadImageFromPromise:_loadImage_js__WEBPACK_IMPORTED_MODULE_6__.loadImageFromPromise,getLoaderForScheme:_loadImage_js__WEBPACK_IMPORTED_MODULE_6__.getLoaderForScheme,loadImage:_loadImage_js__WEBPACK_IMPORTED_MODULE_6__.loadImage,parseImageId:_parseImageId_js__WEBPACK_IMPORTED_MODULE_7__["default"],unpackBinaryFrame:_unpackBinaryFrame_js__WEBPACK_IMPORTED_MODULE_8__["default"],register:_register_js__WEBPACK_IMPORTED_MODULE_9__["default"]}},"./imageLoader/wadouri/loadFileRequest.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _parseImageId_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/parseImageId.js"),_fileManager_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/fileManager.js");function loadFileRequest(uri){var parsedImageId=Object(_parseImageId_js__WEBPACK_IMPORTED_MODULE_0__["default"])(uri),fileIndex=parseInt(parsedImageId.url,10),file=_fileManager_js__WEBPACK_IMPORTED_MODULE_1__["default"].get(fileIndex);return new Promise(function(resolve,reject){var fileReader=new FileReader;fileReader.onload=function(e){var dicomPart10AsArrayBuffer=e.target.result;resolve(dicomPart10AsArrayBuffer)};fileReader.onerror=reject;fileReader.readAsArrayBuffer(file)})}__webpack_exports__["default"]=loadFileRequest},"./imageLoader/wadouri/loadImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"loadImageFromPromise",function(){return loadImageFromPromise});__webpack_require__.d(__webpack_exports__,"getLoaderForScheme",function(){return getLoaderForScheme});__webpack_require__.d(__webpack_exports__,"loadImage",function(){return loadImage});var _createImage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/createImage.js"),_parseImageId_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/parseImageId.js"),_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadouri/dataSetCacheManager.js"),_loadFileRequest_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadouri/loadFileRequest.js"),_getPixelData_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadouri/getPixelData.js"),_internal_index_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./imageLoader/internal/index.js");function addDecache(imageLoadObject,imageId){imageLoadObject.decache=function(){var parsedImageId=Object(_parseImageId_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imageId);_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].unload(parsedImageId.url)}}function loadImageFromPromise(dataSetPromise,imageId){var frame=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,sharedCacheKey=3<arguments.length?arguments[3]:void 0,options=4<arguments.length?arguments[4]:void 0,callbacks=5<arguments.length?arguments[5]:void 0,start=new Date().getTime(),imageLoadObject={cancelFn:void 0};imageLoadObject.promise=new Promise(function(resolve,reject){dataSetPromise.then(function(dataSet){var pixelData=Object(_getPixelData_js__WEBPACK_IMPORTED_MODULE_4__["default"])(dataSet,frame),transferSyntax=dataSet.string("x00020010"),loadEnd=new Date().getTime(),imagePromise=Object(_createImage_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageId,pixelData,transferSyntax,options);addDecache(imageLoadObject,imageId);imagePromise.then(function(image){image.data=dataSet;image.sharedCacheKey=sharedCacheKey;var end=new Date().getTime();image.loadTimeInMS=loadEnd-start;image.totalTimeInMS=end-start;if(void 0!==callbacks&&void 0!==callbacks.imageDoneCallback){callbacks.imageDoneCallback(image)}resolve(image)},function(error){reject({error:error,dataSet:dataSet})})},function(error){reject({error:error})})});return imageLoadObject}function loadImageFromDataSet(dataSet,imageId){var frame=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,sharedCacheKey=3<arguments.length?arguments[3]:void 0,options=4<arguments.length?arguments[4]:void 0,start=new Date().getTime(),promise=new Promise(function(resolve,reject){var loadEnd=new Date().getTime(),imagePromise;try{var pixelData=Object(_getPixelData_js__WEBPACK_IMPORTED_MODULE_4__["default"])(dataSet,frame),transferSyntax=dataSet.string("x00020010");imagePromise=Object(_createImage_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageId,pixelData,transferSyntax,options)}catch(error){reject({error:error,dataSet:dataSet});return}imagePromise.then(function(image){image.data=dataSet;image.sharedCacheKey=sharedCacheKey;var end=new Date().getTime();image.loadTimeInMS=loadEnd-start;image.totalTimeInMS=end-start;resolve(image)},reject)});return{promise:promise,cancelFn:void 0}}function getLoaderForScheme(scheme){if("dicomweb"===scheme||"wadouri"===scheme){return _internal_index_js__WEBPACK_IMPORTED_MODULE_5__.xhrRequest}else if("dicomfile"===scheme){return _loadFileRequest_js__WEBPACK_IMPORTED_MODULE_3__["default"]}}function loadImage(imageId){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},parsedImageId=Object(_parseImageId_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imageId);options=Object.assign({},options);var loader=options.loader;if(void 0===loader){loader=getLoaderForScheme(parsedImageId.scheme)}else{delete options.loader}if(_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].isLoaded(parsedImageId.url)){var dataSet=_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].get(parsedImageId.url,loader,imageId);return loadImageFromDataSet(dataSet,imageId,parsedImageId.frame,parsedImageId.url,options)}var dataSetPromise=_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_2__["default"].load(parsedImageId.url,loader,imageId);return loadImageFromPromise(dataSetPromise,imageId,parsedImageId.frame,parsedImageId.url,options)}},"./imageLoader/wadouri/metaData/getImagePixelModule.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getLutDescriptor(dataSet,tag){if(!dataSet.elements[tag]||6!==dataSet.elements[tag].length){return}return[dataSet.uint16(tag,0),dataSet.uint16(tag,1),dataSet.uint16(tag,2)]}function getLutData(lutDataSet,tag,lutDescriptor){for(var lut=[],lutData=lutDataSet.elements[tag],i=0;i<lutDescriptor[0];i++){if(16===lutDescriptor[2]){lut[i]=lutDataSet.uint16(tag,i)}else{lut[i]=lutDataSet.byteArray[i+lutData.dataOffset]}}return lut}function populatePaletteColorLut(dataSet,imagePixelModule){imagePixelModule.redPaletteColorLookupTableDescriptor=getLutDescriptor(dataSet,"x00281101");imagePixelModule.greenPaletteColorLookupTableDescriptor=getLutDescriptor(dataSet,"x00281102");imagePixelModule.bluePaletteColorLookupTableDescriptor=getLutDescriptor(dataSet,"x00281103");if(0===imagePixelModule.redPaletteColorLookupTableDescriptor[0]){imagePixelModule.redPaletteColorLookupTableDescriptor[0]=65536;imagePixelModule.greenPaletteColorLookupTableDescriptor[0]=65536;imagePixelModule.bluePaletteColorLookupTableDescriptor[0]=65536}var numLutEntries=imagePixelModule.redPaletteColorLookupTableDescriptor[0],lutData=dataSet.elements.x00281201,lutBitsAllocated=lutData.length===numLutEntries?8:16;if(imagePixelModule.redPaletteColorLookupTableDescriptor[2]!==lutBitsAllocated){imagePixelModule.redPaletteColorLookupTableDescriptor[2]=lutBitsAllocated;imagePixelModule.greenPaletteColorLookupTableDescriptor[2]=lutBitsAllocated;imagePixelModule.bluePaletteColorLookupTableDescriptor[2]=lutBitsAllocated}imagePixelModule.redPaletteColorLookupTableData=getLutData(dataSet,"x00281201",imagePixelModule.redPaletteColorLookupTableDescriptor);imagePixelModule.greenPaletteColorLookupTableData=getLutData(dataSet,"x00281202",imagePixelModule.greenPaletteColorLookupTableDescriptor);imagePixelModule.bluePaletteColorLookupTableData=getLutData(dataSet,"x00281203",imagePixelModule.bluePaletteColorLookupTableDescriptor)}function populateSmallestLargestPixelValues(dataSet,imagePixelModule){var pixelRepresentation=dataSet.uint16("x00280103");if(0===pixelRepresentation){imagePixelModule.smallestPixelValue=dataSet.uint16("x00280106");imagePixelModule.largestPixelValue=dataSet.uint16("x00280107")}else{imagePixelModule.smallestPixelValue=dataSet.int16("x00280106");imagePixelModule.largestPixelValue=dataSet.int16("x00280107")}}function getImagePixelModule(dataSet){var imagePixelModule={samplesPerPixel:dataSet.uint16("x00280002"),photometricInterpretation:dataSet.string("x00280004"),rows:dataSet.uint16("x00280010"),columns:dataSet.uint16("x00280011"),bitsAllocated:dataSet.uint16("x00280100"),bitsStored:dataSet.uint16("x00280101"),highBit:dataSet.uint16("x00280102"),pixelRepresentation:dataSet.uint16("x00280103"),planarConfiguration:dataSet.uint16("x00280006"),pixelAspectRatio:dataSet.string("x00280034")};populateSmallestLargestPixelValues(dataSet,imagePixelModule);if("PALETTE COLOR"===imagePixelModule.photometricInterpretation&&dataSet.elements.x00281101){populatePaletteColorLut(dataSet,imagePixelModule)}return imagePixelModule}__webpack_exports__["default"]=getImagePixelModule},"./imageLoader/wadouri/metaData/getLUTs.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getLUT(pixelRepresentation,lutDataSet){var numLUTEntries=lutDataSet.uint16("x00283002",0);if(0===numLUTEntries){numLUTEntries=65535}var firstValueMapped=0;if(0===pixelRepresentation){firstValueMapped=lutDataSet.uint16("x00283002",1)}else{firstValueMapped=lutDataSet.int16("x00283002",1)}for(var numBitsPerEntry=lutDataSet.uint16("x00283002",2),lut={id:"1",firstValueMapped:firstValueMapped,numBitsPerEntry:numBitsPerEntry,lut:[]},i=0;i<numLUTEntries;i++){if(0===pixelRepresentation){lut.lut[i]=lutDataSet.uint16("x00283006",i)}else{lut.lut[i]=lutDataSet.int16("x00283006",i)}}return lut}function getLUTs(pixelRepresentation,lutSequence){if(!lutSequence||!lutSequence.items.length){return}for(var luts=[],i=0;i<lutSequence.items.length;i++){var lutDataSet=lutSequence.items[i].dataSet,lut=getLUT(pixelRepresentation,lutDataSet);if(lut){luts.push(lut)}}return luts}__webpack_exports__["default"]=getLUTs},"./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getMinStoredPixelValue(dataSet){var pixelRepresentation=dataSet.uint16("x00280103"),bitsStored=dataSet.uint16("x00280101");if(0===pixelRepresentation){return 0}return-1<<bitsStored-1}function getModalityLUTOutputPixelRepresentation(dataSet){var sopClassUID=dataSet.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===sopClassUID||"1.2.840.10008.5.1.4.1.1.2.1"===sopClassUID){return 1}var rescaleIntercept=dataSet.floatString("x00281052"),rescaleSlope=dataSet.floatString("x00281053");if(void 0!==rescaleIntercept&&void 0!==rescaleSlope){var minStoredPixelValue=getMinStoredPixelValue(dataSet),minModalityLutValue=minStoredPixelValue*rescaleSlope+rescaleIntercept;if(0>minModalityLutValue){return 1}return 0}if(dataSet.elements.x00283000&&0<dataSet.elements.x00283000.length){return 0}return dataSet.uint16("x00280103")}__webpack_exports__["default"]=getModalityLUTOutputPixelRepresentation},"./imageLoader/wadouri/metaData/getNumberValues.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getNumberValues(dataSet,tag,minimumLength){var values=[],valueAsString=dataSet.string(tag);if(!valueAsString){return}var split=valueAsString.split("\\");if(minimumLength&&split.length<minimumLength){return}for(var i=0;i<split.length;i++){values.push(parseFloat(split[i]))}return values}__webpack_exports__["default"]=getNumberValues},"./imageLoader/wadouri/metaData/index.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _getImagePixelModule_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/metaData/getImagePixelModule.js");__webpack_require__.d(__webpack_exports__,"getImagePixelModule",function(){return _getImagePixelModule_js__WEBPACK_IMPORTED_MODULE_0__["default"]});var _getLUTs_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/metaData/getLUTs.js");__webpack_require__.d(__webpack_exports__,"getLUTs",function(){return _getLUTs_js__WEBPACK_IMPORTED_MODULE_1__["default"]});var _getModalityLUTOutputPixelRepresentation_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js");__webpack_require__.d(__webpack_exports__,"getModalityLUTOutputPixelRepresentation",function(){return _getModalityLUTOutputPixelRepresentation_js__WEBPACK_IMPORTED_MODULE_2__["default"]});var _getNumberValues_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadouri/metaData/getNumberValues.js");__webpack_require__.d(__webpack_exports__,"getNumberValues",function(){return _getNumberValues_js__WEBPACK_IMPORTED_MODULE_3__["default"]});var _metaDataProvider_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadouri/metaData/metaDataProvider.js");__webpack_require__.d(__webpack_exports__,"metaDataProvider",function(){return _metaDataProvider_js__WEBPACK_IMPORTED_MODULE_4__["default"]})},"./imageLoader/wadouri/metaData/metaDataProvider.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _externalModules_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./externalModules.js"),_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/metaData/getNumberValues.js"),_parseImageId_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./imageLoader/wadouri/parseImageId.js"),_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./imageLoader/wadouri/dataSetCacheManager.js"),_getImagePixelModule_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./imageLoader/wadouri/metaData/getImagePixelModule.js"),_getLUTs_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./imageLoader/wadouri/metaData/getLUTs.js"),_getModalityLUTOutputPixelRepresentation_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js");function metaDataProvider(type,imageId){var dicomParser=_externalModules_js__WEBPACK_IMPORTED_MODULE_0__["default"].dicomParser,parsedImageId=Object(_parseImageId_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imageId),dataSet=_dataSetCacheManager_js__WEBPACK_IMPORTED_MODULE_3__["default"].get(parsedImageId.url);if(!dataSet){return}if("generalSeriesModule"===type){return{modality:dataSet.string("x00080060"),seriesInstanceUID:dataSet.string("x0020000e"),seriesNumber:dataSet.intString("x00200011"),studyInstanceUID:dataSet.string("x0020000d"),seriesDate:dicomParser.parseDA(dataSet.string("x00080021")),seriesTime:dicomParser.parseTM(dataSet.string("x00080031")||"")}}if("patientStudyModule"===type){return{patientAge:dataSet.intString("x00101010"),patientSize:dataSet.floatString("x00101020"),patientWeight:dataSet.floatString("x00101030")}}if("imagePlaneModule"===type){var imageOrientationPatient=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,"x00200037",6),imagePositionPatient=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,"x00200032",3),pixelSpacing=Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,"x00280030",2),columnPixelSpacing=null,rowPixelSpacing=null;if(pixelSpacing){rowPixelSpacing=pixelSpacing[0];columnPixelSpacing=pixelSpacing[1]}var rowCosines=null,columnCosines=null;if(imageOrientationPatient){rowCosines=[parseFloat(imageOrientationPatient[0]),parseFloat(imageOrientationPatient[1]),parseFloat(imageOrientationPatient[2])];columnCosines=[parseFloat(imageOrientationPatient[3]),parseFloat(imageOrientationPatient[4]),parseFloat(imageOrientationPatient[5])]}return{frameOfReferenceUID:dataSet.string("x00200052"),rows:dataSet.uint16("x00280010"),columns:dataSet.uint16("x00280011"),imageOrientationPatient:imageOrientationPatient,rowCosines:rowCosines,columnCosines:columnCosines,imagePositionPatient:imagePositionPatient,sliceThickness:dataSet.floatString("x00180050"),sliceLocation:dataSet.floatString("x00201041"),pixelSpacing:pixelSpacing,rowPixelSpacing:rowPixelSpacing,columnPixelSpacing:columnPixelSpacing}}if("imagePixelModule"===type){return Object(_getImagePixelModule_js__WEBPACK_IMPORTED_MODULE_4__["default"])(dataSet)}if("modalityLutModule"===type){return{rescaleIntercept:dataSet.floatString("x00281052"),rescaleSlope:dataSet.floatString("x00281053"),rescaleType:dataSet.string("x00281054"),modalityLUTSequence:Object(_getLUTs_js__WEBPACK_IMPORTED_MODULE_5__["default"])(dataSet.uint16("x00280103"),dataSet.elements.x00283000)}}if("voiLutModule"===type){var modalityLUTOutputPixelRepresentation=Object(_getModalityLUTOutputPixelRepresentation_js__WEBPACK_IMPORTED_MODULE_6__["default"])(dataSet);return{windowCenter:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,"x00281050",1),windowWidth:Object(_getNumberValues_js__WEBPACK_IMPORTED_MODULE_1__["default"])(dataSet,"x00281051",1),voiLUTSequence:Object(_getLUTs_js__WEBPACK_IMPORTED_MODULE_5__["default"])(modalityLUTOutputPixelRepresentation,dataSet.elements.x00283010)}}if("sopCommonModule"===type){return{sopClassUID:dataSet.string("x00080016"),sopInstanceUID:dataSet.string("x00080018")}}if("petIsotopeModule"===type){var radiopharmaceuticalInfo=dataSet.elements.x00540016;if(void 0===radiopharmaceuticalInfo){return}var firstRadiopharmaceuticalInfoDataSet=radiopharmaceuticalInfo.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:dicomParser.parseTM(firstRadiopharmaceuticalInfoDataSet.string("x00181072")||""),radionuclideTotalDose:firstRadiopharmaceuticalInfoDataSet.floatString("x00181074"),radionuclideHalfLife:firstRadiopharmaceuticalInfoDataSet.floatString("x00181075")}}}}__webpack_exports__["default"]=metaDataProvider},"./imageLoader/wadouri/parseImageId.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function parseImageId(imageId){var firstColonIndex=imageId.indexOf(":"),url=imageId.substring(firstColonIndex+1),frameIndex=url.indexOf("frame="),frame;if(-1!==frameIndex){var frameStr=url.substr(frameIndex+6);frame=parseInt(frameStr,10);url=url.substr(0,frameIndex-1)}return{scheme:imageId.substr(0,firstColonIndex),url:url,frame:frame}}__webpack_exports__["default"]=parseImageId},"./imageLoader/wadouri/register.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _loadImage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/wadouri/loadImage.js"),_metaData_index_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./imageLoader/wadouri/metaData/index.js");__webpack_exports__["default"]=function(cornerstone){cornerstone.registerImageLoader("dicomweb",_loadImage_js__WEBPACK_IMPORTED_MODULE_0__.loadImage);cornerstone.registerImageLoader("wadouri",_loadImage_js__WEBPACK_IMPORTED_MODULE_0__.loadImage);cornerstone.registerImageLoader("dicomfile",_loadImage_js__WEBPACK_IMPORTED_MODULE_0__.loadImage);cornerstone.metaData.addProvider(_metaData_index_js__WEBPACK_IMPORTED_MODULE_1__.metaDataProvider)}},"./imageLoader/wadouri/unpackBinaryFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function isBitSet(byte,bitPos){return byte&1<<bitPos}function unpackBinaryFrame(byteArray,frameOffset,pixelsPerFrame){for(var pixelData=new Uint8Array(pixelsPerFrame),i=0;i<pixelsPerFrame;i++){var bytePos=_Mathfloor(i/8),byte=byteArray[bytePos+frameOffset],bitPos=i%8;pixelData[i]=isBitSet(byte,bitPos)?1:0}return pixelData}__webpack_exports__["default"]=unpackBinaryFrame},"./imageLoader/webWorkerManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _internal_options_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./imageLoader/internal/options.js"),nextTaskId=0,tasks=[],webWorkers=[],options=Object(_internal_options_js__WEBPACK_IMPORTED_MODULE_0__.getOptions)(),defaultConfig={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerPath:"../../dist/cornerstoneWADOImageLoaderWebWorker.js",webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{loadCodecsOnStartup:!0,initializeCodecsOnStartup:!1,codecsPath:"../dist/cornerstoneWADOImageLoaderCodecs.js",usePDFJS:!1,strict:options.strict}}},config,statistics={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};function startTaskOnWebWorker(){if(!tasks.length){return}for(var i=0;i<webWorkers.length;i++){if("ready"===webWorkers[i].status){webWorkers[i].status="busy";var task=tasks.shift();task.start=new Date().getTime();var end=new Date().getTime();statistics.totalTimeDelayedInMS+=end-task.added;webWorkers[i].task=task;webWorkers[i].worker.postMessage({taskType:task.taskType,workerIndex:i,data:task.data},task.transferList);statistics.numTasksExecuting++;return}}if(webWorkers.length<config.maxWebWorkers){spawnWebWorker()}}function handleMessageFromWorker(msg){if("initialize"===msg.data.taskType){webWorkers[msg.data.workerIndex].status="ready";startTaskOnWebWorker()}else{var start=webWorkers[msg.data.workerIndex].task.start;webWorkers[msg.data.workerIndex].task.deferred.resolve(msg.data.result);webWorkers[msg.data.workerIndex].task=void 0;statistics.numTasksExecuting--;webWorkers[msg.data.workerIndex].status="ready";statistics.numTasksCompleted++;var end=new Date().getTime();statistics.totalTaskTimeInMS+=end-start;startTaskOnWebWorker()}}function spawnWebWorker(){if(webWorkers.length>=config.maxWebWorkers){return}var worker=new Worker(config.webWorkerPath);webWorkers.push({worker:worker,status:"initializing"});worker.addEventListener("message",handleMessageFromWorker);worker.postMessage({taskType:"initialize",workerIndex:webWorkers.length-1,config:config})}function initialize(configObject){configObject=configObject||defaultConfig;if(config){throw new Error("WebWorkerManager already initialized")}config=configObject;config.maxWebWorkers=config.maxWebWorkers||navigator.hardwareConcurrency||1;if(!config.startWebWorkersOnDemand){for(var i=0;i<config.maxWebWorkers;i++){spawnWebWorker()}}}function loadWebWorkerTask(sourcePath,taskConfig){config.webWorkerTaskPaths.push(sourcePath);if(taskConfig){config.taskConfiguration=Object.assign(config.taskConfiguration,taskConfig)}for(var i=0;i<webWorkers.length;i++){webWorkers[i].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:webWorkers.length-1,sourcePath:sourcePath,config:config})}}function addTask(taskType,data){var priority=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,transferList=3<arguments.length?arguments[3]:void 0;if(!config){initialize()}var deferred={},promise=new Promise(function(resolve,reject){deferred={resolve:resolve,reject:reject}}),i;for(i=0;i<tasks.length;i++){if(tasks[i].priority<priority){break}}var taskId=nextTaskId++;tasks.splice(i,0,{taskId:taskId,taskType:taskType,status:"ready",added:new Date().getTime(),data:data,deferred:deferred,priority:priority,transferList:transferList});startTaskOnWebWorker();return{taskId:taskId,promise:promise}}function setTaskPriority(taskId){for(var priority=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=0;i<tasks.length;i++){if(tasks[i].taskId===taskId){var task=tasks.splice(i,1)[0];task.priority=priority;for(i=0;i<tasks.length;i++){if(tasks[i].priority<priority){break}}tasks.splice(i,0,task);return!0}}return!1}function cancelTask(taskId,reason){for(var i=0;i<tasks.length;i++){if(tasks[i].taskId===taskId){var task=tasks.splice(i,1);task.deferred.reject(reason);return!0}}return!1}function getStatistics(){statistics.maxWebWorkers=config.maxWebWorkers;statistics.numWebWorkers=webWorkers.length;statistics.numTasksQueued=tasks.length;return statistics}__webpack_exports__["default"]={initialize:initialize,loadWebWorkerTask:loadWebWorkerTask,addTask:addTask,getStatistics:getStatistics,setTaskPriority:setTaskPriority,cancelTask:cancelTask}},"./shared/calculateMinMax.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",function(){return calculateMinMax});var _getMinMax_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./shared/getMinMax.js");function calculateMinMax(imageFrame){var strict=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,minMax=Object(_getMinMax_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageFrame.pixelData),mustAssign=!(isNumber(imageFrame.smallestPixelValue)&&isNumber(imageFrame.largestPixelValue));if(!0===strict&&!mustAssign){if(imageFrame.smallestPixelValue!==minMax.min){console.warn("Image smallestPixelValue tag is incorrect. Rendering performance will suffer considerably.")}if(imageFrame.largestPixelValue!==minMax.max){console.warn("Image largestPixelValue tag is incorrect. Rendering performance will suffer considerably.")}}else{imageFrame.smallestPixelValue=minMax.min;imageFrame.largestPixelValue=minMax.max}}function isNumber(numValue){return"number"===typeof numValue}},"./shared/decodeImageFrame.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _decoders_decodeLittleEndian_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./shared/decoders/decodeLittleEndian.js"),_decoders_decodeBigEndian_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./shared/decoders/decodeBigEndian.js"),_decoders_decodeRLE_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./shared/decoders/decodeRLE.js"),_decoders_decodeJPEGBaseline_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./shared/decoders/decodeJPEGBaseline.js"),_decoders_decodeJPEGLossless_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/decoders/decodeJPEGLossless.js"),_decoders_decodeJPEGLS_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/decoders/decodeJPEGLS.js"),_decoders_decodeJPEG2000_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/decoders/decodeJPEG2000.js");function decodeImageFrame(imageFrame,transferSyntax,pixelData,decodeConfig,options){var start=new Date().getTime();if("1.2.840.10008.1.2"===transferSyntax){imageFrame=Object(_decoders_decodeLittleEndian_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.1"===transferSyntax){imageFrame=Object(_decoders_decodeLittleEndian_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.2"===transferSyntax){imageFrame=Object(_decoders_decodeBigEndian_js__WEBPACK_IMPORTED_MODULE_1__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.1.99"===transferSyntax){imageFrame=Object(_decoders_decodeLittleEndian_js__WEBPACK_IMPORTED_MODULE_0__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.5"===transferSyntax){imageFrame=Object(_decoders_decodeRLE_js__WEBPACK_IMPORTED_MODULE_2__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.50"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGBaseline_js__WEBPACK_IMPORTED_MODULE_3__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.51"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGBaseline_js__WEBPACK_IMPORTED_MODULE_3__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.57"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGLossless_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.70"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGLossless_js__WEBPACK_IMPORTED_MODULE_4__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.80"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGLS_js__WEBPACK_IMPORTED_MODULE_5__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.81"===transferSyntax){imageFrame=Object(_decoders_decodeJPEGLS_js__WEBPACK_IMPORTED_MODULE_5__["default"])(imageFrame,pixelData)}else if("1.2.840.10008.1.2.4.90"===transferSyntax){imageFrame=Object(_decoders_decodeJPEG2000_js__WEBPACK_IMPORTED_MODULE_6__["default"])(imageFrame,pixelData,decodeConfig,options)}else if("1.2.840.10008.1.2.4.91"===transferSyntax){imageFrame=Object(_decoders_decodeJPEG2000_js__WEBPACK_IMPORTED_MODULE_6__["default"])(imageFrame,pixelData,decodeConfig,options)}else{throw new Error("no decoder for transfer syntax ".concat(transferSyntax))}var shouldShift=void 0!==imageFrame.pixelRepresentation&&1===imageFrame.pixelRepresentation,shift=shouldShift&&void 0!==imageFrame.bitsStored?32-imageFrame.bitsStored:void 0;if(shouldShift&&void 0!==shift){for(var i=0;i<imageFrame.pixelData.length;i++){imageFrame.pixelData[i]=imageFrame.pixelData[i]<<shift>>shift}}var end=new Date().getTime();imageFrame.decodeTimeInMS=end-start;return imageFrame}__webpack_exports__["default"]=decodeImageFrame},"./shared/decoders/decodeBigEndian.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function swap16(val){return(255&val)<<8|255&val>>8}function decodeBigEndian(imageFrame,pixelData){if(16===imageFrame.bitsAllocated){var arrayBuffer=pixelData.buffer,offset=pixelData.byteOffset,length=pixelData.length;if(offset%2){arrayBuffer=arrayBuffer.slice(offset);offset=0}if(0===imageFrame.pixelRepresentation){imageFrame.pixelData=new Uint16Array(arrayBuffer,offset,length/2)}else{imageFrame.pixelData=new Int16Array(arrayBuffer,offset,length/2)}for(var i=0;i<imageFrame.pixelData.length;i++){imageFrame.pixelData[i]=swap16(imageFrame.pixelData[i])}}else if(8===imageFrame.bitsAllocated){imageFrame.pixelData=pixelData}return imageFrame}__webpack_exports__["default"]=decodeBigEndian},"./shared/decoders/decodeJPEG2000.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"initializeJPEG2000",function(){return initializeJPEG2000});function decodeJpx(imageFrame,pixelData){var jpxImage=new JpxImage;jpxImage.parse(pixelData);var tileCount=jpxImage.tiles.length;if(1!==tileCount){throw new Error("JPEG2000 decoder returned a tileCount of ".concat(tileCount,", when 1 is expected"))}imageFrame.columns=jpxImage.width;imageFrame.rows=jpxImage.height;imageFrame.pixelData=jpxImage.tiles[0].items;return imageFrame}var openJPEG;function decodeOpenJPEG(data,bytesPerPixel,signed){var dataPtr=openJPEG._malloc(data.length);openJPEG.writeArrayToMemory(data,dataPtr);var imagePtrPtr=openJPEG._malloc(4),imageSizePtr=openJPEG._malloc(4),imageSizeXPtr=openJPEG._malloc(4),imageSizeYPtr=openJPEG._malloc(4),imageSizeCompPtr=openJPEG._malloc(4),t0=new Date().getTime(),ret=openJPEG.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[dataPtr,data.length,imagePtrPtr,imageSizePtr,imageSizeXPtr,imageSizeYPtr,imageSizeCompPtr]);if(0!==ret){console.log("[opj_decode] decoding failed!");openJPEG._free(dataPtr);openJPEG._free(openJPEG.getValue(imagePtrPtr,"*"));openJPEG._free(imageSizeXPtr);openJPEG._free(imageSizeYPtr);openJPEG._free(imageSizePtr);openJPEG._free(imageSizeCompPtr);return}var imagePtr=openJPEG.getValue(imagePtrPtr,"*"),image={length:openJPEG.getValue(imageSizePtr,"i32"),sx:openJPEG.getValue(imageSizeXPtr,"i32"),sy:openJPEG.getValue(imageSizeYPtr,"i32"),nbChannels:openJPEG.getValue(imageSizeCompPtr,"i32"),perf_timetodecode:void 0,pixelData:void 0},length=image.sx*image.sy*image.nbChannels,src32=new Int32Array(openJPEG.HEAP32.buffer,imagePtr,length);if(1===bytesPerPixel){if(Uint8Array.from){image.pixelData=Uint8Array.from(src32)}else{image.pixelData=new Uint8Array(length);for(var i=0;i<length;i++){image.pixelData[i]=src32[i]}}}else if(signed){if(Int16Array.from){image.pixelData=Int16Array.from(src32)}else{image.pixelData=new Int16Array(length);for(var _i=0;_i<length;_i++){image.pixelData[_i]=src32[_i]}}}else if(Uint16Array.from){image.pixelData=Uint16Array.from(src32)}else{image.pixelData=new Uint16Array(length);for(var _i2=0;_i2<length;_i2++){image.pixelData[_i2]=src32[_i2]}}var t1=new Date().getTime();image.perf_timetodecode=t1-t0;openJPEG._free(dataPtr);openJPEG._free(imagePtrPtr);openJPEG._free(imagePtr);openJPEG._free(imageSizePtr);openJPEG._free(imageSizeXPtr);openJPEG._free(imageSizeYPtr);openJPEG._free(imageSizeCompPtr);return image}function decodeOpenJpeg2000(imageFrame,pixelData){var bytesPerPixel=8>=imageFrame.bitsAllocated?1:2,signed=1===imageFrame.pixelRepresentation,image=decodeOpenJPEG(pixelData,bytesPerPixel,signed);imageFrame.columns=image.sx;imageFrame.rows=image.sy;imageFrame.pixelData=image.pixelData;if(1<image.nbChannels){imageFrame.photometricInterpretation="RGB"}return imageFrame}function initializeJPEG2000(decodeConfig){if(!decodeConfig.usePDFJS){if("undefined"===typeof OpenJPEG){throw new Error("OpenJPEG decoder not loaded")}}if(!openJPEG){openJPEG=OpenJPEG();if(!openJPEG||!openJPEG._jp2_decode){throw new Error("OpenJPEG failed to initialize")}}}function decodeJPEG2000(imageFrame,pixelData,decodeConfig){var options=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};initializeJPEG2000(decodeConfig);if(options.usePDFJS||decodeConfig.usePDFJS){return decodeJpx(imageFrame,pixelData)}return decodeOpenJpeg2000(imageFrame,pixelData)}__webpack_exports__["default"]=decodeJPEG2000},"./shared/decoders/decodeJPEGBaseline.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function decodeJPEGBaseline(imageFrame,pixelData){if("undefined"===typeof JpegImage){throw new Error("No JPEG Baseline decoder loaded")}var jpeg=new JpegImage;jpeg.parse(pixelData);jpeg.colorTransform=!1;if(8===imageFrame.bitsAllocated){imageFrame.pixelData=jpeg.getData(imageFrame.columns,imageFrame.rows);return imageFrame}else if(16===imageFrame.bitsAllocated){imageFrame.pixelData=jpeg.getData16(imageFrame.columns,imageFrame.rows);return imageFrame}}__webpack_exports__["default"]=decodeJPEGBaseline},"./shared/decoders/decodeJPEGLS.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"initializeJPEGLS",function(){return initializeJPEGLS});var charLS;function jpegLSDecode(data,isSigned){var dataPtr=charLS._malloc(data.length);charLS.writeArrayToMemory(data,dataPtr);var imagePtrPtr=charLS._malloc(4),imageSizePtr=charLS._malloc(4),widthPtr=charLS._malloc(4),heightPtr=charLS._malloc(4),bitsPerSamplePtr=charLS._malloc(4),stridePtr=charLS._malloc(4),allowedLossyErrorPtr=charLS._malloc(4),componentsPtr=charLS._malloc(4),interleaveModePtr=charLS._malloc(4),result=charLS.ccall("jpegls_decode","number",["number","number","number","number","number","number","number","number","number","number","number"],[dataPtr,data.length,imagePtrPtr,imageSizePtr,widthPtr,heightPtr,bitsPerSamplePtr,stridePtr,componentsPtr,allowedLossyErrorPtr,interleaveModePtr]),image={result:result,width:charLS.getValue(widthPtr,"i32"),height:charLS.getValue(heightPtr,"i32"),bitsPerSample:charLS.getValue(bitsPerSamplePtr,"i32"),stride:charLS.getValue(stridePtr,"i32"),components:charLS.getValue(componentsPtr,"i32"),allowedLossyError:charLS.getValue(allowedLossyErrorPtr,"i32"),interleaveMode:charLS.getValue(interleaveModePtr,"i32"),pixelData:void 0},imagePtr=charLS.getValue(imagePtrPtr,"*");if(8>=image.bitsPerSample){image.pixelData=new Uint8Array(image.width*image.height*image.components);image.pixelData.set(new Uint8Array(charLS.HEAP8.buffer,imagePtr,image.pixelData.length))}else if(isSigned){image.pixelData=new Int16Array(image.width*image.height*image.components);image.pixelData.set(new Int16Array(charLS.HEAP16.buffer,imagePtr,image.pixelData.length))}else{image.pixelData=new Uint16Array(image.width*image.height*image.components);image.pixelData.set(new Uint16Array(charLS.HEAP16.buffer,imagePtr,image.pixelData.length))}charLS._free(dataPtr);charLS._free(imagePtr);charLS._free(imagePtrPtr);charLS._free(imageSizePtr);charLS._free(widthPtr);charLS._free(heightPtr);charLS._free(bitsPerSamplePtr);charLS._free(stridePtr);charLS._free(componentsPtr);charLS._free(interleaveModePtr);return image}function initializeJPEGLS(){if("undefined"===typeof CharLS){throw new Error("No JPEG-LS decoder loaded")}if(!charLS){charLS=CharLS();if(!charLS||!charLS._jpegls_decode){throw new Error("JPEG-LS failed to initialize")}}}function decodeJPEGLS(imageFrame,pixelData){initializeJPEGLS();var image=jpegLSDecode(pixelData,1===imageFrame.pixelRepresentation);if(0!==image.result&&6!==image.result){throw new Error("JPEG-LS decoder failed to decode frame (error code ".concat(image.result,")"))}imageFrame.columns=image.width;imageFrame.rows=image.height;imageFrame.pixelData=image.pixelData;return imageFrame}__webpack_exports__["default"]=decodeJPEGLS},"./shared/decoders/decodeJPEGLossless.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function decodeJPEGLossless(imageFrame,pixelData){if("undefined"===typeof jpeg||"undefined"===typeof jpeg.lossless||"undefined"===typeof jpeg.lossless.Decoder){throw new Error("No JPEG Lossless decoder loaded")}var byteOutput=8>=imageFrame.bitsAllocated?1:2,buffer=pixelData.buffer,decoder=new jpeg.lossless.Decoder,decompressedData=decoder.decode(buffer,pixelData.byteOffset,pixelData.length,byteOutput);if(0===imageFrame.pixelRepresentation){if(16===imageFrame.bitsAllocated){imageFrame.pixelData=new Uint16Array(decompressedData.buffer);return imageFrame}imageFrame.pixelData=new Uint8Array(decompressedData.buffer);return imageFrame}imageFrame.pixelData=new Int16Array(decompressedData.buffer);return imageFrame}__webpack_exports__["default"]=decodeJPEGLossless},"./shared/decoders/decodeLittleEndian.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function decodeLittleEndian(imageFrame,pixelData){var arrayBuffer=pixelData.buffer,offset=pixelData.byteOffset,length=pixelData.length;if(16===imageFrame.bitsAllocated){if(offset%2){arrayBuffer=arrayBuffer.slice(offset);offset=0}if(0===imageFrame.pixelRepresentation){imageFrame.pixelData=new Uint16Array(arrayBuffer,offset,length/2)}else{imageFrame.pixelData=new Int16Array(arrayBuffer,offset,length/2)}}else if(8===imageFrame.bitsAllocated||1===imageFrame.bitsAllocated){imageFrame.pixelData=pixelData}else if(32===imageFrame.bitsAllocated){if(offset%2){arrayBuffer=arrayBuffer.slice(offset);offset=0}imageFrame.pixelData=new Float32Array(arrayBuffer,offset,length/4)}return imageFrame}__webpack_exports__["default"]=decodeLittleEndian},"./shared/decoders/decodeRLE.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function decodeRLE(imageFrame,pixelData){if(8===imageFrame.bitsAllocated){if(imageFrame.planarConfiguration){return decode8Planar(imageFrame,pixelData)}return decode8(imageFrame,pixelData)}else if(16===imageFrame.bitsAllocated){return decode16(imageFrame,pixelData)}throw new Error("unsupported pixel format for RLE")}function decode8(imageFrame,pixelData){for(var frameData=pixelData,frameSize=imageFrame.rows*imageFrame.columns,outFrame=new ArrayBuffer(frameSize*imageFrame.samplesPerPixel),header=new DataView(frameData.buffer,frameData.byteOffset),data=new Int8Array(frameData.buffer,frameData.byteOffset),out=new Int8Array(outFrame),outIndex=0,numSegments=header.getInt32(0,!0),s=0;s<numSegments;++s){outIndex=s;var inIndex=header.getInt32(4*(s+1),!0),maxIndex=header.getInt32(4*(s+2),!0);if(0===maxIndex){maxIndex=frameData.length}var endOfSegment=frameSize*numSegments;while(inIndex<maxIndex){var n=data[inIndex++];if(0<=n&&127>=n){for(var i=0;i<n+1&&outIndex<endOfSegment;++i){out[outIndex]=data[inIndex++];outIndex+=imageFrame.samplesPerPixel}}else if(-1>=n&&-127<=n){for(var value=data[inIndex++],j=0;j<-n+1&&outIndex<endOfSegment;++j){out[outIndex]=value;outIndex+=imageFrame.samplesPerPixel}}}}imageFrame.pixelData=new Uint8Array(outFrame);return imageFrame}function decode8Planar(imageFrame,pixelData){for(var frameData=pixelData,frameSize=imageFrame.rows*imageFrame.columns,outFrame=new ArrayBuffer(frameSize*imageFrame.samplesPerPixel),header=new DataView(frameData.buffer,frameData.byteOffset),data=new Int8Array(frameData.buffer,frameData.byteOffset),out=new Int8Array(outFrame),outIndex=0,numSegments=header.getInt32(0,!0),s=0;s<numSegments;++s){outIndex=s*frameSize;var inIndex=header.getInt32(4*(s+1),!0),maxIndex=header.getInt32(4*(s+2),!0);if(0===maxIndex){maxIndex=frameData.length}var endOfSegment=frameSize*numSegments;while(inIndex<maxIndex){var n=data[inIndex++];if(0<=n&&127>=n){for(var i=0;i<n+1&&outIndex<endOfSegment;++i){out[outIndex]=data[inIndex++];outIndex++}}else if(-1>=n&&-127<=n){for(var value=data[inIndex++],j=0;j<-n+1&&outIndex<endOfSegment;++j){out[outIndex]=value;outIndex++}}}}imageFrame.pixelData=new Uint8Array(outFrame);return imageFrame}function decode16(imageFrame,pixelData){for(var frameData=pixelData,frameSize=imageFrame.rows*imageFrame.columns,outFrame=new ArrayBuffer(2*(frameSize*imageFrame.samplesPerPixel)),header=new DataView(frameData.buffer,frameData.byteOffset),data=new Int8Array(frameData.buffer,frameData.byteOffset),out=new Int8Array(outFrame),numSegments=header.getInt32(0,!0),s=0;s<numSegments;++s){var outIndex=0,highByte=0===s?1:0,inIndex=header.getInt32(4*(s+1),!0),maxIndex=header.getInt32(4*(s+2),!0);if(0===maxIndex){maxIndex=frameData.length}while(inIndex<maxIndex){var n=data[inIndex++];if(0<=n&&127>=n){for(var i=0;i<n+1&&outIndex<frameSize;++i){out[2*outIndex+highByte]=data[inIndex++];outIndex++}}else if(-1>=n&&-127<=n){for(var value=data[inIndex++],j=0;j<-n+1&&outIndex<frameSize;++j){out[2*outIndex+highByte]=value;outIndex++}}}}if(0===imageFrame.pixelRepresentation){imageFrame.pixelData=new Uint16Array(outFrame)}else{imageFrame.pixelData=new Int16Array(outFrame)}return imageFrame}__webpack_exports__["default"]=decodeRLE},"./shared/getMinMax.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function getMinMax(storedPixelData){for(var min=storedPixelData[0],max=storedPixelData[0],storedPixel,numPixels=storedPixelData.length,index=1;index<numPixels;index++){storedPixel=storedPixelData[index];min=_Mathmin(min,storedPixel);max=_Mathmax(max,storedPixel)}return{min:min,max:max}}__webpack_exports__["default"]=getMinMax},"./version.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]="2.2.2"}})});